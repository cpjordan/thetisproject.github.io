
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>thetis package &#8212; Thetis 0+untagged.1562.gc08033a documentation</title>
    <link rel="stylesheet" href="_static/thetis.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="_static/featured.css"> -->


<link rel="shortcut icon" href="_static/icon_thetis.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.jpg" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
        <li class="page_item"><a href="https://jenkins.ese.ic.ac.uk:1080/blue/organizations/jenkins/thetis/branches" title="Thetis build status">Jenkins</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="thetis">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="thetis-package">
<h1>thetis package<a class="headerlink" href="#thetis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thetis.assembledschur">
<span id="thetis-assembledschur-module"></span><h2>thetis.assembledschur module<a class="headerlink" href="#module-thetis.assembledschur" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="thetis.assembledschur.AssembledSchurPC">
<em class="property">class </em><code class="sig-prename descclassname">thetis.assembledschur.</code><code class="sig-name descname">AssembledSchurPC</code><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://firedrakeproject.org/firedrake.preconditioners.html#firedrake.preconditioners.base.PCBase" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.preconditioners.base.PCBase</span></code></a></p>
<p>Preconditioner for the Schur complement</p>
<p>The preconditioner matrix is assembled by explicitly matrix multiplying
<span class="math notranslate nohighlight">\(A10*Minv*A10\)</span>.</p>
<p>Here:</p>
<ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(A01\)</span>, <span class="math notranslate nohighlight">\(A10\)</span> are the assembled sub-blocks of the saddle point</dt><dd><p>system. The form of this system needs to be supplied in the
<code class="code docutils literal notranslate"><span class="pre">appctx</span></code> argument to the solver as <code class="code docutils literal notranslate"><span class="pre">appctx['a']</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(Minv\)</span> is the inverse of the mass-matrix which is assembled as</dt><dd><p><code class="code docutils literal notranslate"><span class="pre">assemble(Tensor(v*u*dx).inv)</span></code>, i.e. the element-wise inverse,
where <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(u\)</span> are the test and trial of the <span class="math notranslate nohighlight">\(A00\)</span>
block. This gives the exact inverse of the mass matrix for a DG
discretisation.</p>
</dd>
</dl>
</li>
</ul>
<p>Create a PC context suitable for PETSc.</p>
<p>Matrix free preconditioners should inherit from this class and
implement:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#thetis.assembledschur.AssembledSchurPC.initialize" title="thetis.assembledschur.AssembledSchurPC.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a></p></li>
<li><p><a class="reference internal" href="#thetis.assembledschur.AssembledSchurPC.update" title="thetis.assembledschur.AssembledSchurPC.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a></p></li>
<li><p><a class="reference internal" href="#thetis.assembledschur.AssembledSchurPC.apply" title="thetis.assembledschur.AssembledSchurPC.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a></p></li>
<li><p><a class="reference internal" href="#thetis.assembledschur.AssembledSchurPC.applyTranspose" title="thetis.assembledschur.AssembledSchurPC.applyTranspose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">applyTranspose()</span></code></a></p></li>
</ul>
<dl class="py method">
<dt id="thetis.assembledschur.AssembledSchurPC.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the preconditioner to X, putting the result in Y.</p>
<p>Both X and Y are PETSc Vecs, Y is not guaranteed to be zero on entry.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.assembledschur.AssembledSchurPC.applyTranspose">
<code class="sig-name descname">applyTranspose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.applyTranspose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.applyTranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the transpose of the preconditioner to X, putting the result in Y.</p>
<p>Both X and Y are PETSc Vecs, Y is not guaranteed to be zero on entry.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.assembledschur.AssembledSchurPC.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pc</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any state in this preconditioner.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.assembledschur.AssembledSchurPC.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pc</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update any state in this preconditioner.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.assembledschur.AssembledSchurPC.view">
<code class="sig-name descname">view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pc</span></em>, <em class="sig-param"><span class="n">viewer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.view" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.callback">
<span id="thetis-callback-module"></span><h2>thetis.callback module<a class="headerlink" href="#module-thetis.callback" title="Permalink to this headline">¶</a></h2>
<p>Defines custom callback functions used to compute various metrics at runtime.</p>
<dl class="py class">
<dt id="thetis.callback.AccumulatorCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">AccumulatorCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scalar_callback</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Callback that evaluates a (scalar) functional involving integrals in both
time and space.</p>
<p>This callback can also be used to assemble time dependent objective
functionals for adjoint simulations. Time integration is achieved using
the trapezium rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scalar_callback</strong> – Python function that returns a list of values of an objective functional.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>**kwargs</strong> – <p>any additional keyword arguments, see DiagnosticCallback</p>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.AccumulatorCallback.get_val">
<code class="sig-name descname">get_val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback.get_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback.get_val" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.callback.AccumulatorCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.AccumulatorCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['spatial integral at current timestep']</em><a class="headerlink" href="#thetis.callback.AccumulatorCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.CallbackManager">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">CallbackManager</code><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/collections.html#collections.defaultdict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.defaultdict</span></code></a></p>
<p>Stores callbacks in different categories and provides methods for
evaluating them.</p>
<p>Create callbacks and register them under <code class="docutils literal notranslate"><span class="pre">'export'</span></code> mode</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cb1</span> <span class="o">=</span> <span class="n">VolumeConservation3DCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">TracerMassConservationCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">CallbackManager</span><span class="p">()</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb2</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluate callbacks, calls <a class="reference internal" href="#thetis.callback.CallbackManager.evaluate" title="thetis.callback.CallbackManager.evaluate"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate()</span></code></a> method of all callbacks
registered in the given mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="thetis.callback.CallbackManager.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callback</span></em>, <em class="sig-param"><span class="n">mode</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a callback under the given mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – a <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> object</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – register callback under this mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.CallbackManager.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate all callbacks registered under the given mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – evaluate all callbacks under this mode</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – if provided, sets the export index. Default behavior
is to append to the file or stream.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.DetectorsCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">DetectorsCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">detector_locations</span></em>, <em class="sig-param"><span class="n">field_names</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">detector_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DetectorsCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DetectorsCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Callback that evaluates the specified fields at the specified locations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>detector_locations</strong> – List of x, y locations in which fields are to
be interpolated.</p></li>
<li><p><strong>field_names</strong> – List of fields to be interpolated.</p></li>
<li><p><strong>name</strong> – Unique name for this callback and its associated set of
detectors. This determines the name of the output h5 file
(prefixed with <cite>diagnostic_</cite>).</p></li>
<li><p><strong>detector_names</strong> – List of names for each of the detectors. If not
provided automatic names of the form <cite>detectorNNN</cite> are created
where NNN is the (0-padded) detector number.</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.DetectorsCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DetectorsCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DetectorsCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DetectorsCallback.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#thetis.callback.DetectorsCallback.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DetectorsCallback.variable_names">
<em class="property">property </em><code class="sig-name descname">variable_names</code><a class="headerlink" href="#thetis.callback.DetectorsCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.DiagnosticCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">DiagnosticCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">array_dim</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">attrs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_to_hdf5</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">append_to_log</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">include_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hdf5_dtype</span><span class="o">=</span><span class="default_value">'d'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>A base class for all Callback classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>array_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Dimension of the output array. 1 for scalars.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Additional attributes to be saved in the hdf5 file.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
<li><p><strong>include_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to include time in the hdf5 file</p></li>
<li><p><strong>hdf5_dtype</strong> – Precision to use in hdf5 output: <cite>d</cite> for double
precision (default), and <cite>f</cite> for single precision</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf file (if enabled)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.message_str">
<em class="property">abstract </em><code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.name">
<em class="property">abstract property </em><code class="sig-name descname">name</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.push_to_hdf5">
<code class="sig-name descname">push_to_hdf5</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_hdf5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Append values to HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – time stamp of entry</p></li>
<li><p><strong>args</strong> – the return value from <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.push_to_log">
<code class="sig-name descname">push_to_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Push callback status message to log</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – time stamp of entry</p></li>
<li><p><strong>args</strong> – the return value from <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.set_write_mode">
<code class="sig-name descname">set_write_mode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.set_write_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.set_write_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether to create a new hdf5 file or append to an existing one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Either ‘create’ (default) or ‘append’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.callback.DiagnosticCallback.variable_names">
<em class="property">abstract property </em><code class="sig-name descname">variable_names</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.DiagnosticHDF5">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">DiagnosticHDF5</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">varnames</em>, <em class="sig-param">array_dim=1</em>, <em class="sig-param">attrs=None</em>, <em class="sig-param">comm=&lt;mpi4py.MPI.Intracomm object&gt;</em>, <em class="sig-param">new_file=True</em>, <em class="sig-param">dtype='d'</em>, <em class="sig-param">include_time=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A HDF5 file for storing diagnostic time series arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Full filename of the HDF5 file.</p></li>
<li><p><strong>varnames</strong> – List of variable names that the diagnostic callback
provides</p></li>
<li><p><strong>array_dim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Dimension of the output array. 1 for scalars.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Additional attributes to be saved in the hdf5 file.</p></li>
<li><p><strong>comm</strong> – MPI communicator</p></li>
<li><p><strong>new_file</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Define whether to create a new hdf5 file or
append to an existing one (if any)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.DiagnosticHDF5.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">variables</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new entry of (time, variables) to the file.</p>
<p>The HDF5 is updated immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time stamp of entry</p></li>
<li><p><strong>variables</strong> (<em>tuple of float</em>) – values of entry</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – If provided, defines the time index in the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.MinMaxConservationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">MinMaxConservationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minmax_callback</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a minimum/maximum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minmax_callback</strong> – Python function that takes the solver object as
an argument and returns a (min, max) value tuple</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.MinMaxConservationCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.MinMaxConservationCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['min_value', 'max_value', 'undershoot', 'overshoot']</em><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.ScalarConservationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">ScalarConservationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scalar_callback</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a scalar quantity</p>
<p>Creates scalar conservation check callback object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scalar_callback</strong> – Python function that takes the solver object as
an argument and returns a scalar quantity of interest</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.ScalarConservationCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.ScalarConservationCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['integral', 'relative_difference']</em><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.TimeSeriesCallback2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">TimeSeriesCallback2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">fieldnames</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">location_name</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_to_hdf5</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">append_to_log</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Extract a time series of a 2D field at a given (x,y) location</p>
<p>Currently implemented only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.TimeSeriesCallback2D.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback2D.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.TimeSeriesCallback2D.name">
<code class="sig-name descname">name</code><em class="property"> = 'timeseries'</em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.TimeSeriesCallback2D.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['value']</em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.TimeSeriesCallback3D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">TimeSeriesCallback3D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">fieldnames</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">location_name</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_to_hdf5</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">append_to_log</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Extract a time series of a 3D field at a given (x,y,z) location</p>
<p>Currently implemented only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong><strong>, </strong><strong>z</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.TimeSeriesCallback3D.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback3D.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.TimeSeriesCallback3D.name">
<code class="sig-name descname">name</code><em class="property"> = 'timeseries'</em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.TimeSeriesCallback3D.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['value']</em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.TracerMassConservation2DCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">TracerMassConservation2DCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tracer_name</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservation2DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerMassConservation2DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of depth-averaged tracer mass</p>
<p>Depth-averaged tracer mass is defined as the integral of 2D tracer
multiplied by total depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.callback.TracerMassConservation2DCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'tracer mass'</em><a class="headerlink" href="#thetis.callback.TracerMassConservation2DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.TracerMassConservationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">TracerMassConservationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tracer_name</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of total tracer mass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.callback.TracerMassConservationCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'tracer mass'</em><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.TracerOvershootCallBack">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">TracerOvershootCallBack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tracer_name</span></em>, <em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerOvershootCallBack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.MinMaxConservationCallback" title="thetis.callback.MinMaxConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.MinMaxConservationCallback</span></code></a></p>
<p>Checks overshoots of the given tracer field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.callback.TracerOvershootCallBack.name">
<code class="sig-name descname">name</code><em class="property"> = 'tracer overshoot'</em><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.VerticalProfileCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">VerticalProfileCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">fieldnames</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">location_name</span></em>, <em class="sig-param"><span class="n">npoints</span><span class="o">=</span><span class="default_value">48</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_to_hdf5</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">append_to_log</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VerticalProfileCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VerticalProfileCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Extract a vertical profile of a 3D field at a given (x,y) location</p>
<p>Only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>npoints</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of points along the vertical axis. The 3D
field will be interpolated on these points, ranging from the bottom
to the (time dependent) free surface.</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.callback.VerticalProfileCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VerticalProfileCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.VerticalProfileCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'vertprofile'</em><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.callback.VerticalProfileCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['z_coord', 'value']</em><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.VolumeConservation2DCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">VolumeConservation2DCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation2DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 2D volume (integral of water elevation field)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.callback.VolumeConservation2DCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'volume2d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.callback.VolumeConservation3DCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">VolumeConservation3DCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation3DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 3D volume (volume of 3D mesh)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.callback.VolumeConservation3DCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'volume3d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.callback.timed_region">
<code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.callback.timed_stage">
<code class="sig-prename descclassname">thetis.callback.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.configuration">
<span id="thetis-configuration-module"></span><h2>thetis.configuration module<a class="headerlink" href="#module-thetis.configuration" title="Permalink to this headline">¶</a></h2>
<p>Utility function and extensions to traitlets used for specifying Thetis options</p>
<dl class="py class">
<dt id="thetis.configuration.ABCMetaHasTraits">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">ABCMetaHasTraits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">bases</span></em>, <em class="sig-param"><span class="n">classdict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#ABCMetaHasTraits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.ABCMetaHasTraits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/abc.html#abc.ABCMeta" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABCMeta</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.MetaHasTraits</span></code></p>
<p>Combined metaclass of ABCMeta and MetaHasTraits</p>
<p>Finish initializing the HasDescriptors class.</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.BoundedFloat">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">BoundedFloat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">bounds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.BoundedFloat.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.BoundedFloat.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.BoundedInteger">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">BoundedInteger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">bounds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.BoundedInteger.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.BoundedInteger.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FiredrakeCoefficient">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FiredrakeCoefficient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">read_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">help</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeCoefficient.default_value">
<code class="sig-name descname">default_value</code><em class="property"> = None</em><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.default_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeCoefficient.default_value_repr">
<code class="sig-name descname">default_value_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient.default_value_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.default_value_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeCoefficient.info_text">
<code class="sig-name descname">info_text</code><em class="property"> = 'a Firedrake Constant or Function'</em><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.info_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeCoefficient.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FiredrakeConstantTraitlet">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FiredrakeConstantTraitlet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">read_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">help</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeConstantTraitlet.default_value">
<code class="sig-name descname">default_value</code><em class="property"> = None</em><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.default_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeConstantTraitlet.default_value_repr">
<code class="sig-name descname">default_value_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet.default_value_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.default_value_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeConstantTraitlet.info_text">
<code class="sig-name descname">info_text</code><em class="property"> = 'a Firedrake Constant'</em><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.info_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeConstantTraitlet.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FiredrakeScalarExpression">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FiredrakeScalarExpression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">read_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">help</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeScalarExpression.default_value">
<code class="sig-name descname">default_value</code><em class="property"> = None</em><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.default_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeScalarExpression.default_value_repr">
<code class="sig-name descname">default_value_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression.default_value_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.default_value_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeScalarExpression.info_text">
<code class="sig-name descname">info_text</code><em class="property"> = 'a scalar UFL expression'</em><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.info_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeScalarExpression.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FiredrakeVectorExpression">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FiredrakeVectorExpression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">read_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">help</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeVectorExpression.default_value">
<code class="sig-name descname">default_value</code><em class="property"> = None</em><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.default_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeVectorExpression.default_value_repr">
<code class="sig-name descname">default_value_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression.default_value_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.default_value_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.configuration.FiredrakeVectorExpression.info_text">
<code class="sig-name descname">info_text</code><em class="property"> = 'a vector UFL expression'</em><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.info_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.FiredrakeVectorExpression.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FrozenConfigurable">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FrozenConfigurable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FrozenConfigurable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FrozenConfigurable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.OptionsBase" title="thetis.configuration.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.OptionsBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.config.configurable.Configurable</span></code></p>
<p>A Configurable class that only allows adding new attributes in the class
definition or when  self._isfrozen is False.</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.FrozenHasTraits">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">FrozenHasTraits</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FrozenHasTraits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.FrozenHasTraits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.OptionsBase" title="thetis.configuration.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.OptionsBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.HasTraits</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.NonNegativeFloat">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">NonNegativeFloat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.NonNegativeFloat.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.NonNegativeFloat.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.NonNegativeInteger">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">NonNegativeInteger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.NonNegativeInteger.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.NonNegativeInteger.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.OptionsBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">OptionsBase</code><a class="reference internal" href="_modules/thetis/configuration.html#OptionsBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.OptionsBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for all options classes</p>
<dl class="py method">
<dt id="thetis.configuration.OptionsBase.name">
<em class="property">abstract property </em><code class="sig-name descname">name</code><a class="headerlink" href="#thetis.configuration.OptionsBase.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Human readable name of the configurable object</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.configuration.OptionsBase.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#OptionsBase.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.OptionsBase.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign options from another container</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>options</strong> – Either a dictionary of options or another
HasTraits object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.PETScSolverParameters">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">PETScSolverParameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trait</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">traits</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PETScSolverParameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PETScSolverParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Dict</span></code></p>
<p>PETSc solver options dictionary</p>
<p>Create a dict trait type from a Python dict.</p>
<p>The default value is created by doing <code class="docutils literal notranslate"><span class="pre">dict(default_value)</span></code>,
which creates a copy of the <code class="docutils literal notranslate"><span class="pre">default_value</span></code>.</p>
<dl class="simple">
<dt>trait<span class="classifier">TraitType [ optional ]</span></dt><dd><p>The specified trait type to check and use to restrict contents of
the Container. If unspecified, trait types are not checked.</p>
</dd>
<dt>traits<span class="classifier">Dictionary of trait types [ optional ]</span></dt><dd><p>A Python dictionary containing the types that are valid for
restricting the content of the Dict Container for certain keys.</p>
</dd>
<dt>default_value<span class="classifier">SequenceType [ optional ]</span></dt><dd><p>The default value for the Dict.  Must be dict, tuple, or None, and
will be cast to a dict if not None. If <cite>trait</cite> is specified, the
<cite>default_value</cite> must conform to the constraints it specifies.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.configuration.PETScSolverParameters.default_value">
<code class="sig-name descname">default_value</code><em class="property"> = None</em><a class="headerlink" href="#thetis.configuration.PETScSolverParameters.default_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.configuration.PETScSolverParameters.info_text">
<code class="sig-name descname">info_text</code><em class="property"> = 'a PETSc solver options dictionary'</em><a class="headerlink" href="#thetis.configuration.PETScSolverParameters.info_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.PETScSolverParameters.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PETScSolverParameters.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PETScSolverParameters.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.PairedEnum">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">PairedEnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span></em>, <em class="sig-param"><span class="n">paired_name</span></em>, <em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PairedEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PairedEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Enum</span></code></p>
<p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.PairedEnum.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PairedEnum.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PairedEnum.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a description of the trait.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.PositiveFloat">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">PositiveFloat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.PositiveFloat.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.PositiveFloat.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.configuration.PositiveInteger">
<em class="property">class </em><code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">PositiveInteger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_value</span><span class="o">=</span><span class="default_value">traitlets.Undefined</span></em>, <em class="sig-param"><span class="n">allow_none</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt id="thetis.configuration.PositiveInteger.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.configuration.PositiveInteger.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">proposal</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.configuration.attach_paired_options">
<code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">attach_paired_options</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">name_trait</span></em>, <em class="sig-param"><span class="n">value_trait</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#attach_paired_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.attach_paired_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach paired options to a Configurable object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – the name of the enum trait</p></li>
<li><p><strong>name_trait</strong> – the enum trait (a PairedEnum)</p></li>
<li><p><strong>value_trait</strong> – the slaved value trait.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.configuration.rst_all_options">
<code class="sig-prename descclassname">thetis.configuration.</code><code class="sig-name descname">rst_all_options</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls</span></em>, <em class="sig-param"><span class="n">nspace</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#rst_all_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.configuration.rst_all_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively generate rST for a provided Configurable class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – The Configurable class.</p></li>
<li><p><strong>nspace</strong> – Indentation level.</p></li>
<li><p><strong>prefix</strong> – Prefix to use for new traits.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-thetis.conservative_tracer_eq_2d">
<span id="thetis-conservative-tracer-eq-2d-module"></span><h2>thetis.conservative_tracer_eq_2d module<a class="headerlink" href="#module-thetis.conservative_tracer_eq_2d" title="Permalink to this headline">¶</a></h2>
<p>2D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of depth-integrated tracer <span class="math notranslate nohighlight">\(q=HT\)</span> in conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-tracer-eq-2d">
<span class="eqno">(1)<a class="headerlink" href="#equation-tracer-eq-2d" title="Permalink to this equation">¶</a></span>\[\frac{\partial q}{\partial t}
+ \nabla_h \cdot (\textbf{u} q)
= \nabla_h \cdot (\mu_h \nabla_h q)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> are the horizontal
velocities, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> denotes horizontal diffusivity.</p>
<dl class="py class">
<dt id="thetis.conservative_tracer_eq_2d.ConservativeTracerEquation2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.conservative_tracer_eq_2d.</code><code class="sig-name descname">ConservativeTracerEquation2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 36)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/conservative_tracer_eq_2d.html#ConservativeTracerEquation2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.conservative_tracer_eq_2d.ConservativeTracerEquation2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>2D tracer advection-diffusion equation <a class="reference internal" href="#equation-tracer-eq">(14)</a> in conservative form</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-thetis.coordsys">
<span id="thetis-coordsys-module"></span><h2>thetis.coordsys module<a class="headerlink" href="#module-thetis.coordsys" title="Permalink to this headline">¶</a></h2>
<p>Generic methods for converting data between different spatial coordinate systems.
Uses pyproj library.</p>
<dl class="py class">
<dt id="thetis.coordsys.VectorCoordSysRotation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coordsys.</code><code class="sig-name descname">VectorCoordSysRotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_sys</span></em>, <em class="sig-param"><span class="n">target_sys</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#VectorCoordSysRotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coordsys.VectorCoordSysRotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Rotates vectors defined in source_sys coordinates to a different coordinate
system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_sys</strong> – pyproj coordinate system where (x, y) are defined in</p></li>
<li><p><strong>target_sys</strong> – target pyproj coordinate system</p></li>
<li><p><strong>x</strong> – x coordinate</p></li>
<li><p><strong>y</strong> – y coordinate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.coordsys.convert_coords">
<code class="sig-prename descclassname">thetis.coordsys.</code><code class="sig-name descname">convert_coords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_sys</span></em>, <em class="sig-param"><span class="n">target_sys</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#convert_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coordsys.convert_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts coordinates from source_sys to target_sys</p>
<p>This function extends pyproj.transform method by handling NaNs correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_sys</strong> – pyproj coordinate system where (x, y) are defined in</p></li>
<li><p><strong>target_sys</strong> – target pyproj coordinate system</p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array_like</em>) – x coordinate</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array_like</em>) – y coordinate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.coordsys.get_vector_rotation_matrix">
<code class="sig-prename descclassname">thetis.coordsys.</code><code class="sig-name descname">get_vector_rotation_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_sys</span></em>, <em class="sig-param"><span class="n">target_sys</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">delta</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#get_vector_rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coordsys.get_vector_rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate rotation matrix that converts vectors defined in source_sys to
target_sys.</p>
<p>Assume that we have a vector field defined in source_sys: vectors located at
(x, y) define the x and y components. We can then rotate the vectors to
represent x2 and y2 components of the target_sys by applying a local
rotation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">get_vector_rotation_matrix</span><span class="p">(</span><span class="n">source_sys</span><span class="p">,</span> <span class="n">target_sys</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="n">v_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v_x</span><span class="p">],</span> <span class="p">[</span><span class="n">v_y</span><span class="p">]])</span>
<span class="n">v_new</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">v_xy</span><span class="p">)</span>
<span class="n">v_x2</span><span class="p">,</span> <span class="n">v_y2</span> <span class="o">=</span> <span class="n">v_new</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-thetis.coupled_timeintegrator">
<span id="thetis-coupled-timeintegrator-module"></span><h2>thetis.coupled_timeintegrator module<a class="headerlink" href="#module-thetis.coupled_timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Time integrators for solving coupled 2D-3D system of equations.</p>
<dl class="py class">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">CoupledLeapFrogAM3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 time integrator for coupled 2D-3D problem</p>
<p>This is an ALE time integrator.
Implementation follows the SLIM time integrator by Karna et al (2013)</p>
<p>Karna, et al. (2013). A baroclinic discontinuous Galerkin finite element
model for coastal flows. Ocean Modelling, 61(0):1-20.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2012.09.009">http://dx.doi.org/10.1016/j.ocemod.2012.09.009</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">update_forcings3d</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</p></li>
<li><p><strong>update_forcings3d</strong> – Optional user defined function that updates
boundary conditions of the 3D equations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d">
<code class="sig-name descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRK22" title="thetis.rungekutta.DIRK22"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK22</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d">
<code class="sig-name descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.LeapFrogAM3" title="thetis.timeintegrator.LeapFrogAM3"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.LeapFrogAM3</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d">
<code class="sig-name descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.BackwardEuler</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">CoupledTimeIntegrator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegratorBase</span></code></a></p>
<p>Base class of mode-split time integrators that use 2D, 3D and implicit 3D
time integrators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d">
<em class="property">abstract property </em><code class="sig-name descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for 2D equations</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d">
<em class="property">abstract property </em><code class="sig-name descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for explicit 3D equations (momentum, tracers)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d">
<em class="property">abstract property </em><code class="sig-name descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for implicit 3D equations (vertical diffusion)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt">
<code class="sig-name descname">set_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">dt_2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Set time step for the coupled time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step. This is the master (macro) time step used to
march the 3D equations.</p></li>
<li><p><strong>dt_2d</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step for 2D equations. For consistency
<code class="xref py py-attr docutils literal notranslate"><span class="pre">dt_2d</span></code> must be an integer fraction of <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt</span></code>.
If 2D solver is implicit set <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt_2d</span></code> equal to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">CoupledTimeIntegratorBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegratorBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegratorBase</span></code></a></p>
<p>Base class for coupled 2D-3D time integrators</p>
<p>Provides common functionality for updating diagnostic fields etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">CoupledTwoStageRK</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Coupled time integrator based on SSPRK(2,2) scheme</p>
<p>This ALE time integration method uses SSPRK(2,2) scheme to advance the 3D
equations and a compatible implicit Trapezoid method to advance the 2D
equations. Backward Euler scheme is used for vertical diffusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">update_forcings3d</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</p></li>
<li><p><strong>update_forcings3d</strong> – Optional user defined function that updates
boundary conditions of the 3D equations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity">
<code class="sig-name descname">compute_mesh_velocity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">istage</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.compute_mesh_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mesh velocity for stage i</p>
<p>Must be called after updating the 2D mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – stage of the Runge-Kutta iteration</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d">
<code class="sig-name descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ESDIRKTrapezoid" title="thetis.rungekutta.ESDIRKTrapezoid"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ESDIRKTrapezoid</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d">
<code class="sig-name descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.SSPRK22ALE" title="thetis.timeintegrator.SSPRK22ALE"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.SSPRK22ALE</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d">
<code class="sig-name descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.BackwardEuler</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation">
<code class="sig-name descname">store_elevation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">istage</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.store_elevation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation" title="Permalink to this definition">¶</a></dt>
<dd><p>Store current elevation field for computing mesh velocity</p>
<p>Must be called before updating the 2D mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – stage of the Runge-Kutta iteration</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.coupled_timeintegrator.timed_region">
<code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.coupled_timeintegrator.timed_stage">
<code class="sig-prename descclassname">thetis.coupled_timeintegrator.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.coupled_timeintegrator_2d">
<span id="thetis-coupled-timeintegrator-2d-module"></span><h2>thetis.coupled_timeintegrator_2d module<a class="headerlink" href="#module-thetis.coupled_timeintegrator_2d" title="Permalink to this headline">¶</a></h2>
<p>Time integrators for solving coupled shallow water equations with one tracer.</p>
<dl class="py class">
<dt id="thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator_2d.</code><code class="sig-name descname">CoupledCrankEuler2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledCrankEuler2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D.swe_integrator">
<code class="sig-name descname">swe_integrator</code><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D.swe_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.CrankNicolson" title="thetis.timeintegrator.CrankNicolson"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.CrankNicolson</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D.tracer_integrator">
<code class="sig-name descname">tracer_integrator</code><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledCrankEuler2D.tracer_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.ForwardEuler" title="thetis.timeintegrator.ForwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.ForwardEuler</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.coupled_timeintegrator_2d.CoupledMatchingTimeIntegrator2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator_2d.</code><code class="sig-name descname">CoupledMatchingTimeIntegrator2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em>, <em class="sig-param"><span class="n">integrator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledMatchingTimeIntegrator2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledMatchingTimeIntegrator2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.coupled_timeintegrator_2d.</code><code class="sig-name descname">CoupledTimeIntegrator2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegratorBase</span></code></a></p>
<p>Base class of time integrator for coupled shallow water and tracer equations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.set_dt">
<code class="sig-name descname">set_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Set time step for the coupled time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.swe_integrator">
<code class="sig-name descname">swe_integrator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.swe_integrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.swe_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for the shallow water equations</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.tracer_integrator">
<code class="sig-name descname">tracer_integrator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.tracer_integrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.tracer_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for the tracer equation</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.coupled_timeintegrator_2d.timed_region">
<code class="sig-prename descclassname">thetis.coupled_timeintegrator_2d.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.coupled_timeintegrator_2d.timed_stage">
<code class="sig-prename descclassname">thetis.coupled_timeintegrator_2d.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.equation">
<span id="thetis-equation-module"></span><h2>thetis.equation module<a class="headerlink" href="#module-thetis.equation" title="Permalink to this headline">¶</a></h2>
<p>Implements Equation and Term classes.</p>
<dl class="py class">
<dt id="thetis.equation.Equation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.equation.</code><code class="sig-name descname">Equation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements an equation, made out of terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.equation.Equation.SUPPORTED_LABELS">
<code class="sig-name descname">SUPPORTED_LABELS</code><em class="property"> = frozenset({'explicit', 'implicit', 'nonlinear', 'source'})</em><a class="headerlink" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid labels for terms, indicating how they should be treated in the time
integrator.</p>
<dl class="simple">
<dt>source</dt><dd><p>The term is a source term, i.e. does not depend on the solution.</p>
</dd>
<dt>explicit</dt><dd><p>The term should be treated explicitly</p>
</dd>
<dt>implicit</dt><dd><p>The term should be treated implicitly</p>
</dd>
<dt>nonlinear</dt><dd><p>The term is nonlinear and should be treated fully implicitly</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.add_term">
<code class="sig-name descname">add_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">term</span></em>, <em class="sig-param"><span class="n">label</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.add_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.add_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a term in the equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> – <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> object to add_term</p></li>
<li><p><strong>label</strong> (<em>string</em>) – Assign a label to the term. Valid labels are given by
<a class="reference internal" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="thetis.equation.Equation.SUPPORTED_LABELS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SUPPORTED_LABELS</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.jacobian">
<code class="sig-name descname">jacobian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian by summing up all the Jacobians of the terms.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.label_term">
<code class="sig-name descname">label_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">term</span></em>, <em class="sig-param"><span class="n">label</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.label_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.label_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Assings a label to the given term(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> – <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> object, or a tuple of terms</p></li>
<li><p><strong>label</strong> – string label to assign</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.mass_term">
<code class="sig-name descname">mass_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.mass_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.mass_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Equation.select_terms">
<code class="sig-name descname">select_terms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.select_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.select_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator function that selects terms by label(s).</p>
<p>label can be a single label (e.g. ‘explicit’), ‘all’ or a tuple of
labels.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.equation.Term">
<em class="property">class </em><code class="sig-prename descclassname">thetis.equation.</code><code class="sig-name descname">Term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements a single term of an equation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.equation.Term.jacobian">
<code class="sig-name descname">jacobian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.equation.Term.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.equation.timed_region">
<code class="sig-prename descclassname">thetis.equation.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.equation.timed_stage">
<code class="sig-prename descclassname">thetis.equation.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.exporter">
<span id="thetis-exporter-module"></span><h2>thetis.exporter module<a class="headerlink" href="#module-thetis.exporter" title="Permalink to this headline">¶</a></h2>
<p>Routines for handling file exports.</p>
<dl class="py class">
<dt id="thetis.exporter.ExportManager">
<em class="property">class </em><code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">ExportManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputdir</span></em>, <em class="sig-param"><span class="n">fields_to_export</span></em>, <em class="sig-param"><span class="n">functions</span></em>, <em class="sig-param"><span class="n">field_metadata</span></em>, <em class="sig-param"><span class="n">export_type</span><span class="o">=</span><span class="default_value">'vtk'</span></em>, <em class="sig-param"><span class="n">next_export_ix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helper object for exporting multiple fields simultaneously</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.field_defs</span> <span class="kn">import</span> <span class="n">field_metadata</span>
<span class="n">field_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="o">...</span><span class="p">}</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">ExportManager</span><span class="p">(</span><span class="s1">&#39;mydirectory&#39;</span><span class="p">,</span>
                           <span class="p">[</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">,</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">,</span> <span class="n">salt_3d</span><span class="s1">&#39;],</span>
                           <span class="n">field_dict</span><span class="p">,</span>
                           <span class="n">field_metadata</span><span class="p">,</span>
                           <span class="n">export_type</span><span class="o">=</span><span class="s1">&#39;vtk&#39;</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where files are stored</p></li>
<li><p><strong>fields_to_export</strong> (<em>list of strings</em>) – list of fields to export</p></li>
<li><p><strong>functions</strong> – dict that contains all existing <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>field_metadata</strong> – dict of all field metadata.
See <a class="reference internal" href="#module-thetis.field_defs" title="thetis.field_defs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">field_defs</span></code></a></p></li>
<li><p><strong>export_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – export format, either ‘vtk’ or ‘hdf5’</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.exporter.ExportManager.add_export">
<code class="sig-name descname">add_export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fieldname</span></em>, <em class="sig-param"><span class="n">function</span></em>, <em class="sig-param"><span class="n">export_type</span><span class="o">=</span><span class="default_value">'vtk'</span></em>, <em class="sig-param"><span class="n">next_export_ix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shortname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">preproc_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.add_export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.add_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new field exporter in the manager.</p>
<p>This method allows exporting both default Thetis fields and user
defined fields. In the latter case the user must provide sufficient
metadata, i.e. fieldname, shortname and filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fieldname</strong> (<em>string</em>) – canonical field name</p></li>
<li><p><strong>function</strong> – Firedrake function to export</p></li>
<li><p><strong>export_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – export format, either ‘vtk’ or ‘hdf5’</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – optional directory where files are stored</p></li>
<li><p><strong>shortname</strong> (<em>string</em>) – override shortname defined in field_metadata</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – override filename defined in field_metadata</p></li>
<li><p><strong>preproc_func</strong> – optional funtion that will be called prior to
exporting. E.g. for computing diagnostic fields.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.ExportManager.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all designated functions to disk</p>
<p>Increments export index by 1.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.ExportManager.export_bathymetry">
<code class="sig-name descname">export_bathymetry</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bathymetry_2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export_bathymetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export_bathymetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function to export 2D bathymetry data to disk</p>
<p>Bathymetry does not vary in time so this only needs to be called once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bathymetry_2d</strong> – 2D bathymetry <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.ExportManager.set_next_export_ix">
<code class="sig-name descname">set_next_export_ix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">next_export_ix</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set export index to all child exporters</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.exporter.ExporterBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">ExporterBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">outputdir</span></em>, <em class="sig-param"><span class="n">next_export_ix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for exporter objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – output file name (without directory)</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where file is stored</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – set the index for next output</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.exporter.ExporterBase.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.ExporterBase.set_next_export_ix">
<code class="sig-name descname">set_next_export_ix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">next_export_ix</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.exporter.HDF5Exporter">
<em class="property">class </em><code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">HDF5Exporter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">outputdir</span></em>, <em class="sig-param"><span class="n">filename_prefix</span></em>, <em class="sig-param"><span class="n">next_export_ix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Stores fields in disk in native discretization using HDF5 containers</p>
<p>Create exporter object for given function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>) – space where the exported functions belong</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where outputs will be stored</p></li>
<li><p><strong>filename_prefix</strong> (<em>string</em>) – prefix of output filename. Filename is
prefix_nnnnn.h5 where nnnnn is the export number.</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.exporter.HDF5Exporter.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export function to disk.</p>
<p>Increments export index by 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to export</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.HDF5Exporter.export_as_index">
<code class="sig-name descname">export_as_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iexport</span></em>, <em class="sig-param"><span class="n">function</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export_as_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export_as_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Export function to disk using the specified export index number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p></li>
<li><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to export</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.HDF5Exporter.gen_filename">
<code class="sig-name descname">gen_filename</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iexport</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.gen_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.gen_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate file name ‘prefix_nnnnn.h5’ for i-th export</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.HDF5Exporter.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iexport</span></em>, <em class="sig-param"><span class="n">function</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads nodal values from disk and assigns to the given function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p></li>
<li><p><strong>function</strong> – target <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.exporter.VTKExporter">
<em class="property">class </em><code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">VTKExporter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fs_visu</span></em>, <em class="sig-param"><span class="n">func_name</span></em>, <em class="sig-param"><span class="n">outputdir</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">next_export_ix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">project_output</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Class that handles Paraview VTK file exports</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fs_visu</strong> – function space where input function will be cast
before exporting</p></li>
<li><p><strong>func_name</strong> – name of the function</p></li>
<li><p><strong>outputdir</strong> – output directory</p></li>
<li><p><strong>filename</strong> – name of the pvd file</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>project_output</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – project function to output space instead of
interpolating</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.exporter.VTKExporter.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.exporter.VTKExporter.set_next_export_ix">
<code class="sig-name descname">set_next_export_ix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">next_export_ix</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.exporter.get_visu_space">
<code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">get_visu_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#get_visu_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.get_visu_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an appropriate VTK visualization space for a function space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fs</strong> – function space</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function space for VTK visualization</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.exporter.is_2d">
<code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">is_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#is_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.is_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests wether a function space is 2D or 3D</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.exporter.timed_region">
<code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.exporter.timed_stage">
<code class="sig-prename descclassname">thetis.exporter.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.field_defs">
<span id="thetis-field-defs-module"></span><h2>thetis.field_defs module<a class="headerlink" href="#module-thetis.field_defs" title="Permalink to this headline">¶</a></h2>
<p>Definitions and meta data of fields</p>
<dl class="py data">
<dt id="thetis.field_defs.field_metadata">
<code class="sig-prename descclassname">thetis.field_defs.</code><code class="sig-name descname">field_metadata</code><em class="property"> = {'baroc_head_3d': {'filename': 'BaroHead3d', 'name': 'Baroclinic head', 'shortname': 'Baroclinic head', 'unit': 'm'}, 'bathymetry_2d': {'filename': 'bathymetry2d', 'name': 'Bathymetry', 'shortname': 'Bathymetry', 'unit': 'm'}, 'buoy_freq_3d': {'filename': 'BuoyFreq3d', 'name': 'Buoyancy frequency squared', 'shortname': 'Buoyancy frequency squared', 'unit': 's-2'}, 'coriolis_2d': {'filename': 'coriolis_2d', 'name': 'Coriolis parameter', 'shortname': 'Coriolis parameter', 'unit': 's-1'}, 'coriolis_3d': {'filename': 'coriolis_3d', 'name': 'Coriolis parameter', 'shortname': 'Coriolis parameter', 'unit': 's-1'}, 'density_3d': {'filename': 'Density3d', 'name': 'Water density', 'shortname': 'Density', 'unit': 'kg m-3'}, 'eddy_diff_3d': {'filename': 'EddyDiff3d', 'name': 'Eddy diffusivity', 'shortname': 'Eddy diffusivity', 'unit': 'm2 s-1'}, 'eddy_visc_3d': {'filename': 'EddyVisc3d', 'name': 'Eddy Viscosity', 'shortname': 'Eddy Viscosity', 'unit': 'm2 s-1'}, 'elev_2d': {'filename': 'Elevation2d', 'name': 'Water elevation', 'shortname': 'Elevation', 'unit': 'm'}, 'elev_cg_2d': {'filename': 'ElevationCG2d', 'name': 'Water elevation CG', 'shortname': 'Elevation', 'unit': 'm'}, 'elev_domain_2d': {'filename': 'ElevationDomain2d', 'name': 'Surface elevation of domain', 'shortname': 'Elevation', 'unit': 'm'}, 'eps_3d': {'filename': 'TurbEps3d', 'name': 'TKE dissipation rate', 'shortname': 'TKE dissipation rate', 'unit': 'm2 s-3'}, 'h_elem_size_2d': {'filename': 'h_elem_size_2d', 'name': 'Element size in horizontal direction', 'shortname': 'Horizontal element size', 'unit': 'm'}, 'h_elem_size_3d': {'filename': 'h_elem_size_3d', 'name': 'Element size in horizontal direction', 'shortname': 'Horizontal element size', 'unit': 'm'}, 'hcc_metric_3d': {'filename': 'HCCMetric3d', 'name': 'HCC mesh quality', 'shortname': 'HCC metric', 'unit': '-'}, 'int_pg_3d': {'filename': 'IntPG3d', 'name': 'Internal pressure gradient', 'shortname': 'Int. Pressure gradient', 'unit': 'm s-2'}, 'len_3d': {'filename': 'TurbLen3d', 'name': 'Turbulent length scale', 'shortname': 'Turbulent length scale', 'unit': 'm'}, 'max_h_diff': {'filename': 'MaxHDiffusivity3d', 'name': 'Maximum stable horizontal diffusivity', 'shortname': 'Maximum horizontal diffusivity', 'unit': 'm2 s-1'}, 'psi_3d': {'filename': 'TurbPsi3d', 'name': 'Turbulence psi variable', 'shortname': 'Turbulence psi variable', 'unit': ''}, 'salt_3d': {'filename': 'Salinity3d', 'name': 'Water salinity', 'shortname': 'Salinity', 'unit': 'psu'}, 'shear_freq_3d': {'filename': 'ShearFreq3d', 'name': 'Vertical shear frequency squared', 'shortname': 'Vertical shear frequency squared', 'unit': 's-2'}, 'smag_visc_3d': {'filename': 'SmagViscosity3d', 'name': 'Smagorinsky viscosity', 'shortname': 'Smagorinsky viscosity', 'unit': 'm2 s-1'}, 'split_residual_2d': {'filename': 'SplitResidual2d', 'name': 'Momentum eq. residual for mode splitting', 'shortname': 'Momentum residual', 'unit': 'm s-2'}, 'temp_3d': {'filename': 'Temperature3d', 'name': 'Water temperature', 'shortname': 'Temperature', 'unit': 'C'}, 'tke_3d': {'filename': 'TurbKEnergy3d', 'name': 'Turbulent Kinetic Energy', 'shortname': 'Turbulent Kinetic Energy', 'unit': 'm2 s-2'}, 'tracer_2d': {'filename': 'Tracer2d', 'name': 'Depth averaged tracer', 'shortname': 'Tracer', 'unit': ''}, 'uv_2d': {'filename': 'Velocity2d', 'name': 'Depth averaged velocity', 'shortname': 'Depth averaged velocity', 'unit': 'm s-1'}, 'uv_3d': {'filename': 'Velocity3d', 'name': 'Horizontal velocity', 'shortname': 'Horizontal velocity', 'unit': 'm s-1'}, 'uv_dav_2d': {'filename': 'DAVelocity2d', 'name': 'Depth averaged velocity', 'shortname': 'Depth averaged velocity', 'unit': 'm s-1'}, 'uv_dav_3d': {'filename': 'DAVelocity3d', 'name': 'Depth averaged velocity', 'shortname': 'Depth averaged velocity', 'unit': 'm s-1'}, 'v_elem_size_2d': {'filename': 'VElemSize2d', 'name': 'Element size in vertical direction', 'shortname': 'Vertical element size', 'unit': 'm'}, 'v_elem_size_3d': {'filename': 'VElemSize3d', 'name': 'Element size in vertical direction', 'shortname': 'Vertical element size', 'unit': 'm'}, 'w_3d': {'filename': 'VertVelo3d', 'name': 'Vertical velocity', 'shortname': 'Vertical velocity', 'unit': 'm s-1'}, 'w_mesh_3d': {'filename': 'MeshVelo3d', 'name': 'Mesh velocity', 'shortname': 'Mesh velocity', 'unit': 'm s-1'}, 'wind_stress_3d': {'filename': 'wind_stress_3d', 'name': 'Wind stress', 'shortname': 'Wind stress', 'unit': 'Pa'}, 'z_coord_3d': {'filename': 'ZCoord3d', 'name': 'Mesh z coordinates', 'shortname': 'Z coordinates', 'unit': 'm'}, 'z_coord_ref_3d': {'filename': 'ZCoordRef3d', 'name': 'Static mesh z coordinates', 'shortname': 'Z coordinates', 'unit': 'm'}}</em><a class="headerlink" href="#thetis.field_defs.field_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary that contains the meta data of each field.</p>
<p>Required meta data entries are:</p>
<ul class="simple">
<li><p><strong>name</strong>: human readable description</p></li>
<li><p><strong>shortname</strong>: description used in visualization etc</p></li>
<li><p><strong>unit</strong>: SI unit of the field</p></li>
<li><p><strong>filename</strong>: filename for output files</p></li>
</ul>
<p>The naming convention for field keys is snake_case: <code class="docutils literal notranslate"><span class="pre">field_name_3d</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-thetis.forcing">
<span id="thetis-forcing-module"></span><h2>thetis.forcing module<a class="headerlink" href="#module-thetis.forcing" title="Permalink to this headline">¶</a></h2>
<p>Routines for interpolating forcing fields for the 3D solver.</p>
<dl class="py class">
<dt id="thetis.forcing.ATMInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">ATMInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">wind_stress_field</span></em>, <em class="sig-param"><span class="n">atm_pressure_field</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">ncfile_pattern</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">target_coordsys</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.ATMInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates WRF/NAM atmospheric model data on 2D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>wind_stress_field</strong> – A 2D vector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the output
wind stress will be stored.</p></li>
<li><p><strong>atm_pressure_field</strong> – A 2D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the output
atmospheric pressure will be stored.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>ncfile_pattern</strong> – A file name pattern for reading the atmospheric
model output files. E.g. ‘forcings/nam_air.local.2006_*.nc’</p></li>
<li><p><strong>init_date</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code> object that indicates the start
date/time of the Thetis simulation. Must contain time zone. E.g.
‘datetime(2006, 5, 1, tzinfo=pytz.utc)’</p></li>
<li><p><strong>target_coordsys</strong> – coordinate system in which the model grid is
defined. This is used to rotate vectors to local coordinates.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.ATMInterpolator.set_fields">
<code class="sig-name descname">set_fields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMInterpolator.set_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.ATMInterpolator.set_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time.</p>
<p>Performs interpolation and updates the output wind stress and
atmospheric pressure fields in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Thetis simulation time in seconds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.ATMNetCDFTime">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">ATMNetCDFTime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">max_duration</span><span class="o">=</span><span class="default_value">86400.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMNetCDFTime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.ATMNetCDFTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.NetCDFTimeParser" title="thetis.interpolation.NetCDFTimeParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.NetCDFTimeParser</span></code></a></p>
<p>A TimeParser class for reading WRF/NAM atmospheric forecast files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – </p></li>
<li><p><strong>max_duration</strong> – Time span to read from each file (in secords,
default one day). Forecast files are usually daily files that
contain forecast for &gt; 1 days.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">FES2004TidalBoundaryForcing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elev_field</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">target_coordsys</span></em>, <em class="sig-param"><span class="n">uv_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constituents</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">boundary_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_dir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#FES2004TidalBoundaryForcing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.TidalBoundaryForcing" title="thetis.forcing.TidalBoundaryForcing"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.forcing.TidalBoundaryForcing</span></code></a></p>
<p>Tidal boundary interpolator for FES2004 tidal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>target_coordsys</strong> – coordinate system in which the model grid is
defined. This is used to rotate vectors to local coordinates.</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
</ul>
</dd>
<dt class="field-even">Kward data_dir</dt>
<dd class="field-even"><p>path to directory where tidal model netCDF files are
located.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing.compute_velocity">
<code class="sig-name descname">compute_velocity</code><em class="property"> = False</em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.compute_velocity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing.coord_layout">
<code class="sig-name descname">coord_layout</code><em class="property"> = 'lat,lon'</em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.coord_layout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing.elev_nc_file">
<code class="sig-name descname">elev_nc_file</code><em class="property"> = 'tide.fes2004.nc'</em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.elev_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing.grid_nc_file">
<code class="sig-name descname">grid_nc_file</code><em class="property"> = None</em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.grid_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.FES2004TidalBoundaryForcing.uv_nc_file">
<code class="sig-name descname">uv_nc_file</code><em class="property"> = None</em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.uv_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.LiveOceanInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">LiveOceanInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">field_names</span></em>, <em class="sig-param"><span class="n">ncfile_pattern</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#LiveOceanInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.LiveOceanInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates LiveOcean (ROMS) model data on 3D fields</p>
<dl class="py method">
<dt id="thetis.forcing.LiveOceanInterpolator.set_fields">
<code class="sig-name descname">set_fields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#LiveOceanInterpolator.set_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.LiveOceanInterpolator.set_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.NCOMInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">NCOMInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space_2d</span></em>, <em class="sig-param"><span class="n">function_space_3d</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">field_names</span></em>, <em class="sig-param"><span class="n">field_fnstr</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">basedir</span></em>, <em class="sig-param"><span class="n">file_pattern</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">target_coordsys</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#NCOMInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.NCOMInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates NCOM model data on 3D fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following NCOM output files must be present:
./forcings/ncom/model_h.nc
./forcings/ncom/model_lat.nc
./forcings/ncom/model_ang.nc
./forcings/ncom/model_lon.nc
./forcings/ncom/model_zm.nc
./forcings/ncom/2006/s3d/s3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/s3d/s3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/t3d/t3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/t3d/t3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/u3d/u3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/u3d/u3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/v3d/v3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/v3d/v3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/ssh/ssh.glb8_2f_2006041900.nc
./forcings/ncom/2006/ssh/ssh.glb8_2f_2006042000.nc</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space_2d</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which 2D data will be interpolated.</p></li>
<li><p><strong>function_space_3d</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which 3D data will be interpolated.</p></li>
<li><p><strong>fields</strong> – list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> objects where data will be
stored.</p></li>
<li><p><strong>field_names</strong> – List of netCDF variable names for the fields. E.g.
[‘Salinity’, ‘Temperature’].</p></li>
<li><p><strong>field_fnstr</strong> – List of variables in netCDF file names. E.g.
[‘s3d’, ‘t3d’].</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>basedir</strong> – Root dir where NCOM files are stored.
E.g. ‘/forcings/ncom’.</p></li>
<li><p><strong>file_pattern</strong> – A file name pattern for reading the NCOM output
files (excluding the basedir). E.g.
{year:04d}/{fieldstr:}/{fieldstr:}.glb8_2f_{year:04d}{month:02d}{day:02d}00.nc’.</p></li>
<li><p><strong>init_date</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code> object that indicates the start
date/time of the Thetis simulation. Must contain time zone. E.g.
‘datetime(2006, 5, 1, tzinfo=pytz.utc)’</p></li>
<li><p><strong>target_coordsys</strong> – coordinate system in which the model grid is
defined. This is used to rotate vectors to local coordinates.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.NCOMInterpolator.set_fields">
<code class="sig-name descname">set_fields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#NCOMInterpolator.set_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.NCOMInterpolator.set_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.SpatialInterpolatorNCOM2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">SpatialInterpolatorNCOM2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">grid_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="thetis.forcing.SpatialInterpolatorNCOMBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.forcing.SpatialInterpolatorNCOMBase</span></code></a></p>
<p>Spatial interpolator class for interpolatin NCOM ocean model 2D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.SpatialInterpolatorNCOM2d.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nc_filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">itime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM2d.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM2d.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.SpatialInterpolatorNCOM3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">SpatialInterpolatorNCOM3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">grid_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="thetis.forcing.SpatialInterpolatorNCOMBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.forcing.SpatialInterpolatorNCOMBase</span></code></a></p>
<p>Spatial interpolator class for interpolatin NCOM ocean model 3D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.SpatialInterpolatorNCOM3d.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nc_filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">itime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM3d.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM3d.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.SpatialInterpolatorNCOMBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">SpatialInterpolatorNCOMBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">grid_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOMBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.SpatialInterpolator</span></code></a></p>
<p>Base class for 2D and 3D NCOM spatial interpolators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.SpatialInterpolatorROMS3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">SpatialInterpolatorROMS3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorROMS3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorROMS3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.SpatialInterpolator</span></code></a></p>
<p>Abstract spatial interpolator class that can interpolate onto a Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.SpatialInterpolatorROMS3d.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nc_filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">itime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorROMS3d.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorROMS3d.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">TPXOTidalBoundaryForcing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elev_field</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">target_coordsys</span></em>, <em class="sig-param"><span class="n">uv_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constituents</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">boundary_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_dir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TPXOTidalBoundaryForcing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.TidalBoundaryForcing" title="thetis.forcing.TidalBoundaryForcing"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.forcing.TidalBoundaryForcing</span></code></a></p>
<p>Tidal boundary interpolator for TPXO tidal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>target_coordsys</strong> – coordinate system in which the model grid is
defined. This is used to rotate vectors to local coordinates.</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
</ul>
</dd>
<dt class="field-even">Kward data_dir</dt>
<dd class="field-even"><p>path to directory where tidal model netCDF files are
located.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing.compute_velocity">
<code class="sig-name descname">compute_velocity</code><em class="property"> = True</em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.compute_velocity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing.coord_layout">
<code class="sig-name descname">coord_layout</code><em class="property"> = 'lon,lat'</em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.coord_layout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing.elev_nc_file">
<code class="sig-name descname">elev_nc_file</code><em class="property"> = 'h_tpxo9.v1.nc'</em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.elev_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing.grid_nc_file">
<code class="sig-name descname">grid_nc_file</code><em class="property"> = 'grid_tpxo9.nc'</em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.grid_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.forcing.TPXOTidalBoundaryForcing.uv_nc_file">
<code class="sig-name descname">uv_nc_file</code><em class="property"> = 'u_tpxo9.v1.nc'</em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.uv_nc_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.forcing.TidalBoundaryForcing">
<em class="property">class </em><code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">TidalBoundaryForcing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elev_field</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em>, <em class="sig-param"><span class="n">target_coordsys</span></em>, <em class="sig-param"><span class="n">uv_field</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constituents</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">boundary_ids</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_dir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TidalBoundaryForcing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for tidal boundary interpolators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
<li><p><strong>target_coordsys</strong> – coordinate system in which the model grid is
defined. This is used to rotate vectors to local coordinates.</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
</ul>
</dd>
<dt class="field-even">Kward data_dir</dt>
<dd class="field-even"><p>path to directory where tidal model netCDF files are
located.</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.compute_velocity">
<em class="property">abstract property </em><code class="sig-name descname">compute_velocity</code><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.compute_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, compute tidal currents as well.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.coord_layout">
<em class="property">abstract property </em><code class="sig-name descname">coord_layout</code><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.coord_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Data layout in the netcdf files.</p>
<p>Either ‘lon,lat’ or ‘lat,lon’.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.elev_nc_file">
<em class="property">abstract property </em><code class="sig-name descname">elev_nc_file</code><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.elev_nc_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Tidal elavation NetCDF file name.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.grid_nc_file">
<em class="property">abstract property </em><code class="sig-name descname">grid_nc_file</code><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.grid_nc_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Grid NetCDF file name.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.set_tidal_field">
<code class="sig-name descname">set_tidal_field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TidalBoundaryForcing.set_tidal_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.set_tidal_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.forcing.TidalBoundaryForcing.uv_nc_file">
<em class="property">abstract property </em><code class="sig-name descname">uv_nc_file</code><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.uv_nc_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Tidal velocity NetCDF file name.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.forcing.compute_wind_stress">
<code class="sig-prename descclassname">thetis.forcing.</code><code class="sig-name descname">compute_wind_stress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wind_u</span></em>, <em class="sig-param"><span class="n">wind_v</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'LargePond1981'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#compute_wind_stress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.forcing.compute_wind_stress" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute wind stress from atmospheric 10 m wind.</p>
<p>wind stress is defined as</p>
<p>where <span class="math notranslate nohighlight">\(C_D\)</span> is the drag coefficient, <span class="math notranslate nohighlight">\(\rho_{air}\)</span> is the density of
air, and <span class="math notranslate nohighlight">\(U_{10}\)</span> is wind speed 10 m above the sea surface.</p>
<p>In practice <cite>C_D</cite> depends on the wind speed.</p>
<p>Two formulation are currently implemented:</p>
<ul class="simple">
<li><dl class="simple">
<dt>“LargePond1981”:</dt><dd><p>Wind stress formulation by [1]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“SmithBanke1975”:</dt><dd><p>Wind stress formulation by [2]</p>
</dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>[1] Large and Pond (1981). Open Ocean Momentum Flux Measurements in</dt><dd><p>Moderate to Strong Winds. Journal of Physical Oceanography,
11(3):324-336.
<a class="reference external" href="https://doi.org/10.1175/1520-0485(1981)011%3C0324:OOMFMI%3E2.0.CO;2">https://doi.org/10.1175/1520-0485(1981)011%3C0324:OOMFMI%3E2.0.CO;2</a></p>
</dd>
<dt>[2] Smith and Banke (1975). Variation of the sea surface drag coefficient with</dt><dd><p>wind speed. Q J R Meteorol Soc., 101(429):665-673.
<a class="reference external" href="https://doi.org/10.1002/qj.49710142920">https://doi.org/10.1002/qj.49710142920</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wind_v</strong> (<em>wind_u</em><em>,</em>) – Wind u and v components as numpy arrays</p></li>
<li><p><strong>method</strong> – Choose the stress formulation. Currently supports:
‘LargePond1981’ (default) or ‘SmithBanke1975’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(tau_x, tau_y) wind stress x and y components as numpy arrays</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-thetis.implicitexplicit">
<span id="thetis-implicitexplicit-module"></span><h2>thetis.implicitexplicit module<a class="headerlink" href="#module-thetis.implicitexplicit" title="Permalink to this headline">¶</a></h2>
<p>Implicit-explicit time integrators</p>
<dl class="py class">
<dt id="thetis.implicitexplicit.IMEXEuler">
<em class="property">class </em><code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">IMEXEuler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_dirk</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>Forward-Backward Euler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXEuler.dirk_class">
<code class="sig-name descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.BackwardEuler</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXEuler.erk_class">
<code class="sig-name descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKEuler" title="thetis.rungekutta.ERKEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKEuler</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.implicitexplicit.IMEXGeneric">
<em class="property">class </em><code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">IMEXGeneric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_dirk</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Generic implementation of Runge-Kutta Implicit-Explicit schemes</p>
<p>Derived classes must define the implicit <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="thetis.implicitexplicit.IMEXGeneric.dirk_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dirk_class</span></code></a> and explicit
<a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="thetis.implicitexplicit.IMEXGeneric.erk_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">erk_class</span></code></a> Runge-Kutta time integrator classes.</p>
<p>This method solves the linearized equations: All implicit terms are fed to
the implicit solver, while all the other terms are fed to the explicit
solver. In case of non-linear terms proper linearization must defined in the
equation using the two solution functions (solution, solution_old)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.dirk_class">
<em class="property">abstract property </em><code class="sig-name descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Implicit DIRK class</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.erk_class">
<em class="property">abstract property </em><code class="sig-name descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicit Runge-Kutta class</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.get_final_solution">
<code class="sig-name descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the final solution.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.set_dt">
<code class="sig-name descname">set_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Update time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.implicitexplicit.IMEXGeneric.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.implicitexplicit.IMEXLPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">IMEXLPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_dirk</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (20) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXLPUM2.dirk_class">
<code class="sig-name descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRKLPUM2" title="thetis.rungekutta.DIRKLPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKLPUM2</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXLPUM2.erk_class">
<code class="sig-name descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2" title="thetis.rungekutta.ERKLPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKLPUM2</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.implicitexplicit.IMEXLSPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">IMEXLSPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_dirk</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (17) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXLSPUM2.dirk_class">
<code class="sig-name descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRKLSPUM2" title="thetis.rungekutta.DIRKLSPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKLSPUM2</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXLSPUM2.erk_class">
<code class="sig-name descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2" title="thetis.rungekutta.ERKLSPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKLSPUM2</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.implicitexplicit.IMEXMidpoint">
<em class="property">class </em><code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">IMEXMidpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_dirk</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>Implicit-explicit midpoint scheme (1, 2, 2) from Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXMidpoint.dirk_class">
<code class="sig-name descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ESDIRKMidpoint" title="thetis.rungekutta.ESDIRKMidpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ESDIRKMidpoint</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.implicitexplicit.IMEXMidpoint.erk_class">
<code class="sig-name descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKMidpoint" title="thetis.rungekutta.ERKMidpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKMidpoint</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.implicitexplicit.timed_region">
<code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.implicitexplicit.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.implicitexplicit.timed_stage">
<code class="sig-prename descclassname">thetis.implicitexplicit.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.implicitexplicit.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.interpolation">
<span id="thetis-interpolation-module"></span><h2>thetis.interpolation module<a class="headerlink" href="#module-thetis.interpolation" title="Permalink to this headline">¶</a></h2>
<p>Methods for interpolating data from structured data sets on Thetis fields.</p>
<p>Simple example of an atmospheric pressure interpolator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_latlon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">positive_lon</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># Converts mesh (x,y) points to coordinates used in the atm data</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">coordsys_spcs</span><span class="o">.</span><span class="n">spcs2lonlat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">positive_lon</span> <span class="ow">and</span> <span class="n">lon</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">lon</span> <span class="o">+=</span> <span class="mf">360.</span>
    <span class="k">return</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span>


<span class="k">class</span> <span class="nc">WRFInterpolator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># Interpolates WRF atmospheric model data on 2D fields</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_space</span><span class="p">,</span> <span class="n">atm_pressure_field</span><span class="p">,</span> <span class="n">ncfile_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atm_pressure_field</span> <span class="o">=</span> <span class="n">atm_pressure_field</span>

        <span class="c1"># object that interpolates forcing data from structured grid on the local mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_interpolator</span> <span class="o">=</span> <span class="n">NetCDFLatLonInterpolator2d</span><span class="p">(</span><span class="n">function_space</span><span class="p">,</span> <span class="n">to_latlon</span><span class="p">)</span>
        <span class="c1"># reader object that can read fields from netCDF files, applies spatial interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">NetCDFSpatialInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interpolator</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;prmsl&#39;</span><span class="p">])</span>
        <span class="c1"># object that can find previous/next time stamps in a collection of netCDF files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timesearch_obj</span> <span class="o">=</span> <span class="n">NetCDFTimeSearch</span><span class="p">(</span><span class="n">ncfile_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">,</span> <span class="n">NetCDFTimeParser</span><span class="p">)</span>
        <span class="c1"># finally a linear intepolator class that performs linar interpolation in time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span> <span class="o">=</span> <span class="n">LinearTimeInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesearch_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="c1"># Evaluates forcing fields at the given time</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atm_pressure_field</span><span class="o">.</span><span class="n">dat</span><span class="o">.</span><span class="n">data_with_halos</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">pressure</span>
</pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atm_pressure_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">P1_2d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;atm pressure&#39;</span><span class="p">)</span>
<span class="n">wrf_pattern</span> <span class="o">=</span> <span class="s1">&#39;forcings/atm/wrf/wrf_air.2016_*_*.nc&#39;</span>
<span class="n">wrf_atm</span> <span class="o">=</span> <span class="n">WRFInterpolator</span><span class="p">(</span>
    <span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">P1_2d</span><span class="p">,</span>
    <span class="n">wind_stress_2d</span><span class="p">,</span> <span class="n">atm_pressure_2d</span><span class="p">,</span> <span class="n">wrf_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">)</span>
<span class="n">simulation_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">wrf_atm</span><span class="o">.</span><span class="n">set_fields</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt id="thetis.interpolation.DailyFileTimeSearch">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">DailyFileTimeSearch</code><span class="sig-paren">(</span><em class="sig-param">file_pattern</em>, <em class="sig-param">init_date</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">center_hour=12</em>, <em class="sig-param">center_timezone=&lt;UTC&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeSearch" title="thetis.interpolation.TimeSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.TimeSearch</span></code></a></p>
<p>Treats a list of daily files as a time series.</p>
<p>File name pattern must be given as a string where the 4-digit year is
tagged with “{year:04d}”, and 2-digit zero-padded month and year are tagged
with “{month:02d}” and “{day:02d}”, respectively. The tags can be used
multiple times.</p>
<dl class="simple">
<dt>Example pattern:</dt><dd><p>‘ncom/{year:04d}/s3d.glb8_2f_{year:04d}{month:02d}{day:02d}00.nc’</p>
</dd>
</dl>
<p>In this time search method the time stamps are parsed solely from the
filename, no other metadata is used. By default the data is assumed to be
centered at 12:00 UTC every day.</p>
<dl class="py method">
<dt id="thetis.interpolation.DailyFileTimeSearch.find">
<code class="sig-name descname">find</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simulation_time</span></em>, <em class="sig-param"><span class="n">previous</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Find file that contains the given simulation time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time in seconds</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True finds previous existing time stamp instead
of next (default False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(filename, time index, simulation time) of found data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.DailyFileTimeSearch.simulation_time_to_datetime">
<code class="sig-name descname">simulation_time_to_datetime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch.simulation_time_to_datetime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch.simulation_time_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.FileTreeReader">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">FileTreeReader</code><a class="reference internal" href="_modules/thetis/interpolation.html#FileTreeReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.FileTreeReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class of file tree reader object</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.GridInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">GridInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grid_xyz</span></em>, <em class="sig-param"><span class="n">target_xyz</span></em>, <em class="sig-param"><span class="n">fill_mode</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">nan</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dont_raise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#GridInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.GridInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A reuseable griddata interpolator object.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">interpolator</span> <span class="o">=</span> <span class="n">GridInterpolator</span><span class="p">(</span><span class="n">source_xyz</span><span class="p">,</span> <span class="n">target_xyz</span><span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">source_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">();</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">25.</span><span class="o">*</span><span class="n">y</span>
<span class="n">x_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">interpolator</span> <span class="o">=</span> <span class="n">GridInterpolator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Based on
<a class="reference external" href="http://stackoverflow.com/questions/20915502/speedup-scipy-griddata-for-multiple-interpolations-between-two-irregular-grids">http://stackoverflow.com/questions/20915502/speedup-scipy-griddata-for-multiple-interpolations-between-two-irregular-grids</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_xyz</strong> – Array of source grid coordinates, shape (npoints, 2) or
(npoints, 3)</p></li>
<li><p><strong>target_xyz</strong> – Array of target grid coordinates, shape (n, 2) or
(n, 3)</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true the data is scaled to unit cube before
interpolation. Default: False.</p></li>
<li><p><strong>dont_raise</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Do not raise a Qhull error if triangulation
fails. In this case the data will be set to fill value or nearest
neighbor value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.LinearTimeInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">LinearTimeInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timesearch_obj</span></em>, <em class="sig-param"><span class="n">reader</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#LinearTimeInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.LinearTimeInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates time series in time</p>
<p>User must provide timesearch_obj that finds time stamps from
a file tree, and a reader that can read those time stamps into numpy arrays.</p>
<p>Previous/next data sets are cached in memory to avoid hitting disk every
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timesearch_obj</strong> – TimeSearch object</p></li>
<li><p><strong>reader</strong> – FileTreeReader object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFLatLonInterpolator2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFLatLonInterpolator2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFLatLonInterpolator2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFLatLonInterpolator2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator2d" title="thetis.interpolation.SpatialInterpolator2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.SpatialInterpolator2d</span></code></a></p>
<p>Interpolates netCDF data on a local 2D unstructured mesh</p>
<p>The intepolator is constructed for a single netCDF file that defines the
source grid. Once the interpolator has been constructed, data can be read
from any file that uses the same grid.</p>
<p>This routine returns the data in numpy arrays.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">myfunc</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">ncinterp2d</span> <span class="o">=</span> <span class="n">NetCDFLatLonInterpolator2d</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">to_latlon</span><span class="p">,</span> <span class="n">nc_filename</span><span class="p">)</span>
<span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="o">=</span> <span class="n">ncinterp2d</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">nc_filename</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">myfunc</span><span class="o">.</span><span class="n">dat</span><span class="o">.</span><span class="n">data_with_halos</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">val1</span> <span class="o">+</span> <span class="n">val2</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.interpolation.NetCDFLatLonInterpolator2d.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nc_filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">itime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFLatLonInterpolator2d.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFLatLonInterpolator2d.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates data from a netCDF file onto Firedrake function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nc_filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – netCDF file to read</p></li>
<li><p><strong>variable_list</strong> – list of netCDF variable names to read</p></li>
<li><p><strong>itime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – time index to read</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of numpy.arrays corresponding to variable_list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFSpatialInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFSpatialInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grid_interpolator</span></em>, <em class="sig-param"><span class="n">variable_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFSpatialInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFSpatialInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.FileTreeReader" title="thetis.interpolation.FileTreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.FileTreeReader</span></code></a></p>
<p>Wrapper class that provides FileTreeReader API for grid interpolators</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFTimeParser">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFTimeParser</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">time_variable_name</span><span class="o">=</span><span class="default_value">'time'</span></em>, <em class="sig-param"><span class="n">allow_gaps</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeParser" title="thetis.interpolation.TimeParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.TimeParser</span></code></a></p>
<p>Describes the time stamps stored in a netCDF file.</p>
<p>Construct a new object by scraping data from the given netcdf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of the netCDF file to read</p></li>
<li><p><strong>time_variable_name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of the time variable in the netCDF
file (default: ‘time’)</p></li>
<li><p><strong>allow_gaps</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if False, an error is raised if time step is
not constant.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.interpolation.NetCDFTimeParser.find_time_stamp">
<code class="sig-name descname">find_time_stamp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">previous</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.find_time_stamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.find_time_stamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Given time t, returns index of the next (previous) time stamp</p>
<p>raises IndexError if t is out of range, i.e.
t &gt; self.get_end_time() or t &lt; self.get_start_time()</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.NetCDFTimeParser.get_end_time">
<code class="sig-name descname">get_end_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.get_end_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.get_end_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the last time stamp in the file/data set</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.NetCDFTimeParser.get_start_time">
<code class="sig-name descname">get_start_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.get_start_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.get_start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first time stamp in the file/data set</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.interpolation.NetCDFTimeParser.scalars">
<code class="sig-name descname">scalars</code><em class="property"> = {'days': 86400.0, 'seconds': 1.0}</em><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.scalars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFTimeSearch">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFTimeSearch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_pattern</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">netcdf_class</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeSearch" title="thetis.interpolation.TimeSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.TimeSearch</span></code></a></p>
<p>Finds a nearest time stamp in a collection of netCDF files.</p>
<dl class="py method">
<dt id="thetis.interpolation.NetCDFTimeSearch.find">
<code class="sig-name descname">find</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simulation_time</span></em>, <em class="sig-param"><span class="n">previous</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Find file that contains the given simulation time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time in seconds</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True finds previous existing time stamp instead
of next (default False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(filename, time index, simulation time) of found data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.NetCDFTimeSearch.simulation_time_to_datetime">
<code class="sig-name descname">simulation_time_to_datetime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch.simulation_time_to_datetime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch.simulation_time_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFTimeSeriesInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFTimeSeriesInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncfile_pattern</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">init_date</span></em>, <em class="sig-param"><span class="n">time_variable_name</span><span class="o">=</span><span class="default_value">'time'</span></em>, <em class="sig-param"><span class="n">scalars</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">allow_gaps</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSeriesInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSeriesInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Reads and interpolates scalar time series from a sequence of netCDF files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncfile_pattern</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – file search pattern, e.g. “mydir/foo_*.nc”</p></li>
<li><p><strong>variable_list</strong> – list if netCDF variable names to read</p></li>
<li><p><strong>init_date</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) – simulation start time</p></li>
<li><p><strong>scalars</strong> – (optional) list of scalars; scale output variables by
a factor.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the variables must have the same dimensions in the netCDF files.
If the shapes differ, create separate interpolator instances.</p>
</div>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.NetCDFTimeSeriesReader">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">NetCDFTimeSeriesReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">time_variable_name</span><span class="o">=</span><span class="default_value">'time'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSeriesReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSeriesReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.FileTreeReader" title="thetis.interpolation.FileTreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.FileTreeReader</span></code></a></p>
<p>A simple netCDF reader that returns a time slice of the given variable.</p>
<p>This class does not interpolate the data in any way. Useful for
interpolating time series.</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.SpatialInterpolator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">SpatialInterpolator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for spatial interpolators that read data from disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.interpolation.SpatialInterpolator.interpolate">
<em class="property">abstract </em><code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">itime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates data from the given file at given time step</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.SpatialInterpolator2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">SpatialInterpolator2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">to_latlon</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.interpolation.SpatialInterpolator</span></code></a></p>
<p>Abstract spatial interpolator class that can interpolate onto a 2D Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>to_latlon</strong> – Python function that converts local mesh coordinates to
latitude and longitude: ‘lat, lon = to_latlon(x, y)’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.interpolation.SpatialInterpolator2d.interpolate">
<em class="property">abstract </em><code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">variable_list</span></em>, <em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator2d.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator2d.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.TimeParser">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">TimeParser</code><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for time definition objects.</p>
<p>Defines the time span that a file (or data set) covers and provides a time
index search routine.</p>
<dl class="py method">
<dt id="thetis.interpolation.TimeParser.find_time_stamp">
<em class="property">abstract </em><code class="sig-name descname">find_time_stamp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">previous</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.find_time_stamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.find_time_stamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Given time t, returns index of the next (previous) time stamp</p>
<p>raises IndexError if t is out of range, i.e.
t &gt; self.get_end_time() or t &lt; self.get_start_time()</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.TimeParser.get_end_time">
<em class="property">abstract </em><code class="sig-name descname">get_end_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.get_end_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.get_end_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the last time stamp in the file/data set</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.interpolation.TimeParser.get_start_time">
<em class="property">abstract </em><code class="sig-name descname">get_start_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.get_start_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.get_start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first time stamp in the file/data set</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.interpolation.TimeSearch">
<em class="property">class </em><code class="sig-prename descclassname">thetis.interpolation.</code><code class="sig-name descname">TimeSearch</code><a class="reference internal" href="_modules/thetis/interpolation.html#TimeSearch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for searching nearest time steps in a file tree or database</p>
<dl class="py method">
<dt id="thetis.interpolation.TimeSearch.find">
<em class="property">abstract </em><code class="sig-name descname">find</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">previous</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeSearch.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.interpolation.TimeSearch.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a next (previous) time stamp from a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – input time stamp</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True, look for last time stamp before requested
time. Otherwise returns next time stamp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a (filename, time_index, time) tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.limiter">
<span id="thetis-limiter-module"></span><h2>thetis.limiter module<a class="headerlink" href="#module-thetis.limiter" title="Permalink to this headline">¶</a></h2>
<p>Slope limiters for discontinuous fields</p>
<dl class="py class">
<dt id="thetis.limiter.VertexBasedP1DGLimiter">
<em class="property">class </em><code class="sig-prename descclassname">thetis.limiter.</code><code class="sig-name descname">VertexBasedP1DGLimiter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p1dg_space</span></em>, <em class="sig-param"><span class="n">time_dependent_mesh</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://firedrakeproject.org/firedrake.slope_limiter.html#firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter</span></code></a></p>
<p>Vertex based limiter for P1DG tracer fields, see Kuzmin (2010)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only scalar fields are supported</p>
</div>
<p>Kuzmin (2010). A vertex-based hierarchical slope limiter
for p-adaptive discontinuous Galerkin methods. Journal of Computational
and Applied Mathematics, 233(12):3077-3085.
<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2009.05.028">http://dx.doi.org/10.1016/j.cam.2009.05.028</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p1dg_space</strong> – P1DG function space</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the limiter on the given field (in place)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>field</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to limit</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.compute_bounds">
<code class="sig-name descname">compute_bounds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.compute_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.compute_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-compute min/max values of all neighbouring centroids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>field</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to limit</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.limiter.assert_function_space">
<code class="sig-prename descclassname">thetis.limiter.</code><code class="sig-name descname">assert_function_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fs</span></em>, <em class="sig-param"><span class="n">family</span></em>, <em class="sig-param"><span class="n">degree</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#assert_function_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.assert_function_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the family and degree of function space.</p>
<p>Raises AssertionError if function space differs.
If the function space lies on an extruded mesh, checks both spaces of the
outer product.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fs</strong> – function space</p></li>
<li><p><strong>family</strong> (<em>string</em>) – name of element family</p></li>
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – polynomial degree of the function space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.limiter.timed_region">
<code class="sig-prename descclassname">thetis.limiter.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.limiter.timed_stage">
<code class="sig-prename descclassname">thetis.limiter.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.log">
<span id="thetis-log-module"></span><h2>thetis.log module<a class="headerlink" href="#module-thetis.log" title="Permalink to this headline">¶</a></h2>
<p>Loggers for Thetis</p>
<p>Creates two logger instances, one for general model output and one for debug,
warning, error etc. messages.</p>
<p>To print to the model output stream, use <a class="reference internal" href="#thetis.log.print_output" title="thetis.log.print_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_output()</span></code></a>.</p>
<p>Debug, warning etc. messages are issued with <a class="reference internal" href="#thetis.log.debug" title="thetis.log.debug"><code class="xref py py-func docutils literal notranslate"><span class="pre">debug()</span></code></a>, <a class="reference internal" href="#thetis.log.info" title="thetis.log.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a>,
<a class="reference internal" href="#thetis.log.warning" title="thetis.log.warning"><code class="xref py py-func docutils literal notranslate"><span class="pre">warning()</span></code></a>, <a class="reference internal" href="#thetis.log.error" title="thetis.log.error"><code class="xref py py-func docutils literal notranslate"><span class="pre">error()</span></code></a>, <a class="reference internal" href="#thetis.log.critical" title="thetis.log.critical"><code class="xref py py-func docutils literal notranslate"><span class="pre">critical()</span></code></a> methods.</p>
<dl class="py function">
<dt id="thetis.log.debug">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">debug</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.log.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘DEBUG’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.debug(“Houston, we have a %s”, “thorny problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.log.info">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.log.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.log.warning">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">warning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#warning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.log.warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘WARNING’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.warning(“Houston, we have a %s”, “bit of a problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.log.error">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.log.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘ERROR’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.error(“Houston, we have a %s”, “major problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.log.critical">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">critical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.log.critical" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘CRITICAL’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.critical(“Houston, we have a %s”, “major disaster”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.log.print_output">
<code class="sig-prename descclassname">thetis.log.</code><code class="sig-name descname">print_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.log.print_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.momentum_eq">
<span id="thetis-momentum-eq-module"></span><h2>thetis.momentum_eq module<a class="headerlink" href="#module-thetis.momentum_eq" title="Permalink to this headline">¶</a></h2>
<p>3D momentum equation for hydrostatic Boussinesq flow.</p>
<p>The three dimensional momentum equation reads</p>
<div class="math notranslate nohighlight" id="equation-mom-eq">
<span class="eqno">(2)<a class="headerlink" href="#equation-mom-eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial \textbf{u}}{\partial t}
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u} + g\nabla_h \eta + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{u}\)</span> and <span class="math notranslate nohighlight">\(w\)</span> denote horizontal and vertical velocity,
<span class="math notranslate nohighlight">\(\nabla_h\)</span> is the horizontal gradient,
<span class="math notranslate nohighlight">\(\wedge\)</span> denotes the cross product,
<span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration, <span class="math notranslate nohighlight">\(f\)</span> is the Coriolis
frequency, <span class="math notranslate nohighlight">\(\textbf{e}_z\)</span> is a vertical unit vector, and
<span class="math notranslate nohighlight">\(\nu_h, \nu\)</span> stand for horizontal and vertical viscosity.
Water density is given by <span class="math notranslate nohighlight">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math notranslate nohighlight">\(\rho_0\)</span> is a constant reference density.
Above <span class="math notranslate nohighlight">\(r\)</span> denotes the baroclinic head</p>
<div class="math notranslate nohighlight" id="equation-baroc-head">
<span class="eqno">(3)<a class="headerlink" href="#equation-baroc-head" title="Permalink to this equation">¶</a></span>\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>The internal pressure gradient is computed as a separate diagnostic field:</p>
<div class="math notranslate nohighlight" id="equation-int-pg-eq">
<span class="eqno">(4)<a class="headerlink" href="#equation-int-pg-eq" title="Permalink to this equation">¶</a></span>\[\mathbf{F}_{pg} = g\nabla_h r.\]</div>
<p>In the case of purely barotropic problems the <span class="math notranslate nohighlight">\(r\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{F}_{pg}\)</span> fields are omitted.</p>
<p>When using mode splitting we split the velocity field into a depth average and
a deviation, <span class="math notranslate nohighlight">\(\textbf{u} = \bar{\textbf{u}} + \textbf{u}'\)</span>.
Following Higdon and de Szoeke (1997) we write an equation for the deviation
<span class="math notranslate nohighlight">\(\textbf{u}'\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-mom-eq-split">
<span class="eqno">(5)<a class="headerlink" href="#equation-mom-eq-split" title="Permalink to this equation">¶</a></span>\[\frac{\partial \textbf{u}'}{\partial t} =
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u}' + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu  \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>In <a class="reference internal" href="#equation-mom-eq-split">(5)</a> the external pressure gradient <span class="math notranslate nohighlight">\(g\nabla_h \eta\)</span> vanishes and the
Coriolis term only contains the deviation <span class="math notranslate nohighlight">\(\textbf{u}'\)</span>.
Advection and diffusion terms are not changed.</p>
<p>Higdon and de Szoeke (1997). Barotropic-Baroclinic Time Splitting for Ocean
Circulation Modeling. Journal of Computational Physics, 135(1):30-53.
<a class="reference external" href="http://dx.doi.org/10.1006/jcph.1997.5733">http://dx.doi.org/10.1006/jcph.1997.5733</a></p>
<dl class="py class">
<dt id="thetis.momentum_eq.MomentumEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">MomentumEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 8)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 9)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Hydrostatic 3D momentum equation <a class="reference internal" href="#equation-mom-eq-split">(5)</a> for mode split models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.MomentumTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">MomentumTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term for momentum equation that provides commonly used members and
mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Horizontal advection term, <span class="math notranslate nohighlight">\(\nabla_h \cdot (\textbf{u} \textbf{u})\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla_h \cdot (\textbf{u} \textbf{u}) \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \boldsymbol{\psi} : (\textbf{u} \textbf{u}) dx
+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \textbf{u}^{\text{up}} \cdot
\text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}(\textbf{u}) dS\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(:\)</span> stand for
the Frobenius inner product, <span class="math notranslate nohighlight">\(\textbf{n}_h\)</span> is the horizontal
projection of the normal vector, <span class="math notranslate nohighlight">\(\textbf{u}^{\text{up}}\)</span> is the
upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Vertical advection term, <span class="math notranslate nohighlight">\(\partial \left(w\textbf{u} \right)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \frac{\partial \left(w\textbf{u} \right)}{\partial z} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \left( w \textbf{u} \right) \cdot \frac{\partial \boldsymbol{\psi}}{\partial z} dx
+ \int_{\mathcal{I}_{h}} \textbf{u}^{\text{up}} \cdot \text{jump}(\boldsymbol{\psi} n_z) \text{avg}(w) dS\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Horizontal viscosity term, <span class="math notranslate nohighlight">\(- \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right) \cdot \boldsymbol{\psi} dx
=&amp; -\int_\Omega \nu_h (\nabla_h \boldsymbol{\psi}) : (\nabla_h \textbf{u})^T dx \\
&amp;+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \textbf{u}) dS
+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \boldsymbol{\psi}) dS \\
&amp;- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \sigma \text{avg}(\nu_h) \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.VerticalViscosityTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">VerticalViscosityTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Vertical viscosity term, <span class="math notranslate nohighlight">\(- \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right) \cdot \boldsymbol{\psi} dx
=&amp; -\int_\Omega \nu \frac{\partial \boldsymbol{\psi}}{\partial z} \cdot \frac{\partial \textbf{u}}{\partial z} dx \\
&amp;+ \int_{\mathcal{I}_h} \text{jump}(\boldsymbol{\psi} n_z) \cdot \text{avg}\left(\nu \frac{\partial \textbf{u}}{\partial z}\right) dS
+ \int_{\mathcal{I}_h} \text{jump}(\textbf{u} n_z) \cdot \text{avg}\left(\nu \frac{\partial \boldsymbol{\psi}}{\partial z}\right) dS \\
&amp;- \int_{\mathcal{I}_h} \sigma \text{avg}(\nu) \text{jump}(\textbf{u} n_z) \cdot \text{jump}(\boldsymbol{\psi} n_z) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.VerticalViscosityTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.PressureGradientTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">PressureGradientTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Internal pressure gradient term, <span class="math notranslate nohighlight">\(g\nabla_h r\)</span></p>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the baroclinic head <a class="reference internal" href="#equation-baroc-head">(3)</a>. Let <span class="math notranslate nohighlight">\(s\)</span>
denote <span class="math notranslate nohighlight">\(r/H\)</span>. We can then write</p>
<div class="math notranslate nohighlight">
\[F_{IPG} = g\nabla_h((s -\bar{s}) H)
    + g\nabla_h\left(\frac{1}{H}\right) H^2\bar{s}
    + g s_{bot}\nabla_h h\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{s},s_{bot}\)</span> are the depth average and bottom value of
<span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(s\)</span> belongs to a discontinuous function space, the first term is
integrated by parts. Its weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g\nabla_h((s -\bar{s}) H) \cdot \boldsymbol{\psi} dx
    = - \int_\Omega g (s -\bar{s}) H \nabla_h \cdot \boldsymbol{\psi} dx
    + \int_{\mathcal{I}_h \cup \mathcal{I}_v} g (s -\bar{s}) H \boldsymbol{\psi}  \cdot \textbf{n}_h dx\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.PressureGradientTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.CoriolisTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">CoriolisTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math notranslate nohighlight">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.CoriolisTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.BottomFrictionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">BottomFrictionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Quadratic bottom friction term, <span class="math notranslate nohighlight">\(\tau_b = C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>The weak formulation reads</p>
<div class="math notranslate nohighlight">
\[\int_{\Gamma_{bot}} \tau_b \cdot \boldsymbol{\psi} dx = \int_{\Gamma_{bot}} C_D \| \textbf{u}_b \| \textbf{u}_b \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{u}_b\)</span> is reconstructed velocity in the middle of the
bottom element:</p>
<div class="math notranslate nohighlight">
\[\textbf{u}_b = \textbf{u}\Big|_{\Gamma_{bot}} + \frac{\partial \textbf{u}}{\partial z}\Big|_{\Gamma_{bot}} h_b,\]</div>
<p><span class="math notranslate nohighlight">\(h_b\)</span> being half of the element height.
For implicit solvers we linearize the stress as
<span class="math notranslate nohighlight">\(\tau_b = C_D \| \textbf{u}_b^{n} \| \textbf{u}_b^{n+1}\)</span></p>
<p>The drag is computed from the law-of-the wall</p>
<div class="math notranslate nohighlight">
\[C_D = \left( \frac{\kappa}{\ln (h_b + z_0)/z_0} \right)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(z_0\)</span> is the bottom roughness length field.
The user can override the <span class="math notranslate nohighlight">\(C_D\)</span> value by providing <code class="docutils literal notranslate"><span class="pre">quadratic_drag_coefficient</span></code>
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.BottomFrictionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.LinearDragTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">LinearDragTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Linear drag term, <span class="math notranslate nohighlight">\(\tau_b = D \textbf{u}_b\)</span></p>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the drag coefficient, read from <code class="docutils literal notranslate"><span class="pre">linear_drag_coefficient</span></code> field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.LinearDragTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.SourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">SourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bottom_friction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 6)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Generic momentum source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<p>This term also implements the wind stress, <span class="math notranslate nohighlight">\(-\tau_w/(H \rho_0)\)</span>.
<span class="math notranslate nohighlight">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>
<code class="docutils literal notranslate"><span class="pre">wind_stress</span></code>. The weak form is</p>
<div class="math notranslate nohighlight">
\[F_w = \int_{\Gamma_s} \frac{1}{\rho_0} \tau_w \cdot \boldsymbol{\psi} dx\]</div>
<p>Wind stress is only included if vertical viscosity is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.SourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.momentum_eq.InternalPressureGradientCalculator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.momentum_eq.</code><code class="sig-name descname">InternalPressureGradientCalculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">bathymetry</span></em>, <em class="sig-param"><span class="n">options</span></em>, <em class="sig-param"><span class="n">bnd_functions</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Computes the internal pressure gradient term, <span class="math notranslate nohighlight">\(g\nabla_h r\)</span></p>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the baroclinic head <a class="reference internal" href="#equation-baroc-head">(3)</a>.</p>
<p>If <span class="math notranslate nohighlight">\(r\)</span> belongs to a discontinuous function space, the term is
integrated by parts:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g \nabla_h r \cdot \boldsymbol{\psi} dx
    = - \int_\Omega g r \nabla_h \cdot \boldsymbol{\psi} dx
    + \int_{\mathcal{I}_h \cup \mathcal{I}_v} g \text{avg}(r) \text{jump}(\boldsymbol{\psi} \cdot \textbf{n}_h) dx\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code> sign convention this term is assembled on the right-hand-side.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – <cite>class`FlowSolver</cite> object</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.momentum_eq.InternalPressureGradientCalculator.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.momentum_eq.InternalPressureGradientCalculator.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes internal pressure gradient and stores it in int_pg_3d field</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.optimisation">
<span id="thetis-optimisation-module"></span><h2>thetis.optimisation module<a class="headerlink" href="#module-thetis.optimisation" title="Permalink to this headline">¶</a></h2>
<p>Some classes to help optimisation problems formulated with thetis_adjoint.</p>
<p>In particular this module contains some OptimisationCallbacks that can be used
as callbacks of a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> called at various stages during the optimisation
process:
- eval_cb_pre(controls) and eval_cb_post(functional, controls)                    called before and after (re)evaluation of the forward model
- derivative_cb_pre(controls) and eval_cb_post(functional, derivative, controls)  called before and after the gradient computation using the adjoint of the model
- hessian_cb_pre(controls) and eval_cb_post(functional, derivative, controls)     called before and after the hessian computation
OptimisationCallbacks that (can) use controls, functional and derivative information, work out
what is provided by the number of arguments: current control values are always in the last argument;
if more than 2 arguments are provided, the first is the latest evaluated functional value.</p>
<dl class="py class">
<dt id="thetis.optimisation.ControlsExportOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">ControlsExportOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj_or_outputdir</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ControlsExportOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.ControlsExportOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DeferredExportManager" title="thetis.optimisation.DeferredExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.optimisation.DeferredExportManager</span></code></a></p>
<p>A callback that exports the current control values (assumed to all be <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s)</p>
<p>The control values are assumed to be the last argument in the callback (as for all <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> callbacks).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.DeferredExportManager">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">DeferredExportManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj_or_outputdir</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DeferredExportManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DeferredExportManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A wrapper around a UserExportManager that is only created on the first export() call.</p>
<p>In addition the functions provided in the export call are copied into a fixed set of functions,
where the functions provided in subsequent calls may be different (they need to be in the same
function space). This is used in the <a class="reference internal" href="#thetis.optimisation.ControlsExportOptimisationCallback" title="thetis.optimisation.ControlsExportOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ControlsExportOptimisationCallback</span></code></a>
and <a class="reference internal" href="#thetis.optimisation.DerivativesExportOptimisationCallback" title="thetis.optimisation.DerivativesExportOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativesExportOptimisationCallback</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.optimisation.DeferredExportManager.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">functions</span></em>, <em class="sig-param"><span class="n">suggested_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DeferredExportManager.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DeferredExportManager.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> (first call only), and call its export() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>functions</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s that the <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> will be based on. Their values
are first copied. The list may contain different functions in subsequent calls,
but their function space should remain the same.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.DerivativesExportOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">DerivativesExportOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj_or_outputdir</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativesExportOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DerivativesExportOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DeferredExportManager" title="thetis.optimisation.DeferredExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.optimisation.DeferredExportManager</span></code></a></p>
<p>A callback that exports the derivatives calculated by the adjoint.</p>
<p>The derivatives are assumed to be the second argument in the callback. This can therefore
be used as a derivative_cb_post callback in a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.DiagnosticOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">DiagnosticOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>An OptimsationCallback similar to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> that can be used as callback in a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code>.</p>
<p>Note that in this case the computing of the values needs to be defined in the compute_values method,
not in the __call__ method (as this one is directly called from the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code>). In addition,
like any <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>, the name and variable_names properties and a message_str method need to be defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.optimisation.DiagnosticOptimisationCallback.compute_values">
<em class="property">abstract </em><code class="sig-name descname">compute_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback.compute_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback.compute_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.optimisation.DiagnosticOptimisationCallback.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf file (if enabled)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.FunctionalOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">FunctionalOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.optimisation.DiagnosticOptimisationCallback</span></code></a></p>
<p>A simple OptimisationCallback that records the functional value in the log and/or hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.optimisation.FunctionalOptimisationCallback.compute_values">
<code class="sig-name descname">compute_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback.compute_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.compute_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.optimisation.FunctionalOptimisationCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">functional</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.optimisation.FunctionalOptimisationCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'functional'</em><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.optimisation.FunctionalOptimisationCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['functional']</em><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.OptimisationCallbackList">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">OptimisationCallbackList</code><a class="reference internal" href="_modules/thetis/optimisation.html#OptimisationCallbackList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.OptimisationCallbackList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>A list of callbacks that can be used as a single callback itself.</p>
<p>Calls all callbacks in order.</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.UserExportManager">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">UserExportManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj_or_outputdir</span></em>, <em class="sig-param"><span class="n">functions_to_export</span></em>, <em class="sig-param"><span class="n">filenames</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename_prefix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">shortnames</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#UserExportManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.UserExportManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.exporter.ExportManager</span></code></a></p>
<p>ExportManager for user provided functions (not necessarily known to Thetis)</p>
<p>In the standard <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportManager</span></code></a> all provided functions need to have standard names
present in <a class="reference internal" href="#thetis.field_defs.field_metadata" title="thetis.field_defs.field_metadata"><code class="xref py py-data docutils literal notranslate"><span class="pre">field_metadata</span></code></a>. Here, any functions can be provided. If function.name() is in
<a class="reference internal" href="#thetis.field_defs.field_metadata" title="thetis.field_defs.field_metadata"><code class="xref py py-data docutils literal notranslate"><span class="pre">field_metadata</span></code></a>, the standard filename and shortname  are used.
If the function.name() is unknown, both are based on function.name()
directly (with an optional additional filename_prefix). Filenames and
shortnames can be overruled by the shortnames and filenames arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>functions_to_export</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>filenames</strong> – a list of strings that specify the filename for each provided function. If not provided,
filenames are based on function.name().</p></li>
<li><p><strong>filename_prefix</strong> – a string prefixed to each filename</p></li>
<li><p><strong>shortnames</strong> – a list of strings with the shortnames used for each provided function. If not provided,
shortnames are based on function.name().</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.optimisation.UserExportOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.optimisation.</code><code class="sig-name descname">UserExportOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj_or_outputdir</span></em>, <em class="sig-param"><span class="n">functions_to_export</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#UserExportOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.optimisation.UserExportOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.optimisation.UserExportManager</span></code></a></p>
<p>A <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> that can be used as a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> callback</p>
<p>Any callback arguments (functional value, derivatives, controls) are ignored</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>functions_to_export</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-thetis.options">
<span id="thetis-options-module"></span><h2>thetis.options module<a class="headerlink" href="#module-thetis.options" title="Permalink to this headline">¶</a></h2>
<p>Thetis options for the 2D and 3D model</p>
<p>All options are type-checked and they are stored in traitlets Configurable
objects.</p>
<dl class="py class">
<dt id="thetis.options.CommonModelOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">CommonModelOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#CommonModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.CommonModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenConfigurable" title="thetis.configuration.FrozenConfigurable"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenConfigurable</span></code></a></p>
<p>Options that are common for both 2d and 3d models</p>
<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.atmospheric_pressure">
<code class="sig-name descname">atmospheric_pressure</code><a class="headerlink" href="#thetis.options.CommonModelOptions.atmospheric_pressure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.cfl_2d">
<code class="sig-name descname">cfl_2d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.cfl_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.cfl_3d">
<code class="sig-name descname">cfl_3d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.cfl_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.check_volume_conservation_2d">
<code class="sig-name descname">check_volume_conservation_2d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.check_volume_conservation_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.coriolis_frequency">
<code class="sig-name descname">coriolis_frequency</code><a class="headerlink" href="#thetis.options.CommonModelOptions.coriolis_frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.element_family">
<code class="sig-name descname">element_family</code><a class="headerlink" href="#thetis.options.CommonModelOptions.element_family" title="Permalink to this definition">¶</a></dt>
<dd><p>An enum whose value must be in a given sequence.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.export_diagnostics">
<code class="sig-name descname">export_diagnostics</code><a class="headerlink" href="#thetis.options.CommonModelOptions.export_diagnostics" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.fields_to_export">
<code class="sig-name descname">fields_to_export</code><a class="headerlink" href="#thetis.options.CommonModelOptions.fields_to_export" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of a Python list.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.fields_to_export_hdf5">
<code class="sig-name descname">fields_to_export_hdf5</code><a class="headerlink" href="#thetis.options.CommonModelOptions.fields_to_export_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of a Python list.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.horizontal_diffusivity">
<code class="sig-name descname">horizontal_diffusivity</code><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.horizontal_velocity_scale">
<code class="sig-name descname">horizontal_velocity_scale</code><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_velocity_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.horizontal_viscosity">
<code class="sig-name descname">horizontal_viscosity</code><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_viscosity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.horizontal_viscosity_scale">
<code class="sig-name descname">horizontal_viscosity_scale</code><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_viscosity_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.lax_friedrichs_tracer_scaling_factor">
<code class="sig-name descname">lax_friedrichs_tracer_scaling_factor</code><a class="headerlink" href="#thetis.options.CommonModelOptions.lax_friedrichs_tracer_scaling_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.lax_friedrichs_velocity_scaling_factor">
<code class="sig-name descname">lax_friedrichs_velocity_scaling_factor</code><a class="headerlink" href="#thetis.options.CommonModelOptions.lax_friedrichs_velocity_scaling_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.linear_drag_coefficient">
<code class="sig-name descname">linear_drag_coefficient</code><a class="headerlink" href="#thetis.options.CommonModelOptions.linear_drag_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.log_output">
<code class="sig-name descname">log_output</code><a class="headerlink" href="#thetis.options.CommonModelOptions.log_output" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.manning_drag_coefficient">
<code class="sig-name descname">manning_drag_coefficient</code><a class="headerlink" href="#thetis.options.CommonModelOptions.manning_drag_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.momentum_source_2d">
<code class="sig-name descname">momentum_source_2d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.momentum_source_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Model options'</em><a class="headerlink" href="#thetis.options.CommonModelOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.no_exports">
<code class="sig-name descname">no_exports</code><a class="headerlink" href="#thetis.options.CommonModelOptions.no_exports" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.norm_smoother">
<code class="sig-name descname">norm_smoother</code><a class="headerlink" href="#thetis.options.CommonModelOptions.norm_smoother" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.output_directory">
<code class="sig-name descname">output_directory</code><a class="headerlink" href="#thetis.options.CommonModelOptions.output_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>A trait for unicode strings.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.polynomial_degree">
<code class="sig-name descname">polynomial_degree</code><a class="headerlink" href="#thetis.options.CommonModelOptions.polynomial_degree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.quadratic_drag_coefficient">
<code class="sig-name descname">quadratic_drag_coefficient</code><a class="headerlink" href="#thetis.options.CommonModelOptions.quadratic_drag_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.simulation_end_time">
<code class="sig-name descname">simulation_end_time</code><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_end_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.simulation_export_time">
<code class="sig-name descname">simulation_export_time</code><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_export_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.sipg_parameter">
<code class="sig-name descname">sipg_parameter</code><a class="headerlink" href="#thetis.options.CommonModelOptions.sipg_parameter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.sipg_parameter_tracer">
<code class="sig-name descname">sipg_parameter_tracer</code><a class="headerlink" href="#thetis.options.CommonModelOptions.sipg_parameter_tracer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.timestep">
<code class="sig-name descname">timestep</code><a class="headerlink" href="#thetis.options.CommonModelOptions.timestep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.tracer_source_2d">
<code class="sig-name descname">tracer_source_2d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.tracer_source_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_automatic_sipg_parameter">
<code class="sig-name descname">use_automatic_sipg_parameter</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_automatic_sipg_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_grad_depth_viscosity_term">
<code class="sig-name descname">use_grad_depth_viscosity_term</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_grad_depth_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_grad_div_viscosity_term">
<code class="sig-name descname">use_grad_div_viscosity_term</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_grad_div_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_lax_friedrichs_tracer">
<code class="sig-name descname">use_lax_friedrichs_tracer</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_lax_friedrichs_tracer" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_lax_friedrichs_velocity">
<code class="sig-name descname">use_lax_friedrichs_velocity</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_lax_friedrichs_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_limiter_for_tracers">
<code class="sig-name descname">use_limiter_for_tracers</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_limiter_for_tracers" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.use_nonlinear_equations">
<code class="sig-name descname">use_nonlinear_equations</code><a class="headerlink" href="#thetis.options.CommonModelOptions.use_nonlinear_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.verbose">
<code class="sig-name descname">verbose</code><a class="headerlink" href="#thetis.options.CommonModelOptions.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>An int trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.volume_source_2d">
<code class="sig-name descname">volume_source_2d</code><a class="headerlink" href="#thetis.options.CommonModelOptions.volume_source_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.CommonModelOptions.wind_stress">
<code class="sig-name descname">wind_stress</code><a class="headerlink" href="#thetis.options.CommonModelOptions.wind_stress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.CrankNicolsonTimestepperOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">CrankNicolsonTimestepperOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#CrankNicolsonTimestepperOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.CrankNicolsonTimestepperOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitTimestepperOptions2d" title="thetis.options.SemiImplicitTimestepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.SemiImplicitTimestepperOptions2d</span></code></a></p>
<p>Options for 2d Crank-Nicolson time integrator</p>
<dl class="py attribute">
<dt id="thetis.options.CrankNicolsonTimestepperOptions2d.implicitness_theta">
<code class="sig-name descname">implicitness_theta</code><a class="headerlink" href="#thetis.options.CrankNicolsonTimestepperOptions2d.implicitness_theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.EquationOfStateOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">EquationOfStateOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#EquationOfStateOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.EquationOfStateOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenHasTraits</span></code></a></p>
<p>Base class of equation of state options</p>
<dl class="py attribute">
<dt id="thetis.options.EquationOfStateOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Equation of State'</em><a class="headerlink" href="#thetis.options.EquationOfStateOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.ExplicitTimestepperOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">ExplicitTimestepperOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTimestepperOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TimeStepperOptions</span></code></a></p>
<p>Options for explicit time integrator</p>
<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions.use_automatic_timestep">
<code class="sig-name descname">use_automatic_timestep</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions.use_automatic_timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.ExplicitTimestepperOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">ExplicitTimestepperOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTimestepperOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimestepperOptions" title="thetis.options.ExplicitTimestepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.ExplicitTimestepperOptions</span></code></a></p>
<p>Options for 2d explicit time integrator</p>
<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions2d.solver_parameters">
<code class="sig-name descname">solver_parameters</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions2d.solver_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions2d.solver_parameters_tracer">
<code class="sig-name descname">solver_parameters_tracer</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions2d.solver_parameters_tracer" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.ExplicitTimestepperOptions3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">ExplicitTimestepperOptions3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTimestepperOptions3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimestepperOptions" title="thetis.options.ExplicitTimestepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.ExplicitTimestepperOptions</span></code></a></p>
<p>Base class for all 3d time stepper options</p>
<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions3d.solver_parameters_2d_swe">
<code class="sig-name descname">solver_parameters_2d_swe</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d.solver_parameters_2d_swe" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions3d.solver_parameters_momentum_explicit">
<code class="sig-name descname">solver_parameters_momentum_explicit</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d.solver_parameters_momentum_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions3d.solver_parameters_momentum_implicit">
<code class="sig-name descname">solver_parameters_momentum_implicit</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d.solver_parameters_momentum_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions3d.solver_parameters_tracer_explicit">
<code class="sig-name descname">solver_parameters_tracer_explicit</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d.solver_parameters_tracer_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ExplicitTimestepperOptions3d.solver_parameters_tracer_implicit">
<code class="sig-name descname">solver_parameters_tracer_implicit</code><a class="headerlink" href="#thetis.options.ExplicitTimestepperOptions3d.solver_parameters_tracer_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.GLSModelOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">GLSModelOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#GLSModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.GLSModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TurbulenceModelOptions" title="thetis.options.TurbulenceModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TurbulenceModelOptions</span></code></a></p>
<p>Options for Generic Length Scale turbulence model</p>
<dl class="py method">
<dt id="thetis.options.GLSModelOptions.apply_defaults">
<code class="sig-name descname">apply_defaults</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">closure_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#GLSModelOptions.apply_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.GLSModelOptions.apply_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies default parameters for given closure name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure_name</strong> (<em>string</em>) – name of the turbulence closure model</p>
</dd>
</dl>
<p>Sets default values for parameters p, m, n, schmidt_nb_tke,
schmidt_nb_psi, c1, c2, c3_plus, c3_minus,
f_wall, k_min, psi_min</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.c1">
<code class="sig-name descname">c1</code><a class="headerlink" href="#thetis.options.GLSModelOptions.c1" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.c2">
<code class="sig-name descname">c2</code><a class="headerlink" href="#thetis.options.GLSModelOptions.c2" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.c3_minus">
<code class="sig-name descname">c3_minus</code><a class="headerlink" href="#thetis.options.GLSModelOptions.c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.c3_plus">
<code class="sig-name descname">c3_plus</code><a class="headerlink" href="#thetis.options.GLSModelOptions.c3_plus" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.closure_name">
<code class="sig-name descname">closure_name</code><a class="headerlink" href="#thetis.options.GLSModelOptions.closure_name" title="Permalink to this definition">¶</a></dt>
<dd><p>An enum whose value must be in a given sequence.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.cmu0">
<code class="sig-name descname">cmu0</code><a class="headerlink" href="#thetis.options.GLSModelOptions.cmu0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_c3_minus">
<code class="sig-name descname">compute_c3_minus</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_cmu0">
<code class="sig-name descname">compute_cmu0</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_galperin_clim">
<code class="sig-name descname">compute_galperin_clim</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_galperin_clim" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_kappa">
<code class="sig-name descname">compute_kappa</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_len_min">
<code class="sig-name descname">compute_len_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_psi_min">
<code class="sig-name descname">compute_psi_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_psi_min" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.compute_schmidt_nb_psi">
<code class="sig-name descname">compute_schmidt_nb_psi</code><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_schmidt_nb_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.diff_min">
<code class="sig-name descname">diff_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.diff_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.eps_min">
<code class="sig-name descname">eps_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.eps_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.f_wall">
<code class="sig-name descname">f_wall</code><a class="headerlink" href="#thetis.options.GLSModelOptions.f_wall" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.galperin_clim">
<code class="sig-name descname">galperin_clim</code><a class="headerlink" href="#thetis.options.GLSModelOptions.galperin_clim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.k_min">
<code class="sig-name descname">k_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.k_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.kappa">
<code class="sig-name descname">kappa</code><a class="headerlink" href="#thetis.options.GLSModelOptions.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.len_min">
<code class="sig-name descname">len_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.len_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.limit_eps">
<code class="sig-name descname">limit_eps</code><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.limit_len">
<code class="sig-name descname">limit_len</code><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_len" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.limit_len_min">
<code class="sig-name descname">limit_len_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.limit_psi">
<code class="sig-name descname">limit_psi</code><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.m">
<code class="sig-name descname">m</code><a class="headerlink" href="#thetis.options.GLSModelOptions.m" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.n">
<code class="sig-name descname">n</code><a class="headerlink" href="#thetis.options.GLSModelOptions.n" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Generic Length Scale turbulence closure model'</em><a class="headerlink" href="#thetis.options.GLSModelOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.p">
<code class="sig-name descname">p</code><a class="headerlink" href="#thetis.options.GLSModelOptions.p" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.psi_min">
<code class="sig-name descname">psi_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.psi_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.ri_st">
<code class="sig-name descname">ri_st</code><a class="headerlink" href="#thetis.options.GLSModelOptions.ri_st" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.schmidt_nb_psi">
<code class="sig-name descname">schmidt_nb_psi</code><a class="headerlink" href="#thetis.options.GLSModelOptions.schmidt_nb_psi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.schmidt_nb_tke">
<code class="sig-name descname">schmidt_nb_tke</code><a class="headerlink" href="#thetis.options.GLSModelOptions.schmidt_nb_tke" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.stability_function_name">
<code class="sig-name descname">stability_function_name</code><a class="headerlink" href="#thetis.options.GLSModelOptions.stability_function_name" title="Permalink to this definition">¶</a></dt>
<dd><p>An enum whose value must be in a given sequence.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.GLSModelOptions.visc_min">
<code class="sig-name descname">visc_min</code><a class="headerlink" href="#thetis.options.GLSModelOptions.visc_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.LinearEquationOfStateOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">LinearEquationOfStateOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#LinearEquationOfStateOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.EquationOfStateOptions" title="thetis.options.EquationOfStateOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.EquationOfStateOptions</span></code></a></p>
<p>Linear equation of state options</p>
<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.alpha">
<code class="sig-name descname">alpha</code><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.beta">
<code class="sig-name descname">beta</code><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.beta" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Linear Equation of State'</em><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.rho_ref">
<code class="sig-name descname">rho_ref</code><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.rho_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.s_ref">
<code class="sig-name descname">s_ref</code><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.s_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.LinearEquationOfStateOptions.th_ref">
<code class="sig-name descname">th_ref</code><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.th_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>A float trait.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.ModelOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">ModelOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ModelOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.CommonModelOptions" title="thetis.options.CommonModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.CommonModelOptions</span></code></a></p>
<p>Options for 2D depth-averaged shallow water model</p>
<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.check_tracer_conservation">
<code class="sig-name descname">check_tracer_conservation</code><a class="headerlink" href="#thetis.options.ModelOptions2d.check_tracer_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.check_tracer_overshoot">
<code class="sig-name descname">check_tracer_overshoot</code><a class="headerlink" href="#thetis.options.ModelOptions2d.check_tracer_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.name">
<code class="sig-name descname">name</code><em class="property"> = 'Depth-averaged 2D model'</em><a class="headerlink" href="#thetis.options.ModelOptions2d.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.solve_tracer">
<code class="sig-name descname">solve_tracer</code><a class="headerlink" href="#thetis.options.ModelOptions2d.solve_tracer" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.tidal_turbine_farms">
<code class="sig-name descname">tidal_turbine_farms</code><a class="headerlink" href="#thetis.options.ModelOptions2d.tidal_turbine_farms" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of a Python dict.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.timestepper_options">
<code class="sig-name descname">timestepper_options</code><a class="headerlink" href="#thetis.options.ModelOptions2d.timestepper_options" title="Permalink to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.timestepper_type">
<code class="sig-name descname">timestepper_type</code><a class="headerlink" href="#thetis.options.ModelOptions2d.timestepper_type" title="Permalink to this definition">¶</a></dt>
<dd><p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.tracer_advective_velocity_factor">
<code class="sig-name descname">tracer_advective_velocity_factor</code><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_advective_velocity_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.tracer_only">
<code class="sig-name descname">tracer_only</code><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_only" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.use_tracer_conservative_form">
<code class="sig-name descname">use_tracer_conservative_form</code><a class="headerlink" href="#thetis.options.ModelOptions2d.use_tracer_conservative_form" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.use_wetting_and_drying">
<code class="sig-name descname">use_wetting_and_drying</code><a class="headerlink" href="#thetis.options.ModelOptions2d.use_wetting_and_drying" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions2d.wetting_and_drying_alpha">
<code class="sig-name descname">wetting_and_drying_alpha</code><a class="headerlink" href="#thetis.options.ModelOptions2d.wetting_and_drying_alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.ModelOptions3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">ModelOptions3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ModelOptions3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.CommonModelOptions" title="thetis.options.CommonModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.CommonModelOptions</span></code></a></p>
<p>Options for 3D hydrostatic model</p>
<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.bottom_roughness">
<code class="sig-name descname">bottom_roughness</code><a class="headerlink" href="#thetis.options.ModelOptions3d.bottom_roughness" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.check_salinity_conservation">
<code class="sig-name descname">check_salinity_conservation</code><a class="headerlink" href="#thetis.options.ModelOptions3d.check_salinity_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.check_salinity_overshoot">
<code class="sig-name descname">check_salinity_overshoot</code><a class="headerlink" href="#thetis.options.ModelOptions3d.check_salinity_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.check_temperature_conservation">
<code class="sig-name descname">check_temperature_conservation</code><a class="headerlink" href="#thetis.options.ModelOptions3d.check_temperature_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.check_temperature_overshoot">
<code class="sig-name descname">check_temperature_overshoot</code><a class="headerlink" href="#thetis.options.ModelOptions3d.check_temperature_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.check_volume_conservation_3d">
<code class="sig-name descname">check_volume_conservation_3d</code><a class="headerlink" href="#thetis.options.ModelOptions3d.check_volume_conservation_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.constant_salinity">
<code class="sig-name descname">constant_salinity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.constant_salinity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.constant_temperature">
<code class="sig-name descname">constant_temperature</code><a class="headerlink" href="#thetis.options.ModelOptions3d.constant_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.equation_of_state_options">
<code class="sig-name descname">equation_of_state_options</code><a class="headerlink" href="#thetis.options.ModelOptions3d.equation_of_state_options" title="Permalink to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.equation_of_state_type">
<code class="sig-name descname">equation_of_state_type</code><a class="headerlink" href="#thetis.options.ModelOptions3d.equation_of_state_type" title="Permalink to this definition">¶</a></dt>
<dd><p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.horizontal_diffusivity">
<code class="sig-name descname">horizontal_diffusivity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.horizontal_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.momentum_source_3d">
<code class="sig-name descname">momentum_source_3d</code><a class="headerlink" href="#thetis.options.ModelOptions3d.momentum_source_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.name">
<code class="sig-name descname">name</code><em class="property"> = '3D hydrostatic model'</em><a class="headerlink" href="#thetis.options.ModelOptions3d.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.salinity_source_3d">
<code class="sig-name descname">salinity_source_3d</code><a class="headerlink" href="#thetis.options.ModelOptions3d.salinity_source_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.sipg_parameter_turb">
<code class="sig-name descname">sipg_parameter_turb</code><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_parameter_turb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.sipg_parameter_vertical">
<code class="sig-name descname">sipg_parameter_vertical</code><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_parameter_vertical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.sipg_parameter_vertical_tracer">
<code class="sig-name descname">sipg_parameter_vertical_tracer</code><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_parameter_vertical_tracer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.sipg_parameter_vertical_turb">
<code class="sig-name descname">sipg_parameter_vertical_turb</code><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_parameter_vertical_turb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.smagorinsky_coefficient">
<code class="sig-name descname">smagorinsky_coefficient</code><a class="headerlink" href="#thetis.options.ModelOptions3d.smagorinsky_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.solve_salinity">
<code class="sig-name descname">solve_salinity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.solve_salinity" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.solve_temperature">
<code class="sig-name descname">solve_temperature</code><a class="headerlink" href="#thetis.options.ModelOptions3d.solve_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.temperature_source_3d">
<code class="sig-name descname">temperature_source_3d</code><a class="headerlink" href="#thetis.options.ModelOptions3d.temperature_source_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.timestep_2d">
<code class="sig-name descname">timestep_2d</code><a class="headerlink" href="#thetis.options.ModelOptions3d.timestep_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.timestepper_options">
<code class="sig-name descname">timestepper_options</code><a class="headerlink" href="#thetis.options.ModelOptions3d.timestepper_options" title="Permalink to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.timestepper_type">
<code class="sig-name descname">timestepper_type</code><a class="headerlink" href="#thetis.options.ModelOptions3d.timestepper_type" title="Permalink to this definition">¶</a></dt>
<dd><p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.turbulence_model_options">
<code class="sig-name descname">turbulence_model_options</code><a class="headerlink" href="#thetis.options.ModelOptions3d.turbulence_model_options" title="Permalink to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.turbulence_model_type">
<code class="sig-name descname">turbulence_model_type</code><a class="headerlink" href="#thetis.options.ModelOptions3d.turbulence_model_type" title="Permalink to this definition">¶</a></dt>
<dd><p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_ale_moving_mesh">
<code class="sig-name descname">use_ale_moving_mesh</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_ale_moving_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_baroclinic_formulation">
<code class="sig-name descname">use_baroclinic_formulation</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_baroclinic_formulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_bottom_friction">
<code class="sig-name descname">use_bottom_friction</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_bottom_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_implicit_vertical_diffusion">
<code class="sig-name descname">use_implicit_vertical_diffusion</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_implicit_vertical_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_limiter_for_velocity">
<code class="sig-name descname">use_limiter_for_velocity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_limiter_for_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_quadratic_density">
<code class="sig-name descname">use_quadratic_density</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_quadratic_density" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_quadratic_pressure">
<code class="sig-name descname">use_quadratic_pressure</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_quadratic_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_smagorinsky_viscosity">
<code class="sig-name descname">use_smagorinsky_viscosity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_smagorinsky_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_turbulence">
<code class="sig-name descname">use_turbulence</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_turbulence" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.use_turbulence_advection">
<code class="sig-name descname">use_turbulence_advection</code><a class="headerlink" href="#thetis.options.ModelOptions3d.use_turbulence_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.vertical_diffusivity">
<code class="sig-name descname">vertical_diffusivity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.vertical_velocity_scale">
<code class="sig-name descname">vertical_velocity_scale</code><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_velocity_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.ModelOptions3d.vertical_viscosity">
<code class="sig-name descname">vertical_viscosity</code><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_viscosity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.PacanowskiPhilanderModelOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">PacanowskiPhilanderModelOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#PacanowskiPhilanderModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TurbulenceModelOptions" title="thetis.options.TurbulenceModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TurbulenceModelOptions</span></code></a></p>
<p>Options for Pacanowski-Philander turbulence model</p>
<dl class="py attribute">
<dt id="thetis.options.PacanowskiPhilanderModelOptions.alpha">
<code class="sig-name descname">alpha</code><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PacanowskiPhilanderModelOptions.exponent">
<code class="sig-name descname">exponent</code><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.exponent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PacanowskiPhilanderModelOptions.max_viscosity">
<code class="sig-name descname">max_viscosity</code><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.max_viscosity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PacanowskiPhilanderModelOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Pacanowski-Philander turbulence closure model'</em><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">PressureProjectionTimestepperOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#PressureProjectionTimestepperOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TimeStepperOptions</span></code></a></p>
<p>Options for 2d pressure-projection time integrator</p>
<dl class="py attribute">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d.implicitness_theta">
<code class="sig-name descname">implicitness_theta</code><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d.implicitness_theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d.picard_iterations">
<code class="sig-name descname">picard_iterations</code><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d.picard_iterations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d.solver_parameters_momentum">
<code class="sig-name descname">solver_parameters_momentum</code><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d.solver_parameters_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d.solver_parameters_pressure">
<code class="sig-name descname">solver_parameters_pressure</code><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d.solver_parameters_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.PressureProjectionTimestepperOptions2d.use_semi_implicit_linearization">
<code class="sig-name descname">use_semi_implicit_linearization</code><a class="headerlink" href="#thetis.options.PressureProjectionTimestepperOptions2d.use_semi_implicit_linearization" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.SemiImplicitTimestepperOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">SemiImplicitTimestepperOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SemiImplicitTimestepperOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TimeStepperOptions</span></code></a></p>
<p>Options for 2d explicit time integrator</p>
<dl class="py attribute">
<dt id="thetis.options.SemiImplicitTimestepperOptions2d.solver_parameters">
<code class="sig-name descname">solver_parameters</code><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions2d.solver_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.SemiImplicitTimestepperOptions2d.solver_parameters_tracer">
<code class="sig-name descname">solver_parameters_tracer</code><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions2d.solver_parameters_tracer" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.options.SemiImplicitTimestepperOptions2d.use_semi_implicit_linearization">
<code class="sig-name descname">use_semi_implicit_linearization</code><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions2d.use_semi_implicit_linearization" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean (True, False) trait.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.SemiImplicitTimestepperOptions3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">SemiImplicitTimestepperOptions3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SemiImplicitTimestepperOptions3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimestepperOptions3d" title="thetis.options.ExplicitTimestepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.ExplicitTimestepperOptions3d</span></code></a></p>
<p>Class for all 3d time steppers that have a configurable semi-implicit 2D solver</p>
<dl class="py attribute">
<dt id="thetis.options.SemiImplicitTimestepperOptions3d.implicitness_theta_2d">
<code class="sig-name descname">implicitness_theta_2d</code><a class="headerlink" href="#thetis.options.SemiImplicitTimestepperOptions3d.implicitness_theta_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.SteadyStateTimestepperOptions2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">SteadyStateTimestepperOptions2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SteadyStateTimestepperOptions2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.SteadyStateTimestepperOptions2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.options.TimeStepperOptions</span></code></a></p>
<p>Options for 2d steady state solver</p>
<dl class="py attribute">
<dt id="thetis.options.SteadyStateTimestepperOptions2d.solver_parameters">
<code class="sig-name descname">solver_parameters</code><a class="headerlink" href="#thetis.options.SteadyStateTimestepperOptions2d.solver_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.TidalTurbineFarmOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">TidalTurbineFarmOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TidalTurbineFarmOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenHasTraits</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">traitlets.traitlets.TraitType</span></code></p>
<p>Tidal turbine farm options</p>
<dl class="py attribute">
<dt id="thetis.options.TidalTurbineFarmOptions.break_even_wattage">
<code class="sig-name descname">break_even_wattage</code><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.break_even_wattage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.TidalTurbineFarmOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Farm options'</em><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.TidalTurbineFarmOptions.turbine_density">
<code class="sig-name descname">turbine_density</code><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.turbine_density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.TidalTurbineFarmOptions.turbine_options">
<code class="sig-name descname">turbine_options</code><em class="property"> = &lt;thetis.options.TidalTurbineOptions object&gt;</em><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.turbine_options" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.TidalTurbineOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">TidalTurbineOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TidalTurbineOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.TidalTurbineOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenHasTraits</span></code></a></p>
<p>Tidal turbine parameters</p>
<dl class="py attribute">
<dt id="thetis.options.TidalTurbineOptions.diameter">
<code class="sig-name descname">diameter</code><a class="headerlink" href="#thetis.options.TidalTurbineOptions.diameter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.options.TidalTurbineOptions.thrust_coefficient">
<code class="sig-name descname">thrust_coefficient</code><a class="headerlink" href="#thetis.options.TidalTurbineOptions.thrust_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.TimeStepperOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">TimeStepperOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TimeStepperOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.TimeStepperOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenHasTraits</span></code></a></p>
<p>Base class for all time stepper options</p>
<dl class="py attribute">
<dt id="thetis.options.TimeStepperOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Time stepper'</em><a class="headerlink" href="#thetis.options.TimeStepperOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.options.TurbulenceModelOptions">
<em class="property">class </em><code class="sig-prename descclassname">thetis.options.</code><code class="sig-name descname">TurbulenceModelOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TurbulenceModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.TurbulenceModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.configuration.FrozenHasTraits</span></code></a></p>
<p>Abstract base class for all turbulence model options</p>
<dl class="py attribute">
<dt id="thetis.options.TurbulenceModelOptions.name">
<code class="sig-name descname">name</code><em class="property"> = 'Turbulence closure model'</em><a class="headerlink" href="#thetis.options.TurbulenceModelOptions.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.physical_constants">
<span id="thetis-physical-constants-module"></span><h2>thetis.physical_constants module<a class="headerlink" href="#module-thetis.physical_constants" title="Permalink to this headline">¶</a></h2>
<p>Default values for physical constants and parameters</p>
</div>
<div class="section" id="module-thetis.rungekutta">
<span id="thetis-rungekutta-module"></span><h2>thetis.rungekutta module<a class="headerlink" href="#module-thetis.rungekutta" title="Permalink to this headline">¶</a></h2>
<p>Implements Runge-Kutta time integration methods.</p>
<p>The abstract class <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a> defines the Runge-Kutta
coefficients, and can be used to implement generic time integrators.</p>
<dl class="py class">
<dt id="thetis.rungekutta.AbstractRKScheme">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">AbstractRKScheme</code><a class="reference internal" href="_modules/thetis/rungekutta.html#AbstractRKScheme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class for defining Runge-Kutta schemes.</p>
<p>Derived classes must define the Butcher tableau (arrays <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.a" title="thetis.rungekutta.AbstractRKScheme.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.b" title="thetis.rungekutta.AbstractRKScheme.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a>,
<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.c" title="thetis.rungekutta.AbstractRKScheme.c"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c</span></code></a>) and the CFL number (<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="thetis.rungekutta.AbstractRKScheme.cfl_coeff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cfl_coeff</span></code></a>).</p>
<p>Currently only explicit or diagonally implicit schemes are supported.</p>
<dl class="py method">
<dt id="thetis.rungekutta.AbstractRKScheme.a">
<em class="property">abstract property </em><code class="sig-name descname">a</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.a" title="Permalink to this definition">¶</a></dt>
<dd><p>Runge-Kutta matrix <span class="math notranslate nohighlight">\(a_{i,j}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.AbstractRKScheme.b">
<em class="property">abstract property </em><code class="sig-name descname">b</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.b" title="Permalink to this definition">¶</a></dt>
<dd><p>weights <span class="math notranslate nohighlight">\(b_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.AbstractRKScheme.c">
<em class="property">abstract property </em><code class="sig-name descname">c</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.c" title="Permalink to this definition">¶</a></dt>
<dd><p>nodes <span class="math notranslate nohighlight">\(c_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.AbstractRKScheme.cfl_coeff">
<em class="property">abstract property </em><code class="sig-name descname">cfl_coeff</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>CFL number of the scheme</p>
<p>Value 1.0 corresponds to Forward Euler time step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.BackwardEuler">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">BackwardEuler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.BackwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.BackwardEulerAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">BackwardEulerAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEulerAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Backward Euler method</p>
<dl class="py attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[1.0]]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.BackwardEulerUForm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">BackwardEulerUForm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEulerUForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEulerUForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.BackwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.CrankNicolsonAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">CrankNicolsonAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Crack-Nicolson scheme</p>
<dl class="py attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.0, 0.0], [0.5, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.CrankNicolsonRK">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">CrankNicolsonRK</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonRK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonRK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.CrankNicolsonAbstract" title="thetis.rungekutta.CrankNicolsonAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.CrankNicolsonAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK22">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK22</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK22Abstract" title="thetis.rungekutta.DIRK22Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK22Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK22Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK22Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>2-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\gamma &amp;   \gamma &amp;       0 \\
      1 &amp; 1-\gamma &amp; \gamma \\ \hline
        &amp;       1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma = (2 - \sqrt{2})/2\)</span>.</p>
<p>From DIRK(2,3,2) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.2928932188134524, 0], [0.7071067811865476, 0.2928932188134524]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.7071067811865476, 0.2928932188134524]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.2928932188134524, 1]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.gamma">
<code class="sig-name descname">gamma</code><em class="property"> = 0.2928932188134524</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK22UForm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK22UForm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22UForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22UForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK22Abstract" title="thetis.rungekutta.DIRK22Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK22Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK23">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK23</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK23Abstract" title="thetis.rungekutta.DIRK23Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK23Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK23Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK23Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>2-stage, 3rd order Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
  \gamma &amp;    \gamma &amp;       0 \\
1-\gamma &amp; 1-2\gamma &amp; \gamma \\ \hline
          &amp;        1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma = (3 + \sqrt{3})/6\)</span>.</p>
<p>From DIRK(2,3,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.7886751345948128, 0], [-0.5773502691896255, 0.7886751345948128]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.7886751345948128, 0.21132486540518725]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.gamma">
<code class="sig-name descname">gamma</code><em class="property"> = 0.7886751345948128</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK33">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK33</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK33Abstract" title="thetis.rungekutta.DIRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK33Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK33Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>3-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(3,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.4358665215, 0, 0], [0.28206673925000003, 0.4358665215, 0], [1.208496649153235, -0.6443631706532353, 0.4358665215]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [1.208496649153235, -0.6443631706532353, 0.4358665215]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b1">
<code class="sig-name descname">b1</code><em class="property"> = 1.208496649153235</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b2">
<code class="sig-name descname">b2</code><em class="property"> = -0.6443631706532353</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.4358665215, 0.71793326075, 1]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.gamma">
<code class="sig-name descname">gamma</code><em class="property"> = 0.4358665215</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK33UForm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK33UForm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33UForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33UForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK33Abstract" title="thetis.rungekutta.DIRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK43">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK43</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK43Abstract" title="thetis.rungekutta.DIRK43Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRK43Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRK43Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRK43Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>4-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(4,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.5, 0, 0, 0], [0.16666666666666666, 0.5, 0, 0], [-0.5, 0.5, 0.5, 0], [1.5, -1.5, 0.5, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [1.5, -1.5, 0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.5, 0.6666666666666666, 0.5, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKGeneric">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKGeneric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic implementation of Diagonally Implicit Runge Kutta schemes.</p>
<p>All derived classes must define the Butcher tableau coefficients <code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">c</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.get_final_solution">
<code class="sig-name descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_cond</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.solve_tendency">
<code class="sig-name descname">solve_tendency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.update_solution">
<code class="sig-name descname">update_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates solution to i_stage sub-stage.</p>
<p>Tendencies must have been evaluated first.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGeneric.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKGenericUForm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKGenericUForm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKGenericUForm.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGenericUForm.get_final_solution">
<code class="sig-name descname">get_final_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">additive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the final solution</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGenericUForm.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_cond</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGenericUForm.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.DIRKGenericUForm.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKLPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKLPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="thetis.rungekutta.DIRKLPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKLPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKLPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>DIRKLPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.18181818181818182, 0, 0], [0.2662337662337662, 0.18181818181818182, 0], [0.3412042502951594, 0.34710743801652894, 0.18181818181818182]]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.18181818181818182, 0.44805194805194803, 0.8701298701298701]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 4.34</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKLSPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKLSPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="thetis.rungekutta.DIRKLSPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKLSPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">DIRKLSPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>DIRKLSPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.18181818181818182, 0, 0], [0.44372294372294374, 0.18181818181818182, 0], [0.44004329004329007, 0.19090909090909092, 0.18181818181818182]]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.18181818181818182, 0.6255411255411255, 0.8127705627705628]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 4.34</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKEuler">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKEuler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ForwardEulerAbstract" title="thetis.rungekutta.ForwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ForwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKGeneric">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKGeneric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Butcher form. All terms in the equation are treated explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.get_final_solution">
<code class="sig-name descname">get_final_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">additive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code></p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal notranslate"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.solve_tendency">
<code class="sig-name descname">solve_tendency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.update_solution">
<code class="sig-name descname">update_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">additive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the solution of the i-th stage</p>
<p>Tendencies must have been evaluated first.</p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal notranslate"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGeneric.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKGenericShuOsher">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKGenericShuOsher</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Shu-Osher form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_solution</strong> – initial solution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKLPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKLPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2Abstract" title="thetis.rungekutta.ERKLPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKLPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKLPUM2Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKLPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>ERKLPUM2, 3-stage, 2nd order
Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0, 0, 0], [0.5, 0, 0], [0.5, 0.5, 0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0, 0.5, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 2.0</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKLSPUM2">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKLSPUM2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="thetis.rungekutta.ERKLSPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKLSPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKLSPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>ERKLSPUM2, 3-stage, 2nd order Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0, 0, 0], [0.8333333333333334, 0, 0], [0.4583333333333333, 0.4583333333333333, 0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0, 0.8333333333333334, 0.9166666666666666]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.2</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKMidpoint">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKMidpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKMidpointAbstract" title="thetis.rungekutta.ERKMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ERKMidpointAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ERKMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.0, 0.0], [0.5, 0.0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ESDIRKMidpoint">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ESDIRKMidpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="thetis.rungekutta.ESDIRKMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ESDIRKMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ESDIRKMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.0, 0.0], [0.0, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ESDIRKTrapezoid">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ESDIRKTrapezoid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKTrapezoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract" title="thetis.rungekutta.ESDIRKTrapezoidAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ESDIRKTrapezoidAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ESDIRKTrapezoidAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ESDIRKTrapezoidAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKTrapezoidAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKTrapezoidAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.0, 0.0], [0.5, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKTrapezoidAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKTrapezoidAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ESDIRKTrapezoidAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ForwardEulerAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ForwardEulerAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ForwardEulerAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Forward Euler method</p>
<dl class="py attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0]]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ImplicitMidpoint">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ImplicitMidpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="thetis.rungekutta.ImplicitMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ImplicitMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">ImplicitMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Implicit midpoint method, second order.</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|c}
0.5 &amp; 0.5 \\ \hline
    &amp; 1.0
\end{array}\end{split}\]</div>
<dl class="py attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0.5]]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.b">
<code class="sig-name descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0.5]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">RungeKuttaTimeIntegrator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Abstract base class for all Runge-Kutta time integrators</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution">
<em class="property">abstract </em><code class="sig-name descname">get_final_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">additive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the final solution</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage">
<em class="property">abstract </em><code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.SSPRK33">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">SSPRK33</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericShuOsher" title="thetis.rungekutta.ERKGenericShuOsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.ERKGenericShuOsher</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.SSPRK33Abstract" title="thetis.rungekutta.SSPRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.SSPRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.rungekutta.SSPRK33Abstract">
<em class="property">class </em><code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">SSPRK33Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).</p>
<p>This scheme has Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|ccc}
    0 &amp;                 \\
    1 &amp; 1               \\
  1/2 &amp; 1/4 &amp; 1/4 &amp;     \\ \hline
      &amp; 1/6 &amp; 1/6 &amp; 2/3
\end{array}\end{split}\]</div>
<p>CFL coefficient is 1.0</p>
<dl class="py attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.a">
<code class="sig-name descname">a</code><em class="property"> = [[0, 0, 0], [1.0, 0, 0], [0.25, 0.25, 0]]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.b">
<code class="sig-name descname">b</code><em class="property"> = [0.16666666666666666, 0.16666666666666666, 0.6666666666666666]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.c">
<code class="sig-name descname">c</code><em class="property"> = [0, 1.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.rungekutta.butcher_to_shuosher_form">
<code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">butcher_to_shuosher_form</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#butcher_to_shuosher_form"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.butcher_to_shuosher_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts Butcher tableau to Shu-Osher form.</p>
<p>The Shu-Osher form of a s-stage scheme is defined by two s+1 by s+1 arrays
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{0} &amp;= u^n \\
u^{(i)} &amp;= \sum_{j=0}^s \alpha_{i,j} u^{(j)} + \sum_{j=0}^s \beta_{i,j} F(u^{(j)}) \\
u^{n+1} &amp;= u^{(s)}\end{split}\]</div>
<p>The Shu-Osher form is not unique. Here we construct the form where beta
values are the diagonal entries (for DIRK schemes) or sub-diagonal entries
(for explicit schemes) of the concatenated Butcher tableau [<span class="math notranslate nohighlight">\(a\)</span>; <span class="math notranslate nohighlight">\(b\)</span>].</p>
<p>For more information see Ketchelson et al. (2009) <a class="reference external" href="http://dx.doi.org/10.1016/j.apnum.2008.03.034">http://dx.doi.org/10.1016/j.apnum.2008.03.034</a></p>
</dd></dl>

<dl class="py function">
<dt id="thetis.rungekutta.timed_region">
<code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.rungekutta.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.rungekutta.timed_stage">
<code class="sig-prename descclassname">thetis.rungekutta.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.rungekutta.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.shallowwater_eq">
<span id="thetis-shallowwater-eq-module"></span><h2>thetis.shallowwater_eq module<a class="headerlink" href="#module-thetis.shallowwater_eq" title="Permalink to this headline">¶</a></h2>
<p>Depth averaged shallow water equations</p>
<div class="section" id="equations">
<h3>Equations<a class="headerlink" href="#equations" title="Permalink to this headline">¶</a></h3>
<p>The state variables are water elevation, <span class="math notranslate nohighlight">\(\eta\)</span>, and depth averaged
velocity <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span>.</p>
<p>Denoting the total water depth by <span class="math notranslate nohighlight">\(H=\eta + h\)</span>, the non-conservative form of
the free surface equation is</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf">
<span class="eqno">(6)<a class="headerlink" href="#equation-swe-freesurf" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<p>The non-conservative momentum equation reads</p>
<div class="math notranslate nohighlight" id="equation-swe-momentum">
<span class="eqno">(7)<a class="headerlink" href="#equation-swe-momentum" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta +
\nabla \left(\frac{p_a}{\rho_0} \right) +
g \frac{1}{H}\int_{-h}^\eta \nabla r dz
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ),\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration, <span class="math notranslate nohighlight">\(f\)</span> is the Coriolis
frequency, <span class="math notranslate nohighlight">\(\wedge\)</span> is the cross product, <span class="math notranslate nohighlight">\(\textbf{e}_z\)</span> is a vertical unit vector,
<span class="math notranslate nohighlight">\(p_a\)</span> is the atmospheric pressure at the free surface, and <span class="math notranslate nohighlight">\(\nu_h\)</span>
is viscosity. Water density is given by <span class="math notranslate nohighlight">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math notranslate nohighlight">\(\rho_0\)</span> is a constant reference density.</p>
<p>Above <span class="math notranslate nohighlight">\(r\)</span> denotes the baroclinic head</p>
<div class="math notranslate nohighlight">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>In the case of purely barotropic problems the <span class="math notranslate nohighlight">\(r\)</span> and the internal pressure
gradient are omitted.</p>
<p>If the option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_nonlinear_equations</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, we solve the linear shallow water
equations (i.e. wave equation):</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-linear">
<span class="eqno">(8)<a class="headerlink" href="#equation-swe-freesurf-linear" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (h \bar{\textbf{u}}) = 0\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-linear">
<span class="eqno">(9)<a class="headerlink" href="#equation-swe-momentum-linear" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ).\]</div>
<p>In case of a 3D problem with mode splitting, we use a simplified 2D
system that contains nothing but the rotational external gravity waves:</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-modesplit">
<span class="eqno">(10)<a class="headerlink" href="#equation-swe-freesurf-modesplit" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-modesplit">
<span class="eqno">(11)<a class="headerlink" href="#equation-swe-momentum-modesplit" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta
= \textbf{G},\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{G}\)</span> is a source term used to couple the 2D and 3D momentum
equations.</p>
</div>
<div class="section" id="boundary-conditions">
<h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>All boundary conditions are imposed weakly by providing external values for
<span class="math notranslate nohighlight">\(\eta\)</span> and <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span>.</p>
<p>Boundary conditions are set with a dictionary that defines all prescribed
variables at each open boundary.
For example, to assign elevation and volume flux on boundary <code class="docutils literal notranslate"><span class="pre">1</span></code> we set</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">swe_bnd_funcs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">swe_bnd_funcs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev&#39;</span><span class="p">:</span><span class="n">myfunc1</span><span class="p">,</span> <span class="s1">&#39;flux&#39;</span><span class="p">:</span><span class="n">myfunc2</span><span class="p">}</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">myfunc1</span></code> and <code class="docutils literal notranslate"><span class="pre">myfunc2</span></code> are <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>
objects.</p>
<p>The user can provide <span class="math notranslate nohighlight">\(\eta\)</span> and/or <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span> values.
Supported combinations are:</p>
<ul class="simple">
<li><p><em>unspecified</em> : impermeable (land) boundary, implies symmetric <span class="math notranslate nohighlight">\(\eta\)</span> condition and zero normal velocity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code>: elevation only, symmetric velocity (usually unstable)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'uv'</span></code>: 2d velocity vector <span class="math notranslate nohighlight">\(\bar{\textbf{u}}=(u, v)\)</span> (in mesh coordinates), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'un'</span></code>: normal velocity (scalar, positive out of domain), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flux'</span></code>: normal volume flux (scalar, positive out of domain), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'uv'</span></code>: water elevation and 2d velocity vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'un'</span></code>: water elevation and normal velocity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'flux'</span></code>: water elevation and normal flux</p></li>
</ul>
<p>The boundary conditions are assigned to the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> or
<a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">bnd_functions</span><span class="p">[</span><span class="s1">&#39;shallow_water&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">swe_bnd_funcs</span>
</pre></div>
</div>
<p>Internally the boundary conditions passed to the <a class="reference internal" href="#thetis.equation.Term.residual" title="thetis.equation.Term.residual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Term.residual()</span></code></a> method
of each term:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adv_term</span> <span class="o">=</span> <span class="n">shallowwater_eq</span><span class="o">.</span><span class="n">HorizontalAdvectionTerm</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">adv_form</span> <span class="o">=</span> <span class="n">adv_term</span><span class="o">.</span><span class="n">residual</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bnd_conditions</span><span class="o">=</span><span class="n">swe_bnd_funcs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="wetting-and-drying">
<h3>Wetting and drying<a class="headerlink" href="#wetting-and-drying" title="Permalink to this headline">¶</a></h3>
<p>If the option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_wetting_and_drying</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then wetting and
drying is included through the formulation of Karna et al. (2011).</p>
<p>The method introduces a modified bathymetry <span class="math notranslate nohighlight">\(\tilde{h} = h + f(H)\)</span>, which ensures
positive total water depth, with <span class="math notranslate nohighlight">\(f(H)\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[f(H) = \frac{1}{2}(\sqrt{H^2 + \alpha^2} - H),\]</div>
<p>introducing a wetting-drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>, with dimensions of length. This
results in a modified total water depth <span class="math notranslate nohighlight">\(\tilde{H}=H+f(H)\)</span>.</p>
<p>The value for <span class="math notranslate nohighlight">\(\alpha\)</span> is specified by the user through the
option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code>, in units of meters. The default value
for <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code> is 0.5, but the appropriate value is problem
specific and should be set by the user.</p>
<p>An approximate method for selecting a suitable value for <span class="math notranslate nohighlight">\(\alpha\)</span> is suggested
by Karna et al. (2011). Defining <span class="math notranslate nohighlight">\(L_x\)</span> as the horizontal length scale of the
mesh elements at the wet-dry front, it can be reasoned that <span class="math notranslate nohighlight">\(\alpha \approx |L_x
\nabla h|\)</span> yields a suitable choice. Smaller <span class="math notranslate nohighlight">\(\alpha\)</span> leads to a more accurate
solution to the shallow water equations in wet regions, but if <span class="math notranslate nohighlight">\(\alpha\)</span> is too
small the simulation will become unstable.</p>
<p>When wetting and drying is turned on, two things occur:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All instances of the height, <span class="math notranslate nohighlight">\(H\)</span>, are replaced by <span class="math notranslate nohighlight">\(\tilde{H}\)</span> (as defined above);</p></li>
<li><p>An additional displacement term <span class="math notranslate nohighlight">\(\frac{\partial \tilde{h}}{\partial t}\)</span> is added to the bathymetry in the free surface equation.</p></li>
</ol>
</div></blockquote>
<p>The free surface and momentum equations then become:</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-wd">
<span class="eqno">(12)<a class="headerlink" href="#equation-swe-freesurf-wd" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \frac{\partial \tilde{h}}{\partial t} + \nabla \cdot (\tilde{H} \bar{\textbf{u}}) = 0,\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-wd">
<span class="eqno">(13)<a class="headerlink" href="#equation-swe-momentum-wd" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta +
g \frac{1}{\tilde{H}}\int_{-h}^\eta \nabla r dz
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(\tilde{H})}{\tilde{H}} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ).\]</div>
<dl class="py class">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">BaseShallowWaterEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Abstract base class for ShallowWaterEquations, ShallowWaterMomentumEquation
and FreeSurfaceEquation.</p>
<p>Provides common functionality to compute time steps and add either momentum
or continuity terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms">
<code class="sig-name descname">add_continuity_terms</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_continuity_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms">
<code class="sig-name descname">add_momentum_terms</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_momentum_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta">
<code class="sig-name descname">residual_uv_eta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.residual_uv_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ShallowWaterEquations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations in non-conservative form.</p>
<p>This defines the full 2D SWE equations <a class="reference internal" href="#equation-swe-freesurf">(6)</a> -
<a class="reference internal" href="#equation-swe-momentum">(7)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations.mass_term">
<code class="sig-name descname">mass_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.mass_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.mass_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ModeSplit2DEquations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations for mode splitting schemes.</p>
<p>Defines the equations <a class="reference internal" href="#equation-swe-freesurf-modesplit">(10)</a> -
<a class="reference internal" href="#equation-swe-momentum-modesplit">(11)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms">
<code class="sig-name descname">add_momentum_terms</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.add_momentum_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ShallowWaterMomentumEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth averaged momentum equation <a class="reference internal" href="#equation-swe-momentum">(7)</a> in non-conservative
form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_test</strong> – test function of the velocity function space</p></li>
<li><p><strong>u_space</strong> – velocity function space</p></li>
<li><p><strong>eta_space</strong> – elevation function space</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">FreeSurfaceEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta_test</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D free surface equation <a class="reference internal" href="#equation-swe-freesurf">(6)</a> in non-conservative form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta_test</strong> – test function of the elevation function space</p></li>
<li><p><strong>eta_space</strong> – elevation function space</p></li>
<li><p><strong>u_space</strong> – velocity function space</p></li>
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation.mass_term">
<code class="sig-name descname">mass_term</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.mass_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.mass_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ShallowWaterTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term in the shallow water equations that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions">
<code class="sig-name descname">get_bnd_functions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta_in</span></em>, <em class="sig-param"><span class="n">uv_in</span></em>, <em class="sig-param"><span class="n">bnd_id</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of elev and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ShallowWaterMomentumTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the shallow water momentum equation that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ShallowWaterContinuityTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ShallowWaterContinuityTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta_test</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterContinuityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the depth-integrated continuity equation that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.HUDivTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">HUDivTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta_test</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Divergence term, <span class="math notranslate nohighlight">\(\nabla \cdot (H \bar{\textbf{u}})\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla \cdot (H \bar{\textbf{u}}) \phi dx
= \int_\Gamma (H^* \bar{\textbf{u}}^*) \cdot \text{jump}(\phi \textbf{n}) dS
- \int_\Omega H (\bar{\textbf{u}}\cdot\nabla \phi) dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span>
and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the jump and average operators across the
interface. <span class="math notranslate nohighlight">\(H^*, \bar{\textbf{u}}^*\)</span> are values at the interface
obtained from an approximate Riemann solver.</p>
<p>If <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span> belongs to a discontinuous function space,
the form on the right hand side is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.HUDivTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ContinuitySourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta_test</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Generic source term in the depth-averaged continuity equation</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega S \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Advection of momentum term, <span class="math notranslate nohighlight">\(\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}}\)</span></p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot \bar{\textbf{u}} dx
+ \int_\Gamma \text{avg}(\bar{\textbf{u}}) \cdot \text{jump}(\boldsymbol{\psi}
(\bar{\textbf{u}}\cdot\textbf{n})) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Viscosity of momentum term</p>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_div_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we
use the symmetric viscous stress <span class="math notranslate nohighlight">\(\boldsymbol{\tau}_\nu = \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\)</span>.
Using the symmetric interior penalty method the weak form then reads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_div_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>,
we use viscous stress <span class="math notranslate nohighlight">\(\boldsymbol{\tau}_\nu = \nu_h \nabla \bar{\textbf{u}}\)</span>.
In this case the weak form is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_depth_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we also include
the term</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\tau}_{\nabla H} = - \frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\]</div>
<p>as a source term.</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">ExternalPressureGradientTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>External pressure gradient term, <span class="math notranslate nohighlight">\(g \nabla \eta\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g \nabla \eta \cdot \boldsymbol{\psi} dx
= \int_\Gamma g \eta^* \text{jump}(\boldsymbol{\psi} \cdot \textbf{n}) dS
- \int_\Omega g \eta \nabla \cdot \boldsymbol{\psi} dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, <span class="math notranslate nohighlight">\(n^*\)</span> is value at
the interface obtained from an approximate Riemann solver.</p>
<p>If <span class="math notranslate nohighlight">\(\eta\)</span> belongs to a discontinuous function space, the form on the
right hand side is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.CoriolisTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">CoriolisTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math notranslate nohighlight">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.CoriolisTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.LinearDragTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">LinearDragTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Linear friction term, <span class="math notranslate nohighlight">\(C \bar{\textbf{u}}\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(C\)</span> is a user-defined drag coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.LinearDragTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">QuadraticDragTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Quadratic Manning bottom friction term
<span class="math notranslate nohighlight">\(C_D \| \bar{\textbf{u}} \| \bar{\textbf{u}}\)</span></p>
<p>where the drag term is computed with the Manning formula</p>
<div class="math notranslate nohighlight">
\[C_D = g \frac{\mu^2}{H^{1/3}}\]</div>
<p>if the Manning coefficient <span class="math notranslate nohighlight">\(\mu\)</span> is defined (see field <code class="xref py py-attr docutils literal notranslate"><span class="pre">manning_drag_coefficient</span></code>).
Otherwise <span class="math notranslate nohighlight">\(C_D\)</span> is taken as a constant (see field <code class="xref py py-attr docutils literal notranslate"><span class="pre">quadratic_drag_coefficient</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">BottomDrag3DTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Bottom drag term consistent with the 3D mode,
<span class="math notranslate nohighlight">\(C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(\textbf{u}_b\)</span> is the bottom velocity used in the 3D mode, and
<span class="math notranslate nohighlight">\(C_D\)</span> the corresponding bottom drag.
These fields are computed in the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">MomentumSourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Generic source term in the shallow water momentum equation</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \boldsymbol{\tau} \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\tau}\)</span> is a user defined vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.WindStressTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">WindStressTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Wind stress term, <span class="math notranslate nohighlight">\(-\tau_w/(H \rho_0)\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.WindStressTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.shallowwater_eq.AtmosphericPressureTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.shallowwater_eq.</code><code class="sig-name descname">AtmosphericPressureTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_test</span></em>, <em class="sig-param"><span class="n">u_space</span></em>, <em class="sig-param"><span class="n">eta_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#AtmosphericPressureTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.AtmosphericPressureTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Atmospheric pressure term, <span class="math notranslate nohighlight">\(\nabla (p_a / \rho_0)\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(p_a\)</span> is a user-defined atmospheric pressure <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.shallowwater_eq.AtmosphericPressureTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">uv_old</span></em>, <em class="sig-param"><span class="n">eta_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#AtmosphericPressureTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.AtmosphericPressureTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-thetis.solver">
<span id="thetis-solver-module"></span><h2>thetis.solver module<a class="headerlink" href="#module-thetis.solver" title="Permalink to this headline">¶</a></h2>
<p>Module for three dimensional baroclinic solver</p>
<dl class="py class">
<dt id="thetis.solver.FlowSolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.solver.</code><code class="sig-name descname">FlowSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh2d</span></em>, <em class="sig-param"><span class="n">bathymetry_2d</span></em>, <em class="sig-param"><span class="n">n_layers</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extrude_options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Main object for 3D solver</p>
<p><strong>Example</strong></p>
<p>Create 2D mesh</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thetis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a 3D model with 6 uniform levels, and set some options
(see <a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">polynomial_degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;SSPRK22&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_options</span><span class="o">.</span><span class="n">use_automatic_timestep</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_salinity</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_temperature</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_export_time</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_end_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>bathymetry_2d</strong> (2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</p></li>
<li><p><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of layers in the vertical direction.
Elements are distributed uniformly over the vertical.</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a> instance) – Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver.FlowSolver.options" title="thetis.solver.FlowSolver.options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">options</span></code></a> class property.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.M_modesplit">
<code class="sig-name descname">M_modesplit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.M_modesplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Mode split ratio (int)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.add_callback">
<code class="sig-name descname">add_callback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callback</span></em>, <em class="sig-param"><span class="n">eval_interval</span><span class="o">=</span><span class="default_value">'export'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> instance</p></li>
<li><p><strong>eval_interval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Determines when callback will be evaluated,
either ‘export’ or ‘timestep’ for evaluating after each export or
time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.assign_initial_conditions">
<code class="sig-name descname">assign_initial_conditions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elev</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">salt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">temp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uv_2d</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uv_3d</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tke</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">psi</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (scalar 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for water elevation</p></li>
<li><p><strong>salt</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for salinity field</p></li>
<li><p><strong>temp</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for temperature field</p></li>
<li><p><strong>uv_2d</strong> (vector valued 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for depth averaged velocity</p></li>
<li><p><strong>uv_3d</strong> (vector valued 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for horizontal velocity</p></li>
<li><p><strong>tke</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for turbulent kinetic energy field</p></li>
<li><p><strong>psi</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for turbulence generic length scale field</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.callbacks">
<code class="sig-name descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dt_2d">
<code class="sig-name descname">compute_dt_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math notranslate nohighlight">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum advective velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dt_diffusion">
<code class="sig-name descname">compute_dt_diffusion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nu_scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_diffusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal diffusion.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \alpha \frac{(\Delta x)^2}{\nu_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{scale}\)</span> is estimated diffusivity scale.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dt_h_advection">
<code class="sig-name descname">compute_dt_h_advection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_h_advection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_h_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal advection</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated horizontal advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum horizontal velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dt_v_advection">
<code class="sig-name descname">compute_dt_v_advection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w_scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_v_advection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_v_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for vertical advection</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta z}{W_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(W_{scale}\)</span> is estimated vertical advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>w_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum vertical velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dx_factor">
<code class="sig-name descname">compute_dx_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dx_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dx_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes normalized distance between nodes in the horizontal direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_dz_factor">
<code class="sig-name descname">compute_dz_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dz_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dz_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a normalized distance between nodes in the vertical direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.compute_mesh_stats">
<code class="sig-name descname">compute_mesh_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_mesh_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_mesh_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes number of elements, nodes etc and prints to sdtout</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.create_equations">
<code class="sig-name descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates all dynamic equations and time integrators</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.create_fields">
<code class="sig-name descname">create_fields</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates all fields</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.create_function_spaces">
<code class="sig-name descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver.FlowSolver.function_spaces" title="thetis.solver.FlowSolver.function_spaces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.dt">
<code class="sig-name descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.dt_2d">
<code class="sig-name descname">dt_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Time of the 2D solver</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to ‘export’ interval.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.export_initial_state">
<code class="sig-name descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.fields">
<code class="sig-name descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.fields" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.function_spaces">
<code class="sig-name descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.iterate">
<code class="sig-name descname">iterate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">update_forcings3d</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Iterates over the time loop until time <code class="docutils literal notranslate"><span class="pre">options.simulation_end_time</span></code> is reached.
Exports fields to disk on <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code> intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_forcings</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 2D system (if any).</p></li>
<li><p><strong>update_forcings_3d</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 3D equations (if any).</p></li>
<li><p><strong>export_func</strong> – User-defined function (with no arguments) that will
be called on every export.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.load_state">
<code class="sig-name descname">load_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_export</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iteration</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces <a class="reference internal" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="thetis.solver.FlowSolver.assign_initial_conditions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_initial_conditions()</span></code></a> in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format.  The required
state variables are: elev_2d, uv_2d, uv_3d, salt_3d, temp_3d, tke_3d,
psi_3d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index to load</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – (optional) directory where files are read from.
By default <code class="docutils literal notranslate"><span class="pre">options.output_directory</span></code>.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time. Overrides the time stamp stored in the
hdf5 files.</p></li>
<li><p><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Overrides the iteration count in the hdf5 files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.mesh">
<code class="sig-name descname">mesh</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>3D :class`Mesh`</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.mesh2d">
<code class="sig-name descname">mesh2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.mesh2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D :class`Mesh`</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver.FlowSolver.options">
<code class="sig-name descname">options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.print_state">
<code class="sig-name descname">print_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cputime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Measured CPU time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.print_state_debug">
<code class="sig-name descname">print_state_debug</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state_debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state_debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Print min/max values of prognostic/diagnostic fields for debugging.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.set_sipg_parameter">
<code class="sig-name descname">set_sipg_parameter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.set_sipg_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.set_sipg_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a penalty parameter which ensures stability of the Interior Penalty method
used for viscosity and diffusivity terms, from Epshteyn et al. 2007
(<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a>).</p>
<p>The scheme is stable if</p>
<dl class="simple">
<dt>..math::</dt><dd><p>alpha|_K &gt; 3*X*p*(p+1)*cot(theta_K),</p>
</dd>
</dl>
<p>for all elements <span class="math notranslate nohighlight">\(K\)</span>, where</p>
<dl class="simple">
<dt>..math::</dt><dd><p>X = frac{max_{xin K}(nu(x))}{min_{xin K}(nu(x))},</p>
</dd>
</dl>
<p><span class="math notranslate nohighlight">\(p\)</span> the degree, and <span class="math notranslate nohighlight">\(\theta_K\)</span> is the minimum angle in the element.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver.FlowSolver.set_time_step">
<code class="sig-name descname">set_time_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>If the time integrator supports automatic time step, and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions3d.timestepper_options.use_automatic_timestep</span></code> is
<cite>True</cite>, we compute the maximum time step allowed by the CFL condition.
Otherwise uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions3d.timestep</span></code>.</p>
<p>Once the time step is determined, will adjust it to be an integer
fraction of export interval <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.solver.timed_region">
<code class="sig-prename descclassname">thetis.solver.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.solver.timed_stage">
<code class="sig-prename descclassname">thetis.solver.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.solver2d">
<span id="thetis-solver2d-module"></span><h2>thetis.solver2d module<a class="headerlink" href="#module-thetis.solver2d" title="Permalink to this headline">¶</a></h2>
<p>Module for 2D depth averaged solver</p>
<dl class="py class">
<dt id="thetis.solver2d.FlowSolver2d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.solver2d.</code><code class="sig-name descname">FlowSolver2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh2d</span></em>, <em class="sig-param"><span class="n">bathymetry_2d</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Main object for 2D depth averaged solver</p>
<p><strong>Example</strong></p>
<p>Create mesh</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thetis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create solver object and set some options</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">polynomial_degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;CrankNicolson&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_export_time</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_end_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>bathymetry_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions2d" title="thetis.options.ModelOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code></a> instance) – Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.options" title="thetis.solver2d.FlowSolver2d.options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">options</span></code></a> class property.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.add_callback">
<code class="sig-name descname">add_callback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callback</span></em>, <em class="sig-param"><span class="n">eval_interval</span><span class="o">=</span><span class="default_value">'export'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> instance</p></li>
<li><p><strong>eval_interval</strong> (<em>string</em>) – Determines when callback will be evaluated,
either ‘export’ or ‘timestep’ for evaluating after each export or
time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.assign_initial_conditions">
<code class="sig-name descname">assign_initial_conditions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elev</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tracer</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for water elevation</p></li>
<li><p><strong>uv</strong> (vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for depth averaged velocity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.callbacks">
<code class="sig-name descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.compute_time_step">
<code class="sig-name descname">compute_time_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_scale</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 37)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.compute_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.compute_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math notranslate nohighlight">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum advective velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.create_equations">
<code class="sig-name descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates shallow water equations</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.create_exporters">
<code class="sig-name descname">create_exporters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_exporters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_exporters" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates file exporters</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.create_function_spaces">
<code class="sig-name descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="thetis.solver2d.FlowSolver2d.function_spaces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.create_timestepper">
<code class="sig-name descname">create_timestepper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_timestepper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_timestepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates time stepper instance</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.dt">
<code class="sig-name descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to ‘export’ interval.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.export_initial_state">
<code class="sig-name descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.fields">
<code class="sig-name descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.fields" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.function_spaces">
<code class="sig-name descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.get_swe_timestepper">
<code class="sig-name descname">get_swe_timestepper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">integrator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_swe_timestepper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_swe_timestepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets shallow water timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.get_tracer_timestepper">
<code class="sig-name descname">get_tracer_timestepper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">integrator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_tracer_timestepper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_tracer_timestepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets tracer timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces, equations, time stepper and exporters</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.iterate">
<code class="sig-name descname">iterate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">export_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Iterates over the time loop until time <code class="docutils literal notranslate"><span class="pre">options.simulation_end_time</span></code> is reached.
Exports fields to disk on <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code> intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_forcings</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
(if any).</p></li>
<li><p><strong>export_func</strong> – User-defined function (with no arguments) that will
be called on every export.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.load_state">
<code class="sig-name descname">load_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_export</span></em>, <em class="sig-param"><span class="n">outputdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iteration</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="thetis.solver2d.FlowSolver2d.assign_initial_conditions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_initial_conditions()</span></code></a> in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format. The required
state variables are: elev_2d, uv_2d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index to load</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – (optional) directory where files are read from.
By default <code class="docutils literal notranslate"><span class="pre">options.output_directory</span></code>.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time. Overrides the time stamp stored in the
hdf5 files.</p></li>
<li><p><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Overrides the iteration count in the hdf5 files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.solver2d.FlowSolver2d.options">
<code class="sig-name descname">options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions2d" title="thetis.options.ModelOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.print_state">
<code class="sig-name descname">print_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cputime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.print_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Measured CPU time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.set_sipg_parameter">
<code class="sig-name descname">set_sipg_parameter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_sipg_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_sipg_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a penalty parameter which ensures stability of the Interior Penalty method
used for viscosity and diffusivity terms, from Epshteyn et al. 2007
(<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a>).</p>
<p>The scheme is stable if</p>
<dl class="simple">
<dt>..math::</dt><dd><p>alpha|_K &gt; 3*X*p*(p+1)*cot(theta_K),</p>
</dd>
</dl>
<p>for all elements <span class="math notranslate nohighlight">\(K\)</span>, where</p>
<dl class="simple">
<dt>..math::</dt><dd><p>X = frac{max_{xin K}(nu(x))}{min_{xin K}(nu(x))},</p>
</dd>
</dl>
<p><span class="math notranslate nohighlight">\(p\)</span> the degree, and <span class="math notranslate nohighlight">\(\theta_K\)</span> is the minimum angle in the element.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.solver2d.FlowSolver2d.set_time_step">
<code class="sig-name descname">set_time_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.05</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>If the time integrator supports automatic time step, and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.timestepper_options.use_automatic_timestep</span></code> is
<cite>True</cite>, we compute the maximum time step allowed by the CFL condition.
Otherwise uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.timestep</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – CFL number scaling factor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.solver2d.timed_region">
<code class="sig-prename descclassname">thetis.solver2d.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.solver2d.timed_stage">
<code class="sig-prename descclassname">thetis.solver2d.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.stability_functions">
<span id="thetis-stability-functions-module"></span><h2>thetis.stability_functions module<a class="headerlink" href="#module-thetis.stability_functions" title="Permalink to this headline">¶</a></h2>
<p>Implements turbulence closure model stability functions.</p>
<div class="math notranslate nohighlight">
\[\begin{split}S_m &amp;= S_m(\alpha_M, \alpha_N) \\
S_\rho &amp;= S_\rho(\alpha_M, \alpha_N)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_M, \alpha_N\)</span> are the normalized shear and buoyancy frequency</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
</div></blockquote>
<p>The following stability functions have been implemented</p>
<ul class="simple">
<li><p>Canuto A</p></li>
<li><p>Canuto B</p></li>
<li><p>Kantha-Clayson</p></li>
<li><p>Cheng</p></li>
</ul>
<p>References:</p>
<p>Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models
for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795–827. <a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></p>
<p>Burchard, H. and Bolding, K. (2001). Comparative Analysis of Four
Second-Moment Turbulence Closure Models for the Oceanic Mixed Layer. Journal of
Physical Oceanography, 31(8):1943–1968.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></p>
<p>Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for
geophysical turbulence models. Journal of Marine Research, 61:235–265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></p>
<dl class="py class">
<dt id="thetis.stability_functions.StabilityFunctionBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">StabilityFunctionBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all stability functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_alpha_shear_steady">
<code class="sig-name descname">compute_alpha_shear_steady</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ri_st</span></em>, <em class="sig-param"><span class="n">analytical</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_alpha_shear_steady"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_alpha_shear_steady" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the steady-state <span class="math notranslate nohighlight">\(\alpha_M\)</span>.</p>
<p>Under steady-state conditions, the stability functions satisfy:</p>
<div class="math notranslate nohighlight">
\[S_m \alpha_M - S_\rho \alpha_M Ri_{st} = 1.0\]</div>
<p>(Umlauf and Buchard, 2005, eq A.15) from which <span class="math notranslate nohighlight">\(\alpha_M\)</span> can be
solved for given gradient Richardson number <span class="math notranslate nohighlight">\(Ri_{st}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ri_st</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Gradient Richardson number</p></li>
<li><p><strong>analytical</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True (default), solve analytically using the
coefficients of the stability function. Otherwise, solve
<span class="math notranslate nohighlight">\(\alpha_M\)</span> numerically from the equilibrium condition.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_c3_minus">
<code class="sig-name descname">compute_c3_minus</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c1</span></em>, <em class="sig-param"><span class="n">c2</span></em>, <em class="sig-param"><span class="n">ri_st</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_c3_minus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute c3_minus parameter from c1 and c2 parameters.</p>
<p>c3_minus is solved from equation</p>
<div class="math notranslate nohighlight">
\[Ri_{st} = \frac{s_m}{s_h} \frac{c2 - c1}{c2 - c3_{-}}\]</div>
<p>where <span class="math notranslate nohighlight">\(Ri_{st}\)</span> is the steady state gradient Richardson number.
(see Burchard and Bolding, 2001, eq 32)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_cmu0">
<code class="sig-name descname">compute_cmu0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analytical</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_cmu0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute parameter <span class="math notranslate nohighlight">\(c_\mu^0\)</span></p>
<p>See: Umlauf and Buchard (2005) eq A.22</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>analytical</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True (default), solve analytically using the
coefficients of the stability function. Otherwise, solve
<span class="math notranslate nohighlight">\(\alpha_M\)</span> numerically from the equilibrium condition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_kappa">
<code class="sig-name descname">compute_kappa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma_psi</span></em>, <em class="sig-param"><span class="n">cmu0</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">c1</span></em>, <em class="sig-param"><span class="n">c2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_kappa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes von Karman constant from the Psi Schmidt number.</p>
<p>See: Umlauf and Burchard (2003) eq (14)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_psi</strong> – Psi Schmidt number</p></li>
<li><p><strong>n</strong><strong>, </strong><strong>c1</strong><strong>, </strong><strong>c2</strong> (<em>cmu0</em><em>,</em>) – GLS model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_length_clim">
<code class="sig-name descname">compute_length_clim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmu0</span></em>, <em class="sig-param"><span class="n">ri_st</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_length_clim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_length_clim" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Galpering length scale limit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmu0</strong> – parameter <span class="math notranslate nohighlight">\(c_\mu^0\)</span></p></li>
<li><p><strong>ri_st</strong> – gradient Richardson number</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.compute_sigma_psi">
<code class="sig-name descname">compute_sigma_psi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kappa</span></em>, <em class="sig-param"><span class="n">cmu0</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">c1</span></em>, <em class="sig-param"><span class="n">c2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_sigma_psi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_sigma_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Psi Schmidt number from von Karman constant.</p>
<p>See: Umlauf and Burchard (2003) eq (14)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kappa</strong> – von Karman constant</p></li>
<li><p><strong>n</strong><strong>, </strong><strong>c1</strong><strong>, </strong><strong>c2</strong> (<em>cmu0</em><em>,</em>) – GLS model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.eval_funcs">
<code class="sig-name descname">eval_funcs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha_buoy</span></em>, <em class="sig-param"><span class="n">alpha_shear</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.eval_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.eval_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate (unlimited) stability functions</p>
<p>See: Burchard and Petersen (1999) eqns (30) and (31)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p></li>
<li><p><strong>alpha_shear</strong> – normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(S_m\)</span>, <span class="math notranslate nohighlight">\(S_\rho\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shear2</span></em>, <em class="sig-param"><span class="n">buoy2</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">eps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate stability functions from dimensional variables.</p>
<p>Applies limiters on <span class="math notranslate nohighlight">\(\alpha_N\)</span> and <span class="math notranslate nohighlight">\(\alpha_M\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shear2</strong> – shear frequency squared, <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>buoy2</strong> – buoyancy frequency squared,:math:<cite>N^2</cite></p></li>
<li><p><strong>k</strong> – turbulent kinetic energy, <span class="math notranslate nohighlight">\(k\)</span></p></li>
<li><p><strong>eps</strong> – TKE dissipation rate, <span class="math notranslate nohighlight">\(\varepsilon\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_min">
<code class="sig-name descname">get_alpha_buoy_min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_buoy_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute minimum normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p>
<p>See: Umlauf and Buchard (2005), Table 3</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_smooth_min">
<code class="sig-name descname">get_alpha_buoy_smooth_min</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha_buoy</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_buoy_smooth_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_smooth_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothed minimum for normalized buoyancy frequency</p>
<p>See: Burchard and Petersen (1999), eq (19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.get_alpha_shear_max">
<code class="sig-name descname">get_alpha_shear_max</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha_buoy</span></em>, <em class="sig-param"><span class="n">alpha_shear</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_shear_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_shear_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute maximum normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p>
<p>from Umlauf and Buchard (2005) eq (44)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p></li>
<li><p><strong>alpha_shear</strong> – normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.stability_functions.StabilityFunctionBase.name">
<em class="property">abstract property </em><code class="sig-name descname">name</code><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">StabilityFunctionCanutoA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.CanutoStabilityFunctionBase</span></code></p>
<p>Canuto A stability function as defined in the Canuto (2001) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l1">
<code class="sig-name descname">l1</code><em class="property"> = 0.107</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l2">
<code class="sig-name descname">l2</code><em class="property"> = 0.0032</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l3">
<code class="sig-name descname">l3</code><em class="property"> = 0.0864</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l4">
<code class="sig-name descname">l4</code><em class="property"> = 0.12</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l5">
<code class="sig-name descname">l5</code><em class="property"> = 11.9</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l6">
<code class="sig-name descname">l6</code><em class="property"> = 0.4</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l7">
<code class="sig-name descname">l7</code><em class="property"> = 0</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.l8">
<code class="sig-name descname">l8</code><em class="property"> = 0.48</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA.name">
<code class="sig-name descname">name</code><em class="property"> = 'Canuto A'</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">StabilityFunctionCanutoB</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.CanutoStabilityFunctionBase</span></code></p>
<p>Canuto B stability function as defined in the Canuto (2001) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l1">
<code class="sig-name descname">l1</code><em class="property"> = 0.127</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l2">
<code class="sig-name descname">l2</code><em class="property"> = 0.00336</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l3">
<code class="sig-name descname">l3</code><em class="property"> = 0.0906</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l4">
<code class="sig-name descname">l4</code><em class="property"> = 0.101</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l5">
<code class="sig-name descname">l5</code><em class="property"> = 11.2</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l6">
<code class="sig-name descname">l6</code><em class="property"> = 0.4</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l7">
<code class="sig-name descname">l7</code><em class="property"> = 0</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.l8">
<code class="sig-name descname">l8</code><em class="property"> = 0.318</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB.name">
<code class="sig-name descname">name</code><em class="property"> = 'Canuto B'</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.StabilityFunctionCheng">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">StabilityFunctionCheng</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCheng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.ChengStabilityFunctionBase</span></code></p>
<p>Cheng stability function as defined in the Cheng et al (2002) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l1">
<code class="sig-name descname">l1</code><em class="property"> = 0.107</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l2">
<code class="sig-name descname">l2</code><em class="property"> = 0.0032</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l3">
<code class="sig-name descname">l3</code><em class="property"> = 0.0864</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l4">
<code class="sig-name descname">l4</code><em class="property"> = 0.1</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l5">
<code class="sig-name descname">l5</code><em class="property"> = 11.04</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l6">
<code class="sig-name descname">l6</code><em class="property"> = 0.786</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l7">
<code class="sig-name descname">l7</code><em class="property"> = 0.643</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.l8">
<code class="sig-name descname">l8</code><em class="property"> = 0.547</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.StabilityFunctionCheng.name">
<code class="sig-name descname">name</code><em class="property"> = 'Cheng'</em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">GOTMStabilityFunctionCanutoA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCanutoA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.GOTMStabilityFunctionBase</span></code></p>
<p>Canuto et al. (2001) version A stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb1">
<code class="sig-name descname">cb1</code><em class="property"> = 5.95</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb2">
<code class="sig-name descname">cb2</code><em class="property"> = 0.6</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb3">
<code class="sig-name descname">cb3</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb4">
<code class="sig-name descname">cb4</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb5">
<code class="sig-name descname">cb5</code><em class="property"> = 0.3333</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cbb">
<code class="sig-name descname">cbb</code><em class="property"> = 0.72</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cbb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc1">
<code class="sig-name descname">cc1</code><em class="property"> = 5.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc2">
<code class="sig-name descname">cc2</code><em class="property"> = 0.8</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc3">
<code class="sig-name descname">cc3</code><em class="property"> = 1.968</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc4">
<code class="sig-name descname">cc4</code><em class="property"> = 1.136</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc5">
<code class="sig-name descname">cc5</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc6">
<code class="sig-name descname">cc6</code><em class="property"> = 0.4</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.name">
<code class="sig-name descname">name</code><em class="property"> = 'Canuto A'</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">GOTMStabilityFunctionCanutoB</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCanutoB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.GOTMStabilityFunctionBase</span></code></p>
<p>Canuto et al. (2001) version B stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb1">
<code class="sig-name descname">cb1</code><em class="property"> = 5.6</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb2">
<code class="sig-name descname">cb2</code><em class="property"> = 0.6</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb3">
<code class="sig-name descname">cb3</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb4">
<code class="sig-name descname">cb4</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb5">
<code class="sig-name descname">cb5</code><em class="property"> = 0.3333</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cbb">
<code class="sig-name descname">cbb</code><em class="property"> = 0.477</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cbb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc1">
<code class="sig-name descname">cc1</code><em class="property"> = 5.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc2">
<code class="sig-name descname">cc2</code><em class="property"> = 0.6983</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc3">
<code class="sig-name descname">cc3</code><em class="property"> = 1.9664</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc4">
<code class="sig-name descname">cc4</code><em class="property"> = 1.094</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc5">
<code class="sig-name descname">cc5</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc6">
<code class="sig-name descname">cc6</code><em class="property"> = 0.495</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.name">
<code class="sig-name descname">name</code><em class="property"> = 'Canuto B'</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">GOTMStabilityFunctionCheng</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCheng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.GOTMStabilityFunctionBase</span></code></p>
<p>Cheng et al. (2002) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb1">
<code class="sig-name descname">cb1</code><em class="property"> = 5.52</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb2">
<code class="sig-name descname">cb2</code><em class="property"> = 0.2134</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb3">
<code class="sig-name descname">cb3</code><em class="property"> = 0.357</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb4">
<code class="sig-name descname">cb4</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb5">
<code class="sig-name descname">cb5</code><em class="property"> = 0.3333</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cbb">
<code class="sig-name descname">cbb</code><em class="property"> = 0.82</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cbb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc1">
<code class="sig-name descname">cc1</code><em class="property"> = 5.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc2">
<code class="sig-name descname">cc2</code><em class="property"> = 0.7983</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc3">
<code class="sig-name descname">cc3</code><em class="property"> = 1.968</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc4">
<code class="sig-name descname">cc4</code><em class="property"> = 1.136</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc5">
<code class="sig-name descname">cc5</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc6">
<code class="sig-name descname">cc6</code><em class="property"> = 0.5</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionCheng.name">
<code class="sig-name descname">name</code><em class="property"> = 'Cheng'</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson">
<em class="property">class </em><code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">GOTMStabilityFunctionKanthaClayson</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lim_alpha_shear</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lim_alpha_buoy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_alpha_buoy_lim</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha_buoy_crit</span><span class="o">=</span><span class="default_value">- 1.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionKanthaClayson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.stability_functions.GOTMStabilityFunctionBase</span></code></p>
<p>Kantha and Clayson (1994) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb1">
<code class="sig-name descname">cb1</code><em class="property"> = 3.728</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb2">
<code class="sig-name descname">cb2</code><em class="property"> = 0.7</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb3">
<code class="sig-name descname">cb3</code><em class="property"> = 0.7</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb4">
<code class="sig-name descname">cb4</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb5">
<code class="sig-name descname">cb5</code><em class="property"> = 0.2</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cbb">
<code class="sig-name descname">cbb</code><em class="property"> = 0.6102</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cbb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc1">
<code class="sig-name descname">cc1</code><em class="property"> = 6.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc2">
<code class="sig-name descname">cc2</code><em class="property"> = 0.32</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc3">
<code class="sig-name descname">cc3</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc4">
<code class="sig-name descname">cc4</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc5">
<code class="sig-name descname">cc5</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc6">
<code class="sig-name descname">cc6</code><em class="property"> = 0.0</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.name">
<code class="sig-name descname">name</code><em class="property"> = 'Kantha Clayson'</em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.stability_functions.compute_normalized_frequencies">
<code class="sig-prename descclassname">thetis.stability_functions.</code><code class="sig-name descname">compute_normalized_frequencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shear2</span></em>, <em class="sig-param"><span class="n">buoy2</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">eps</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#compute_normalized_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.compute_normalized_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes normalized buoyancy and shear frequency squared.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
<p>From Burchard and Bolding (2001).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shear2</strong> – <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>buoy2</strong> – <span class="math notranslate nohighlight">\(N^2\)</span></p></li>
<li><p><strong>k</strong> – turbulent kinetic energy</p></li>
<li><p><strong>eps</strong> – TKE dissipation rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-thetis.timeintegrator">
<span id="thetis-timeintegrator-module"></span><h2>thetis.timeintegrator module<a class="headerlink" href="#module-thetis.timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Generic time integration schemes to advance equations in time.</p>
<dl class="py class">
<dt id="thetis.timeintegrator.CrankNicolson">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">CrankNicolson</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">theta</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard Crank-Nicolson time integration scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Implicitness parameter, default 0.5</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.CrankNicolson.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.CrankNicolson.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.CrankNicolson.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.CrankNicolson.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.ForwardEuler">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">ForwardEuler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard forward Euler time integration scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.ForwardEuler.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.ForwardEuler.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.ForwardEuler.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.ForwardEuler.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.LeapFrogAM3">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">LeapFrogAM3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 ALE time integrator</p>
<p>Defined in (2.27)-(2.30) in [1]; (2.21)-(2.22) in [2]</p>
<p>[1] Shchepetkin and McWilliams (2005). The regional oceanic modeling system
(ROMS): a split-explicit, free-surface, topography-following-coordinate
oceanic model. Ocean Modelling, 9(4):347-404.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2013.04.010">http://dx.doi.org/10.1016/j.ocemod.2013.04.010</a></p>
<p>[2] Shchepetkin and McWilliams (2009). Computational Kernel Algorithms for
Fine-Scale, Multiprocess, Longtime Oceanic Simulations, 14:121-183.
<a class="reference external" href="http://dx.doi.org/10.1016/S1570-8659(08)01202-0">http://dx.doi.org/10.1016/S1570-8659(08)01202-0</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.LeapFrogAM3.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.LeapFrogAM3.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.5874</em><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.LeapFrogAM3.correct">
<code class="sig-name descname">correct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Correction step from <span class="math notranslate nohighlight">\(t_{n}\)</span> to <span class="math notranslate nohighlight">\(t_{n+1}\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(M_n\)</span> denote the mass matrix at time <span class="math notranslate nohighlight">\(t_{n}\)</span>.
The correction step is</p>
<div class="math notranslate nohighlight">
\[M_{n+1} T_{n+1} = M_{n} T_{n} + \Delta t L_{n+1/2}\]</div>
<p>This is Euler ALE step: LHS is evaluated in <span class="math notranslate nohighlight">\(\Omega_{n+1}\)</span>,
RHS in <span class="math notranslate nohighlight">\(\Omega_n\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.LeapFrogAM3.eval_rhs">
<code class="sig-name descname">eval_rhs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.eval_rhs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.eval_rhs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.LeapFrogAM3.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.LeapFrogAM3.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Prediction step from <span class="math notranslate nohighlight">\(t_{n-1/2}\)</span> to <span class="math notranslate nohighlight">\(t_{n+1/2}\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(M_n\)</span> denote the mass matrix at time <span class="math notranslate nohighlight">\(t_{n}\)</span>.
The prediction step is</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_{n-1/2} &amp;= (1/2 - 2\gamma) T_{n-1} + (1/2 + 2 \gamma) T_{n} \\
M_n T_{n+1/2} &amp;= M_n T_{n-1/2} + \Delta t (1 - 2\gamma) M_n L_{n}\end{split}\]</div>
<p>This is computed in a fixed mesh: all terms are evaluated in
<span class="math notranslate nohighlight">\(\Omega_n\)</span>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.PressureProjectionPicard">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">PressureProjectionPicard</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">equation_mom</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters_mom</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">theta</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">semi_implicit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">iterations</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Pressure projection scheme with Picard iteration for shallow water
equations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – free surface equation</p></li>
<li><p><strong>equation_mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – momentum equation</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>solver_parameters_mom</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options for velocity solver</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Implicitness parameter, default 0.5</p></li>
<li><p><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True use a linearized semi-implicit scheme</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of Picard iterations</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">updateForcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.PressureProjectionPicard.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.SSPRK22ALE">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">SSPRK22ALE</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">terms_to_add</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>SSPRK(2,2) ALE time integrator for 3D fields</p>
<p>The scheme is</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{(1)} &amp;= u^{n} + \Delta t F(u^{n}) \\
u^{n+1} &amp;= u^{n} + \frac{\Delta t}{2}(F(u^{n}) +  F(u^{(1)}))\end{split}\]</div>
<p>Both stages are implemented as ALE updates from geometry <span class="math notranslate nohighlight">\(\Omega_n\)</span>
to <span class="math notranslate nohighlight">\(\Omega_{(1)}\)</span>, and <span class="math notranslate nohighlight">\(\Omega_{n+1}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.SSPRK22ALE.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.prepare_stage">
<code class="sig-name descname">prepare_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.prepare_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.prepare_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess stage i_stage.</p>
<p>This must be called prior to updating mesh geometry.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.solve_stage">
<code class="sig-name descname">solve_stage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_stage</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_one_prep">
<code class="sig-name descname">stage_one_prep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess first stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_one_solve">
<code class="sig-name descname">stage_one_solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>First stage: solve <span class="math notranslate nohighlight">\(u^{(1)}\)</span> given previous solution <span class="math notranslate nohighlight">\(u^n\)</span>.</p>
<p>This is a forward Euler ALE step between domains <span class="math notranslate nohighlight">\(\Omega^n\)</span> and <span class="math notranslate nohighlight">\(\Omega^{(1)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega^{(1)}} u^{(1)} \psi dx = \int_{\Omega^n} u^n \psi dx + \Delta t \int_{\Omega^n} F(u^n) \psi dx\]</div>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_two_prep">
<code class="sig-name descname">stage_two_prep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess 2nd stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_two_solve">
<code class="sig-name descname">stage_two_solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>2nd stage: solve <span class="math notranslate nohighlight">\(u^{n+1}\)</span> given previous solutions <span class="math notranslate nohighlight">\(u^n, u^{(1)}\)</span>.</p>
<p>This is an ALE step:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_{\Omega^{n+1}} u^{n+1} \psi dx &amp;= \int_{\Omega^n} u^n \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^n} F(u^n) \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^{(1)}} F(u^{(1)}) \psi dx\end{split}\]</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.SteadyState">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">SteadyState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Time integrator that solves the steady state equations, leaving out the
mass terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.SteadyState.advance">
<code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.timeintegrator.SteadyState.cfl_coeff">
<code class="sig-name descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.timeintegrator.SteadyState.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SteadyState.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.SteadyState.update_solver">
<code class="sig-name descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.TimeIntegrator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">TimeIntegrator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equation</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.timeintegrator.TimeIntegratorBase</span></code></a></p>
<p>Base class for all time integrator objects that march a single equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.timeintegrator.TimeIntegrator.set_dt">
<code class="sig-name descname">set_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Update time step</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.timeintegrator.TimeIntegratorBase">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">TimeIntegratorBase</code><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class that defines the API for all time integrators</p>
<p>Both <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator</span></code> inherit
from this class.</p>
<dl class="py method">
<dt id="thetis.timeintegrator.TimeIntegratorBase.advance">
<em class="property">abstract </em><code class="sig-name descname">advance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">update_forcings</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.timeintegrator.TimeIntegratorBase.initialize">
<em class="property">abstract </em><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solution</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_solution</strong> – initial solution</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.timeintegrator.timed_region">
<code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.timeintegrator.timed_stage">
<code class="sig-prename descclassname">thetis.timeintegrator.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.timezone">
<span id="thetis-timezone-module"></span><h2>thetis.timezone module<a class="headerlink" href="#module-thetis.timezone" title="Permalink to this headline">¶</a></h2>
<p>Timezone definitions and conversion methods</p>
<dl class="py class">
<dt id="thetis.timezone.FixedTimeZone">
<em class="property">class </em><code class="sig-prename descclassname">thetis.timezone.</code><code class="sig-name descname">FixedTimeZone</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offset</span></em>, <em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#FixedTimeZone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timezone.FixedTimeZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pytz._FixedOffset</span></code></p>
<p>Class that represents a fixed time zone defined by UTC offset in hours.</p>
<p>arg int offset: timezone UTC offset in hours
arg str name: timezone name</p>
<dl class="py method">
<dt id="thetis.timezone.FixedTimeZone.tzname">
<code class="sig-name descname">tzname</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#FixedTimeZone.tzname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timezone.FixedTimeZone.tzname" title="Permalink to this definition">¶</a></dt>
<dd><p>datetime -&gt; string name of time zone.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.timezone.datetime_to_epoch">
<code class="sig-prename descclassname">thetis.timezone.</code><code class="sig-name descname">datetime_to_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#datetime_to_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timezone.datetime_to_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert python datetime object to epoch time stamp.</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.timezone.epoch_to_datetime">
<code class="sig-prename descclassname">thetis.timezone.</code><code class="sig-name descname">epoch_to_datetime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#epoch_to_datetime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timezone.epoch_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert python datetime object to epoch time stamp.</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.tracer_eq">
<span id="thetis-tracer-eq-module"></span><h2>thetis.tracer_eq module<a class="headerlink" href="#module-thetis.tracer_eq" title="Permalink to this headline">¶</a></h2>
<p>3D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of tracer <span class="math notranslate nohighlight">\(T\)</span> in conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-tracer-eq">
<span class="eqno">(14)<a class="headerlink" href="#equation-tracer-eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t}
 + \nabla_h \cdot (\textbf{u} T)
 + \frac{\partial (w T)}{\partial z}
 = \nabla_h \cdot (\mu_h \nabla_h T)
 + \frac{\partial}{\partial z} \Big(\mu \frac{\partial T}{\partial z}\Big)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> and
<span class="math notranslate nohighlight">\(w\)</span> are the horizontal and vertical velocities, respectively, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> denote horizontal and vertical diffusivity.</p>
<dl class="py class">
<dt id="thetis.tracer_eq.TracerEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">TracerEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 12)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 13)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>3D tracer advection-diffusion equation <a class="reference internal" href="#equation-tracer-eq">(14)</a> in conservative form</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.TracerTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">TracerTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.TracerTerm.get_bnd_functions">
<code class="sig-name descname">get_bnd_functions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c_in</span></em>, <em class="sig-param"><span class="n">uv_in</span></em>, <em class="sig-param"><span class="n">elev_in</span></em>, <em class="sig-param"><span class="n">bnd_id</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_in</strong> – Internal value of tracer</p></li>
<li><p><strong>uv_in</strong> – Internal value of horizontal velocity</p></li>
<li><p><strong>elev_in</strong> – Internal value of elevation</p></li>
<li><p><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – boundary id</p></li>
<li><p><strong>bnd_conditions</strong> – dict of boundary conditions:
<code class="docutils literal notranslate"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal advection term <span class="math notranslate nohighlight">\(\nabla_h \cdot (\textbf{u} T)\)</span></p>
<p>The weak formulation reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla_h \cdot (\textbf{u} T) \phi dx
    = -\int_\Omega T\textbf{u} \cdot \nabla_h \phi dx
    + \int_{\mathcal{I}_h\cup\mathcal{I}_v}
        T^{\text{up}} \text{avg}(\textbf{u}) \cdot
        \text{jump}(\phi \textbf{n}_h) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\mathcal{I}_h,\mathcal{I}_v\)</span> denote the set of horizontal and
vertical facets,
<span class="math notranslate nohighlight">\(\textbf{n}_h\)</span> is the horizontal projection of the unit normal vector,
<span class="math notranslate nohighlight">\(T^{\text{up}}\)</span> is the upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and
<span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the jump and average operators across the
interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical advection term <span class="math notranslate nohighlight">\(\partial (w T)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \frac{\partial (w T)}{\partial z} \phi dx
= - \int_\Omega T w \frac{\partial \phi}{\partial z} dx
+ \int_{\mathcal{I}_v} T^{\text{up}} \text{avg}(w) \text{jump}(\phi n_z) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\mathcal{I}_v\)</span> denotes the set of vertical facets,
<span class="math notranslate nohighlight">\(n_z\)</span> is the vertical projection of the unit normal vector,
<span class="math notranslate nohighlight">\(T^{\text{up}}\)</span> is the
upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<p>In the case of ALE moving mesh we substitute <span class="math notranslate nohighlight">\(w\)</span> with <span class="math notranslate nohighlight">\(w - w_m\)</span>,
<span class="math notranslate nohighlight">\(w_m\)</span> being the mesh velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">HorizontalDiffusionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math notranslate nohighlight">\(-\nabla_h \cdot (\mu_h \nabla_h T)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
=&amp; -\int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h T) dS
+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(T \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(T \textbf{n}_h) \cdot
    \text{jump}(\phi \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">VerticalDiffusionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical diffusion term <span class="math notranslate nohighlight">\(-\frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big) \phi dx
=&amp; -\int_\Omega \mu \frac{\partial T}{\partial z} \frac{\partial \phi}{\partial z} dz \\
&amp;+ \int_{\mathcal{I}_{h}} \text{jump}(\phi n_z) \text{avg}\Big(\mu \frac{\partial T}{\partial z}\Big) dS
+ \int_{\mathcal{I}_{h}} \text{jump}(T n_z) \text{avg}\Big(\mu \frac{\partial \phi}{\partial z}\Big) dS \\
&amp;- \int_{\mathcal{I}_{h}} \sigma \text{avg}(\mu) \text{jump}(T n_z) \cdot
    \text{jump}(\phi n_z) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq.SourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq.</code><code class="sig-name descname">SourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_symmetric_surf_bnd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 10)</span></em>, <em class="sig-param"><span class="n">sipg_parameter_vertical</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 11)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq.SourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.tracer_eq_2d">
<span id="thetis-tracer-eq-2d-module"></span><h2>thetis.tracer_eq_2d module<a class="headerlink" href="#module-thetis.tracer_eq_2d" title="Permalink to this headline">¶</a></h2>
<p>2D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of tracer <span class="math notranslate nohighlight">\(T\)</span> in non-conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-tracer-eq-2d">
<span class="eqno">(15)<a class="headerlink" href="#equation-tracer-eq-2d" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t}
+ \nabla_h \cdot (\textbf{u} T)
= \nabla_h \cdot (\mu_h \nabla_h T)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> are the horizontal
velocities, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> denotes horizontal diffusivity.</p>
<dl class="py class">
<dt id="thetis.tracer_eq_2d.TracerEquation2D">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq_2d.</code><code class="sig-name descname">TracerEquation2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 34)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerEquation2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerEquation2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>2D tracer advection-diffusion equation <a class="reference internal" href="#equation-tracer-eq">(14)</a> in conservative form</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq_2d.TracerTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq_2d.</code><code class="sig-name descname">TracerTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 33)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq_2d.TracerTerm.get_bnd_functions">
<code class="sig-name descname">get_bnd_functions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c_in</span></em>, <em class="sig-param"><span class="n">uv_in</span></em>, <em class="sig-param"><span class="n">elev_in</span></em>, <em class="sig-param"><span class="n">bnd_id</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_in</strong> – Internal value of tracer</p></li>
<li><p><strong>uv_in</strong> – Internal value of horizontal velocity</p></li>
<li><p><strong>elev_in</strong> – Internal value of elevation</p></li>
<li><p><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – boundary id</p></li>
<li><p><strong>bnd_conditions</strong> – dict of boundary conditions:
<code class="docutils literal notranslate"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq_2d.HorizontalAdvectionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq_2d.</code><code class="sig-name descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 33)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq_2d.TracerTerm</span></code></a></p>
<p>Advection of tracer term, <span class="math notranslate nohighlight">\(\bar{\textbf{u}} \cdot \nabla T\)</span></p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \bar{\textbf{u}} \cdot \boldsymbol{\psi} \cdot \nabla T  dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot T dx
+ \int_\Gamma \text{avg}(T) \cdot \text{jump}(\boldsymbol{\psi}
(\bar{\textbf{u}}\cdot\textbf{n})) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq_2d.HorizontalAdvectionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq_2d.HorizontalDiffusionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq_2d.</code><code class="sig-name descname">HorizontalDiffusionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 33)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq_2d.TracerTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math notranslate nohighlight">\(-\nabla_h \cdot (\mu_h \nabla_h T)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
=&amp; \int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h T) dS
- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(T \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(T \textbf{n}_h) \cdot
    \text{jump}(\phi \textbf{n}_h) dS \\
&amp;- \int_\Gamma \mu_h (\nabla_h \phi) \cdot \textbf{n}_h ds\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq_2d.HorizontalDiffusionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.tracer_eq_2d.SourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.tracer_eq_2d.</code><code class="sig-name descname">SourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">use_lax_friedrichs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 33)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq_2d.TracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>use_lax_friedrichs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use Lax Friedrichs stabilisation</p></li>
<li><p><strong>sipg_parameter</strong> – <dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> penalty parameter for SIPG</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.tracer_eq_2d.SourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq_2d.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.turbines">
<span id="thetis-turbines-module"></span><h2>thetis.turbines module<a class="headerlink" href="#module-thetis.turbines" title="Permalink to this headline">¶</a></h2>
<p>Classes related to tidal turbine farms in Thetis.</p>
<dl class="py class">
<dt id="thetis.turbines.TurbineFarm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbines.</code><code class="sig-name descname">TurbineFarm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">farm_options</span></em>, <em class="sig-param"><span class="n">subdomain_id</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineFarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Evaluates power output, costs and profit of tidal turbine farm</p>
<p>Cost is simply the number of turbines evaluated as the integral of the
turbine density.</p>
<p>Power output is calculated as the amount of energy
taken out of the flow by the turbine drag term. This is in general
an over-estimate of the ‘usefully extractable’ energy. Furthermore no
density is included, so that assuming a density of 1000 kg/m^3 and
all further quantities in SI, the power is measured in kW.</p>
<p>Profit is calculated as:</p>
<blockquote>
<div><p>Profit = Power - break_even_wattage * Cost</p>
</div></blockquote>
<p>With the above assumptions, break_even_wattage should be specified in
kW and can be interpreted as the average power per turbine required
to ‘break even’, i.e. Profit=0.</p>
<p>Power output and profit are time-integrated (simple first order) and
time-averages are available as average_power and average_profit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>farm_options</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineFarmOptions</span></code> object that define the farm and the turbines used</p></li>
<li><p><strong>subdomain_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – the farm is restricted to this subdomain</p></li>
<li><p><strong>u</strong><strong>,</strong><strong>v</strong> – the depth-averaged velocity field</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – used for time-integration.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbines.TurbineFarm.evaluate_timestep">
<code class="sig-name descname">evaluate_timestep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFarm.evaluate_timestep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineFarm.evaluate_timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform time integration and return current power and time-averaged power and profit.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbines.TurbineFunctionalCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbines.</code><code class="sig-name descname">TurbineFunctionalCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFunctionalCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p><a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> that evaluates the performance of each tidal turbine farm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object containing the tidal_turbine_farms</p></li>
<li><p><strong>kwargs</strong> – see <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbines.TurbineFunctionalCallback.average_power">
<em class="property">property </em><code class="sig-name descname">average_power</code><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.average_power" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the time-averaged power output of all farms</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbines.TurbineFunctionalCallback.average_profit">
<em class="property">property </em><code class="sig-name descname">average_profit</code><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.average_profit" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the time-averaged profit output of all farms</p>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.turbines.TurbineFunctionalCallback.farms">
<code class="sig-name descname">farms</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.farms" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the number of turbines in all farms</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbines.TurbineFunctionalCallback.integrated_power">
<em class="property">property </em><code class="sig-name descname">integrated_power</code><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.integrated_power" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the time-integrated power output of all farms</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbines.TurbineFunctionalCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_power</span></em>, <em class="sig-param"><span class="n">average_power</span></em>, <em class="sig-param"><span class="n">average_profit</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFunctionalCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.turbines.TurbineFunctionalCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'turbine'</em><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.turbines.TurbineFunctionalCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['current_power', 'average_power', 'average_profit']</em><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbines.TurbineOptimisationCallback">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbines.</code><code class="sig-name descname">TurbineOptimisationCallback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em>, <em class="sig-param"><span class="n">turbine_functional_callback</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.optimisation.DiagnosticOptimisationCallback</span></code></a></p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code> that evaluates the performance of each tidal turbine farm during an optimisation.</p>
<p>See the <code class="xref py py-mod docutils literal notranslate"><span class="pre">optimisation</span></code> module for more info about the use of OptimisationCallbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object</p></li>
<li><p><strong>turbine_functional_callback</strong> – a <a class="reference internal" href="#thetis.turbines.TurbineFunctionalCallback" title="thetis.turbines.TurbineFunctionalCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbineFunctionalCallback</span></code></a> used in the forward model</p></li>
</ul>
</dd>
<dt class="field-even">Args kwargs</dt>
<dd class="field-even"><p>see <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbines.TurbineOptimisationCallback.compute_values">
<code class="sig-name descname">compute_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback.compute_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.compute_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbines.TurbineOptimisationCallback.message_str">
<code class="sig-name descname">message_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cost</span></em>, <em class="sig-param"><span class="n">average_power</span></em>, <em class="sig-param"><span class="n">average_profit</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="thetis.turbines.TurbineOptimisationCallback.name">
<code class="sig-name descname">name</code><em class="property"> = 'farm_optimisation'</em><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.turbines.TurbineOptimisationCallback.variable_names">
<code class="sig-name descname">variable_names</code><em class="property"> = ['cost', 'average_power', 'average_profit']</em><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.turbulence">
<span id="thetis-turbulence-module"></span><h2>thetis.turbulence module<a class="headerlink" href="#module-thetis.turbulence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generic-length-scale-turbulence-closure-model">
<h3>Generic Length Scale Turbulence Closure model<a class="headerlink" href="#generic-length-scale-turbulence-closure-model" title="Permalink to this headline">¶</a></h3>
<p>This model solves two dynamic equations, for turbulent kinetic energy
(TKE, <span class="math notranslate nohighlight">\(k\)</span>) and one for an additional variable, the generic length scale
<span class="math notranslate nohighlight">\(\psi\)</span> [1]:</p>
<div class="math notranslate nohighlight" id="equation-turb-tke-eq">
<span class="eqno">(16)<a class="headerlink" href="#equation-turb-tke-eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial k}{\partial t} + \nabla_h \cdot (\textbf{u} k)
    + \frac{\partial (w k)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_k} \frac{\partial k}{\partial z}\right)
    + P + B - \varepsilon\]</div>
<div class="math notranslate nohighlight" id="equation-turb-psi-eq">
<span class="eqno">(17)<a class="headerlink" href="#equation-turb-psi-eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial \psi}{\partial t} + \nabla_h \cdot (\textbf{u} \psi)
    + \frac{\partial (w \psi)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_\psi} \frac{\partial \psi}{\partial z}\right)
    + \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>with the production <span class="math notranslate nohighlight">\(P\)</span> and buoyancy production <span class="math notranslate nohighlight">\(B\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}P &amp;= \nu M^2 \\
B &amp;= -\mu N^2\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are the shear and buoyancy frequencies</p>
<div class="math notranslate nohighlight">
\[\begin{split}M^2 &amp;= \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2 \\
N^2 &amp;= -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\end{split}\]</div>
<p>The generic length scale variable is defined as</p>
<div class="math notranslate nohighlight">
\[\psi = (c_\mu^0)^p k^m l^n\]</div>
<p>where <span class="math notranslate nohighlight">\(p, m, n\)</span> are parameters and <span class="math notranslate nohighlight">\(c_\mu^0\)</span> is an empirical constant.</p>
<p>The parameters <span class="math notranslate nohighlight">\(c_1,c_2,c_3,f_{wall}\)</span> depend on the chosen closure.
The parameter <span class="math notranslate nohighlight">\(c_3\)</span> takes two values: <span class="math notranslate nohighlight">\(c_3^-\)</span> in stably stratified
regime, and <span class="math notranslate nohighlight">\(c_3^+\)</span> in unstably stratified cases.</p>
<p>Turbulent length scale <span class="math notranslate nohighlight">\(l\)</span>, and the TKE dissipation rate
<span class="math notranslate nohighlight">\(\varepsilon\)</span> are obtained diagnostically as</p>
<div class="math notranslate nohighlight">
\[\begin{split}l &amp;= (c_\mu^0)^3 k^{3/2} \varepsilon^{-1} \\
\varepsilon &amp;= (c_\mu^0)^{3+p/n} k^{3/2 + m/n} \psi^{-1/n}\end{split}\]</div>
<p>Finally the vertical eddy viscosity and diffusivity are also computed
diagnostically</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu &amp;= \sqrt{2k} l S_m \\
\mu &amp;= \sqrt{2k} l S_\rho\end{split}\]</div>
<p>Stability functions <span class="math notranslate nohighlight">\(S_m\)</span> and <span class="math notranslate nohighlight">\(S_\rho\)</span> are defined in [2] or [3].
Implementation follows [4].</p>
<div class="section" id="supported-closures">
<h4>Supported closures<a class="headerlink" href="#supported-closures" title="Permalink to this headline">¶</a></h4>
<p>The GLS model parameters are controlled via the <a class="reference internal" href="#thetis.options.GLSModelOptions" title="thetis.options.GLSModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">GLSModelOptions</span></code></a> class.</p>
<p>The parameters can be accessed from the solver object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">FlowSolver</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">turbulence_model_type</span> <span class="o">=</span> <span class="s1">&#39;gls&#39;</span>  <span class="c1"># activate GLS model (default)</span>
<span class="n">turbulence_model_options</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">turbulence_model_options</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">closure_name</span> <span class="o">=</span> <span class="s1">&#39;k-omega&#39;</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">stability_function_name</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">compute_c3_minus</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Currently the following closures have been implemented:</p>
<ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(k-\varepsilon\)</span> model</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=3, m=3/2, n=-1\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\varepsilon\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-epsilon</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(k-\omega\)</span> model</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=-1, m=1/2, n=-1\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-omega</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GLS model A</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=2, m=1, n=-2/3\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">gen</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>The following stability functions have been implemented</p>
<ul class="simple">
<li><dl class="simple">
<dt>Canuto A [3]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CA</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Canuto B [3]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CB</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Kantha-Clayson [2]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">KC</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Cheng [6]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CH</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>See <a class="reference internal" href="#module-thetis.stability_functions" title="thetis.stability_functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stability_functions</span></code></a> for more information.</p>
<dl class="simple">
<dt>[1] Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for</dt><dd><p>geophysical turbulence models. Journal of Marine Research, 61:235–265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></p>
</dd>
<dt>[2] Kantha, L. H. and Clayson, C. A. (1994). An improved mixed layer model for</dt><dd><p>geophysical applications. Journal of Geophysical Research: Oceans,
99(C12):25235–25266.
<a class="reference external" href="http://dx.doi.org/10.1029/94JC02257">http://dx.doi.org/10.1029/94JC02257</a></p>
</dd>
<dt>[3] Canuto et al. (2001). Ocean Turbulence. Part I: One-Point Closure Model -</dt><dd><p>Momentum and Heat Vertical Diffusivities. Journal of Physical Oceanography,
31(6):1413-1426.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></p>
</dd>
<dt>[4] Warner et al. (2005). Performance of four turbulence closure models</dt><dd><p>implemented using a generic length scale method. Ocean Modelling,
8(1-2):81–113.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2003.12.003">http://dx.doi.org/10.1016/j.ocemod.2003.12.003</a></p>
</dd>
<dt>[5] Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models</dt><dd><p>for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795–827.
<a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></p>
</dd>
<dt>[6] Cheng et al. (2002). An improved model for the turbulent PBL.</dt><dd><p>J. Atmos. Sci., 59:1550-1565.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2</a></p>
</dd>
<dt>[7] Burchard and Petersen (1999). Models of turbulence in the marine</dt><dd><p>environment - a comparative study of two-equation turbulence models.
Journal of Marine Systems, 21(1-4):29-53.
<a class="reference external" href="http://dx.doi.org/10.1016/S0924-7963(99)00004-4">http://dx.doi.org/10.1016/S0924-7963(99)00004-4</a></p>
</dd>
</dl>
<dl class="py class">
<dt id="thetis.turbulence.BuoyFrequencySolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">BuoyFrequencySolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rho</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">n2_tmp</span></em>, <em class="sig-param"><span class="n">relaxation</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">minval</span><span class="o">=</span><span class="default_value">1e-12</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes buoyancy frequency squared form the given horizontal
velocity field.</p>
<div class="math notranslate nohighlight">
\[N^2 = -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – <span class="math notranslate nohighlight">\(N^2\)</span> field</p></li>
<li><p><strong>n2_tmp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – temporary field</p></li>
<li><p><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – relaxation coefficient for mixing old and new
values N2 = relaxation*N2_new + (1-relaxation)*N2_old</p></li>
<li><p><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value for <span class="math notranslate nohighlight">\(N^2\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.BuoyFrequencySolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solve</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True if solving for the first time, skips
relaxation</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">GLSVerticalDiffusionTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">schmidt_nb</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sipg_parameter</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 32)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="thetis.tracer_eq.VerticalDiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.VerticalDiffusionTerm</span></code></a></p>
<p>Vertical diffusion term where the diffusivity is replaced by
viscosity/Schmidt number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>schmidt_nb</strong> – the Schmidt number of TKE or Psi</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.GenericLengthScaleModel">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">GenericLengthScaleModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em>, <em class="sig-param"><span class="n">k_field</span></em>, <em class="sig-param"><span class="n">psi_field</span></em>, <em class="sig-param"><span class="n">uv_field</span></em>, <em class="sig-param"><span class="n">rho_field</span></em>, <em class="sig-param"><span class="n">l_field</span></em>, <em class="sig-param"><span class="n">epsilon_field</span></em>, <em class="sig-param"><span class="n">eddy_diffusivity</span></em>, <em class="sig-param"><span class="n">eddy_viscosity</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">m2</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbulence.TurbulenceModel" title="thetis.turbulence.TurbulenceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.turbulence.TurbulenceModel</span></code></a></p>
<p>Generic Length Scale turbulence closure model implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – FlowSolver object</p></li>
<li><p><strong>k_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – turbulent kinetic energy (TKE) field</p></li>
<li><p><strong>psi_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – generic length scale field</p></li>
<li><p><strong>uv_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>rho_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>l_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – turbulence length scale field</p></li>
<li><p><strong>epsilon_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – TKE dissipation rate field</p></li>
<li><p><strong>eddy_diffusivity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy diffusivity field</p></li>
<li><p><strong>eddy_viscosity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy viscosity field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for buoyancy frequency squared</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for vertical shear frequency squared</p></li>
<li><p><strong>options</strong> – GLS model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.GenericLengthScaleModel.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">l_init</span><span class="o">=</span><span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize turbulent fields.</p>
<p>k is set to k_min value. epsilon and psi are set to a value that
corresponds to l_init length scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>l_init</strong> – initial value for turbulent length scale.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.GenericLengthScaleModel.postprocess">
<code class="sig-name descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables <span class="math notranslate nohighlight">\(k,\psi\)</span>.</p>
<p>To be called after updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.GenericLengthScaleModel.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solve</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.GenericLengthScaleModel.print_debug">
<code class="sig-name descname">print_debug</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.print_debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.print_debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Print diagnostic field values for debugging.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.PacanowskiPhilanderModel">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">PacanowskiPhilanderModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em>, <em class="sig-param"><span class="n">uv_field</span></em>, <em class="sig-param"><span class="n">rho_field</span></em>, <em class="sig-param"><span class="n">eddy_diffusivity</span></em>, <em class="sig-param"><span class="n">eddy_viscosity</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">m2</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbulence.TurbulenceModel" title="thetis.turbulence.TurbulenceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.turbulence.TurbulenceModel</span></code></a></p>
<p>Gradient Richardson number based model by Pacanowski and Philander (1981).</p>
<p>Given the gradient Richardson number <span class="math notranslate nohighlight">\(Ri\)</span> the eddy viscosity and
diffusivity are computed diagnostically as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu &amp;= \frac{\nu_{max}}{(1 + \alpha Ri)^n} \\
\mu &amp;= \frac{\nu}{1 + \alpha Ri}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{max},\alpha,n\)</span> are constant parameters.
In unstably stratified cases where <span class="math notranslate nohighlight">\(Ri&lt;0\)</span>, value <span class="math notranslate nohighlight">\(Ri=0\)</span> is used.</p>
<p>Pacanowski and Philander (1981). Parameterization of vertical mixing in
numerical models of tropical oceans. Journal of Physical Oceanography,
11(11):1443-1451.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(1981)011%3C1443:POVMIN%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0485(1981)011%3C1443:POVMIN%3E2.0.CO;2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – FlowSolver object</p></li>
<li><p><strong>uv_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>rho_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eddy_diffusivity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy diffusivity field</p></li>
<li><p><strong>eddy_viscosity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy viscosity field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for buoyancy frequency squared</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for vertical shear frequency squared</p></li>
<li><p><strong>options</strong> – model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.PacanowskiPhilanderModel.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes fields</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.PacanowskiPhilanderModel.postprocess">
<code class="sig-name descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables.</p>
<p>To be called after evaluating the equations.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.PacanowskiPhilanderModel.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solve</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.PsiEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">PsiEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">gls_model</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Generic length scale equation <a class="reference internal" href="#equation-turb-psi-eq">(17)</a> without advection terms.</p>
<p>Advection of <span class="math notranslate nohighlight">\(\psi\)</span> is implemented using the standard tracer equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.PsiSourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">PsiSourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">gls_model</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the Psi equation <a class="reference internal" href="#equation-turb-psi-eq">(17)</a></p>
<div class="math notranslate nohighlight">
\[F_\psi = \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math notranslate nohighlight">\(c_3 B\)</span> is split in two:</p>
<div class="math notranslate nohighlight">
\[F_\psi = \frac{\psi^n}{k^n} (c_1 P + B_{source})
    + \frac{\psi^{n+1}}{k^n} (B_{sink} - c_2 \varepsilon f_{wall})\]</div>
<p>with <span class="math notranslate nohighlight">\(B_{source} \ge 0\)</span> and <span class="math notranslate nohighlight">\(B_{sink} &lt; 0\)</span>.</p>
<p>Also implements Neumann boundary condition at top and bottom [7]</p>
<div class="math notranslate nohighlight">
\[\left( \frac{\nu}{\sigma_\psi} \frac{\psi}{z} \right)\Big|_{\Gamma_b} =
n_z \frac{\nu}{\sigma_\psi} (c_\mu^0)^p k^m \kappa^n (z_b + z_0)^{n-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(z_b\)</span> is the distance from boundary, and <span class="math notranslate nohighlight">\(z_0\)</span> is the
roughness length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.PsiSourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.ShearFrequencySolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">ShearFrequencySolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">m2</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">mv</span></em>, <em class="sig-param"><span class="n">mu_tmp</span></em>, <em class="sig-param"><span class="n">relaxation</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">minval</span><span class="o">=</span><span class="default_value">1e-12</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical shear frequency squared form the given horizontal
velocity field.</p>
<div class="math notranslate nohighlight">
\[M^2 = \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – <span class="math notranslate nohighlight">\(M^2\)</span> field</p></li>
<li><p><strong>mu</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for x component of <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>mv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for y component of <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>mu_tmp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – temporary field</p></li>
<li><p><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – relaxation coefficient for mixing old and new values
M2 = relaxation*M2_new + (1-relaxation)*M2_old</p></li>
<li><p><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value for <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.ShearFrequencySolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solve</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True if solving for the first time, skips
relaxation</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.TKEEquation">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">TKEEquation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">gls_model</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKEEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKEEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Turbulent kinetic energy equation <a class="reference internal" href="#equation-turb-tke-eq">(16)</a> without advection terms.</p>
<p>Advection of TKE is implemented using the standard tracer equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.TKESourceTerm">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">TKESourceTerm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">gls_model</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_elem_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_elem_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the TKE equation <a class="reference internal" href="#equation-turb-tke-eq">(16)</a></p>
<div class="math notranslate nohighlight">
\[F_k = P + B - \varepsilon\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math notranslate nohighlight">\(B\)</span> is split in two:</p>
<div class="math notranslate nohighlight">
\[F_k = P + B_{source} + \frac{k^{n+1}}{k^n}(B_{sink} - \varepsilon)\]</div>
<p>with <span class="math notranslate nohighlight">\(B_{source} \ge 0\)</span> and <span class="math notranslate nohighlight">\(B_{sink} &lt; 0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.TKESourceTerm.residual">
<code class="sig-name descname">residual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solution_old</span></em>, <em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="n">fields_old</span></em>, <em class="sig-param"><span class="n">bnd_conditions</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.TurbulenceModel">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">TurbulenceModel</code><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for all vertical turbulence models</p>
<dl class="py method">
<dt id="thetis.turbulence.TurbulenceModel.initialize">
<em class="property">abstract </em><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all turbulence fields</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.TurbulenceModel.postprocess">
<em class="property">abstract </em><code class="sig-name descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables.</p>
<p>To be called after updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.turbulence.TurbulenceModel.preprocess">
<em class="property">abstract </em><code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_solve</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.turbulence.VerticalGradSolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">VerticalGradSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em>, <em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in the weak sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or expression to differentiate.</p></li>
<li><p><strong>solution</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the solution will be stored.
Must be in P0 space.</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.turbulence.VerticalGradSolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the gradient</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.turbulence.set_func_max_val">
<code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">set_func_max_val</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">maxval</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_max_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_max_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="thetis.turbulence.set_func_min_val">
<code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">set_func_min_val</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">minval</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_min_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_min_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="thetis.turbulence.timed_region">
<code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.turbulence.timed_stage">
<code class="sig-prename descclassname">thetis.turbulence.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-thetis.utility">
<span id="thetis-utility-module"></span><h2>thetis.utility module<a class="headerlink" href="#module-thetis.utility" title="Permalink to this headline">¶</a></h2>
<p>Utility functions and classes for 3D hydrostatic ocean model</p>
<dl class="py class">
<dt id="thetis.utility.ALEMeshUpdater">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">ALEMeshUpdater</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class that handles vertically moving ALE mesh</p>
<p>Mesh geometry is updated to match the elevation field
(<code class="docutils literal notranslate"><span class="pre">solver.fields.elev_2d</span></code>). First the discontinuous elevation field is
projected to continuous space, and this field is used to update the mesh
coordinates.</p>
<p>This class stores the reference coordinate field and keeps track of the
updated mesh coordinates. It also provides a method for computing the mesh
velocity from two adjacent elevation fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.ALEMeshUpdater.compute_mesh_velocity_begin">
<code class="sig-name descname">compute_mesh_velocity_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.compute_mesh_velocity_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.compute_mesh_velocity_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the current 2D elevation state as the “old” field</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.ALEMeshUpdater.compute_mesh_velocity_finalize">
<code class="sig-name descname">compute_mesh_velocity_finalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">w_mesh_surf_expr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.compute_mesh_velocity_finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.compute_mesh_velocity_finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mesh velocity from the elevation difference</p>
<p>Stores the current 2D elevation state as the “new” field,
and computes w_mesh using the given time step factor <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.ALEMeshUpdater.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set values for initial mesh (elevation at rest)</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.ALEMeshUpdater.update_elem_height">
<code class="sig-name descname">update_elem_height</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.update_elem_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.update_elem_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates vertical element size fields</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.ALEMeshUpdater.update_mesh_coordinates">
<code class="sig-name descname">update_mesh_coordinates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.update_mesh_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.update_mesh_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates 3D mesh coordinates to match current elev_2d field</p>
<p>elev_2d is first projected to continous space</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.AttrDict">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">AttrDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#AttrDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.AttrDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both self[‘key’] and self.key access to members.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python</a></p>
</dd></dl>

<dl class="py class">
<dt id="thetis.utility.DensitySolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">DensitySolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">salinity</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">density</span></em>, <em class="sig-param"><span class="n">eos_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Water density is defined as</p>
<div class="math notranslate nohighlight">
\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>This method computes the density anomaly <span class="math notranslate nohighlight">\(\rho'\)</span>.</p>
<p>Density is computed point-wise assuming that temperature, salinity and
density are in the same function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>salinity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water salinity field</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water temperature field</p></li>
<li><p><strong>density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eos_class</strong> (<a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a>) – equation of state that defines water density</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.DensitySolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.DensitySolverWeak">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">DensitySolverWeak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">salinity</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">density</span></em>, <em class="sig-param"><span class="n">eos_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolverWeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolverWeak" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Water density is defined as</p>
<div class="math notranslate nohighlight">
\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>This method computes the density anomaly <span class="math notranslate nohighlight">\(\rho'\)</span>.</p>
<p>Density is computed in a weak sense by projecting the analytical expression
on the density field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>salinity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water salinity field</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water temperature field</p></li>
<li><p><strong>density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eos_class</strong> (<a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a>) – equation of state that defines water density</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.DensitySolverWeak.ensure_positive_salinity">
<code class="sig-name descname">ensure_positive_salinity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolverWeak.ensure_positive_salinity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolverWeak.ensure_positive_salinity" title="Permalink to this definition">¶</a></dt>
<dd><p>make sure salinity is not negative</p>
<p>some EOS depend on sqrt(salt).</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.DensitySolverWeak.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolverWeak.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolverWeak.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.DepthExpression">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">DepthExpression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bathymetry_2d</span></em>, <em class="sig-param"><span class="n">use_nonlinear_equations</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_wetting_and_drying</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">wetting_and_drying_alpha</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DepthExpression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Construct expression for depth depending on options</p>
<dl class="simple">
<dt>If <cite>not use_nonlinear_equations</cite>, then the depth is simply the bathymetry:</dt><dd><p><span class="math notranslate nohighlight">\(H = h\)</span></p>
</dd>
<dt>Otherwise we include the free surface elevation:</dt><dd><p><span class="math notranslate nohighlight">\(H = h + \eta\)</span></p>
</dd>
</dl>
<p>and if <cite>use_wetting_and_drying</cite>, includes a bathymetry displacement term
to ensure a positive depth (see Karna et al. 2011):</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(H = h + f(h+\eta) + \eta\)</span></p>
</div></blockquote>
<dl class="simple">
<dt>where</dt><dd><p><span class="math notranslate nohighlight">\(f(h+\eta) = (\sqrt{(h+\eta)^2 +\alpha^2} - (h+\eta))/2\)</span></p>
</dd>
</dl>
<p>This introduces a wetting-drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>, with dimensions
of length. The value for <span class="math notranslate nohighlight">\(\alpha\)</span> is specified by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code>, in units of meters. The
default value is 0.5, but the appropriate value is problem specific and
should be set by the user.</p>
<dl class="py method">
<dt id="thetis.utility.DepthExpression.get_total_depth">
<code class="sig-name descname">get_total_depth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression.get_total_depth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DepthExpression.get_total_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total water column depth based on options
:arg eta: current elevation as UFL expression</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.DepthExpression.wd_bathymetry_displacement">
<code class="sig-name descname">wd_bathymetry_displacement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression.wd_bathymetry_displacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DepthExpression.wd_bathymetry_displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns wetting and drying bathymetry displacement as described in:
Karna et al.,  2011.
:arg eta: current elevation as UFL expression</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.ElementContinuity">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">ElementContinuity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">horizontal</span></em>, <em class="sig-param"><span class="n">vertical</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.ElementContinuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>A named tuple describing the continuity of an element in the horizontal/vertical direction.</p>
<p>The field value is one of “cg”, “hdiv”, or “dg”.</p>
<dl class="py method">
<dt id="thetis.utility.ElementContinuity.horizontal">
<em class="property">property </em><code class="sig-name descname">horizontal</code><a class="headerlink" href="#thetis.utility.ElementContinuity.horizontal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.ElementContinuity.vertical">
<em class="property">property </em><code class="sig-name descname">vertical</code><a class="headerlink" href="#thetis.utility.ElementContinuity.vertical" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.EquationOfState">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">EquationOfState</code><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class of all equation of state objects</p>
<dl class="py method">
<dt id="thetis.utility.EquationOfState.compute_rho">
<em class="property">abstract </em><code class="sig-name descname">compute_rho</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius, referenced to pressure
p_r = 0 dbar.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>All pressures are gauge pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.EquationOfState.eval">
<em class="property">abstract </em><code class="sig-name descname">eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState.eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.ExpandFunctionTo3d">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">ExpandFunctionTo3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_2d</span></em>, <em class="sig-param"><span class="n">output_3d</span></em>, <em class="sig-param"><span class="n">elem_height</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Copy a 2D field to 3D</p>
<p>Copies a field from 2D mesh to 3D mesh, assigning the same value over the
vertical dimension. Horizontal function spaces must be the same.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">ExpandFunctionTo3d</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">func3d</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 2D source field</p></li>
<li><p><strong>output_3d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 3D target field</p></li>
<li><p><strong>elem_height</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> in 3D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.ExpandFunctionTo3d.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.ExtrudedFunction">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">ExtrudedFunction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">mesh_3d</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExtrudedFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExtrudedFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a></p>
<p>A 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that provides a 3D view on the extruded domain.</p>
<p>The 3D function can be accessed as <cite>ExtrudedFunction.view_3d</cite>.
The 3D function resides in V x R function space, where V is the function
space of the source function. The 3D function shares the data of the 2D
function.</p>
<p>Create a 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> with a 3D view on extruded mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mesh_3d</strong> – Extruded 3D mesh where the function will be extended to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="thetis.utility.FieldDict">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">FieldDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#FieldDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FieldDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.utility.AttrDict</span></code></a></p>
<p>AttrDict that checks that all added fields have proper meta data.</p>
<p>Values can be either Function or Constant objects.</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.utility.FrozenClass">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">FrozenClass</code><a class="reference internal" href="_modules/thetis/utility.html#FrozenClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FrozenClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class where creating a new attribute will raise an exception if _isfrozen == True</p>
</dd></dl>

<dl class="py class">
<dt id="thetis.utility.JackettEquationOfState">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">JackettEquationOfState</code><a class="reference internal" href="_modules/thetis/utility.html#JackettEquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.JackettEquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.utility.EquationOfState</span></code></a></p>
<p>Equation of State according of Jackett et al. (2006) for computing sea
water density.</p>
<div class="math notranslate nohighlight" id="equation-equation-of-state">
<span class="eqno">(18)<a class="headerlink" href="#equation-equation-of-state" title="Permalink to this equation">¶</a></span>\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p><span class="math notranslate nohighlight">\(\rho'(T, S, p)\)</span> is a nonlinear rational function.</p>
<p>Jackett et al. (2006). Algorithms for Density, Potential Temperature,
Conservative Temperature, and the Freezing Temperature of Seawater.
Journal of Atmospheric and Oceanic Technology, 23(12):1709-1728.
<a class="reference external" href="http://dx.doi.org/10.1175/JTECH1946.1">http://dx.doi.org/10.1175/JTECH1946.1</a></p>
<dl class="py attribute">
<dt id="thetis.utility.JackettEquationOfState.a">
<code class="sig-name descname">a</code><em class="property"> = array([ 9.99840854e+02,  7.34716259e+00, -5.32112318e-02,  3.64924391e-04,         2.58805710e+00, -6.71682828e-03,  1.92032021e-03,  1.17982637e-02,         9.89202193e-08,  4.69966428e-06, -2.58621871e-08, -3.29214140e-12])</em><a class="headerlink" href="#thetis.utility.JackettEquationOfState.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="thetis.utility.JackettEquationOfState.b">
<code class="sig-name descname">b</code><em class="property"> = array([ 1.00000000e+00,  7.28152101e-03, -4.47872655e-05,  3.38510030e-07,         1.36512024e-10,  1.76321267e-03, -8.80665833e-06, -1.88326894e-10,         5.74637767e-06,  1.47162755e-09,  6.71032463e-06, -2.44616980e-17,        -9.15344176e-18])</em><a class="headerlink" href="#thetis.utility.JackettEquationOfState.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="thetis.utility.JackettEquationOfState.compute_rho">
<code class="sig-name descname">compute_rho</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#JackettEquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.JackettEquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius, referenced to pressure
p_r = 0 dbar.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>All pressures are gauge pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.JackettEquationOfState.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#JackettEquationOfState.eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.JackettEquationOfState.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.LinearEquationOfState">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">LinearEquationOfState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rho_ref</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">th_ref</span></em>, <em class="sig-param"><span class="n">s_ref</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.utility.EquationOfState</span></code></a></p>
<p>Linear Equation of State for computing sea water density</p>
<div class="math notranslate nohighlight">
\[\rho = \rho_{ref} - \alpha (T - T_{ref}) + \beta (S - S_{ref})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference density</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – thermal expansion coefficient</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – haline contraction coefficient</p></li>
<li><p><strong>th_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference temperature</p></li>
<li><p><strong>s_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference salinity</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.LinearEquationOfState.compute_rho">
<code class="sig-name descname">compute_rho</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>Pressure is ingored in this equation of state.</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.LinearEquationOfState.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">th</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">rho0</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState.eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.Mesh3DConsistencyCalculator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">Mesh3DConsistencyCalculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver_obj</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#Mesh3DConsistencyCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.Mesh3DConsistencyCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes a hydrostatic consistency criterion metric on the 3D mesh.</p>
<p>Let <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta z\)</span> denote the horizontal and vertical
element sizes. The hydrostatic consistency criterion (HCC) can then be
expressed as</p>
<div class="math notranslate nohighlight">
\[R = \frac{|\nabla h| \Delta x}{\Delta z} &lt; 1\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla h\)</span> is the bathymetry gradient (or gradient of the
internal horizontal facet).</p>
<p>Violating the hydrostatic consistency criterion leads to internal pressure
gradient errors.
In practice one can violate the <span class="math notranslate nohighlight">\(R &lt; 1\)</span> condition without
jeopardizing numerical stability; typically <span class="math notranslate nohighlight">\(R &lt; 5\)</span>.
Mesh consistency can be improved by coarsening the vertical
mesh, refining the horizontal mesh, or smoothing the bathymetry.</p>
<p>For a 3D prism, let <span class="math notranslate nohighlight">\(\delta z_t,\delta z_b\)</span> denote the maximal
<span class="math notranslate nohighlight">\(z\)</span> coordinate difference in the surface and bottom facets,
respectively, and <span class="math notranslate nohighlight">\(\Delta z\)</span> the height of the prism.
We can then compute <span class="math notranslate nohighlight">\(R\)</span> for the two facets as</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_t &amp;= \frac{\delta z_t}{\Delta z} \\
R_b &amp;= \frac{\delta z_b}{\Delta z}\end{split}\]</div>
<p>For a straight prism we have <span class="math notranslate nohighlight">\(R = 0\)</span>, and <span class="math notranslate nohighlight">\(R = 1\)</span> in
the case where the highest bottom node is at the same level as the lowest
surface node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver_obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.Mesh3DConsistencyCalculator.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#Mesh3DConsistencyCalculator.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.Mesh3DConsistencyCalculator.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the HCC metric</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.SmagorinskyViscosity">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">SmagorinskyViscosity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">output</span></em>, <em class="sig-param"><span class="n">c_s</span></em>, <em class="sig-param"><span class="n">h_elem_size</span></em>, <em class="sig-param"><span class="n">max_val</span></em>, <em class="sig-param"><span class="n">min_val</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">weak_form</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes Smagorinsky subgrid scale horizontal viscosity</p>
<p>This formulation is according to Ilicak et al. (2012) and
Griffies and Hallberg (2000).</p>
<div class="math notranslate nohighlight">
\[\nu = (C_s \Delta x)^2 |S|\]</div>
<p>with the deformation rate</p>
<div class="math notranslate nohighlight">
\[\begin{split}|S| &amp;= \sqrt{D_T^2 + D_S^2} \\
D_T &amp;= \frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} \\
D_S &amp;= \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\Delta x\)</span> is the horizontal element size and <span class="math notranslate nohighlight">\(C_s\)</span> is the
Smagorinsky coefficient.</p>
<p>To match a certain mesh Reynolds number <span class="math notranslate nohighlight">\(Re_h\)</span> set
<span class="math notranslate nohighlight">\(C_s = 1/\sqrt{Re_h}\)</span>.</p>
<p>Ilicak et al. (2012). Spurious dianeutral mixing and the role of
momentum closure. Ocean Modelling, 45-46(0):37-58.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2011.10.003">http://dx.doi.org/10.1016/j.ocemod.2011.10.003</a></p>
<p>Griffies and Hallberg (2000). Biharmonic friction with a
Smagorinsky-like viscosity for use in large-scale eddy-permitting
ocean models. Monthly Weather Review, 128(8):2935-2946.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv_3d</strong> (3D vector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity</p></li>
<li><p><strong>output</strong> (3D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Smagorinsky viscosity field</p></li>
<li><p><strong>c_s</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – Smagorinsky coefficient</p></li>
<li><p><strong>h_elem_size</strong> (3D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – field that defines the horizontal element size</p></li>
<li><p><strong>max_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Maximum allowed viscosity. Viscosity will be clipped at
this value.</p></li>
<li><p><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Minimum allowed viscosity. Viscosity will be clipped at
this value.</p></li>
<li><p><strong>weak_form</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Compute velocity shear by integrating by parts.
Necessary for some function spaces (e.g. P0).</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.SmagorinskyViscosity.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute viscosity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.SubFunctionExtractor">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">SubFunctionExtractor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_3d</span></em>, <em class="sig-param"><span class="n">output_2d</span></em>, <em class="sig-param"><span class="n">boundary</span><span class="o">=</span><span class="default_value">'top'</span></em>, <em class="sig-param"><span class="n">elem_facet</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elem_height</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Extract a 2D sub-function from a 3D function in an extruded mesh</p>
<p>Given 2D and 3D functions,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
<p>Get surface value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get bottom value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get value at the top of bottom element:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_3d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 3D source field</p></li>
<li><p><strong>output_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 2D target field</p></li>
<li><p><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’|’bottom’
Defines whether to extract from the surface or bottom 3D elements</p></li>
<li><p><strong>elem_facet</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’|’bottom’|’average’
Defines which facet of the 3D element is extracted. The ‘average’
computes mean of the top and bottom facets of the 3D element.</p></li>
<li><p><strong>elem_height</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> in 2D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.SubFunctionExtractor.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.SubdomainProjector">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">SubdomainProjector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">v_out</span></em>, <em class="sig-param"><span class="n">subdomain_id</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constant_jacobian</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubdomainProjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubdomainProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Projector that projects the restriction of an expression to the specified subdomain.</p>
<dl class="py method">
<dt id="thetis.utility.SubdomainProjector.project">
<code class="sig-name descname">project</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubdomainProjector.project"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubdomainProjector.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the projection.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.SumFunction">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">SumFunction</code><a class="reference internal" href="_modules/thetis/utility.html#SumFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helper class to keep track of sum of Coefficients.</p>
<p>Initialize empty sum.</p>
<p>get operation returns Constant(0)</p>
<dl class="py method">
<dt id="thetis.utility.SumFunction.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a coefficient to self</p>
</dd></dl>

<dl class="py method">
<dt id="thetis.utility.SumFunction.get_sum">
<code class="sig-name descname">get_sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.get_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.get_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sum of all added Coefficients</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.VelocityMagnitudeSolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">VelocityMagnitudeSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">u</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_val</span><span class="o">=</span><span class="default_value">1e-06</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes magnitude of (u[0],u[1],w) and stores it in solution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – scalar field for velocity magnitude scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>u</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity</p></li>
<li><p><strong>w</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – vertical velocity</p></li>
<li><p><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value of magnitude. Minimum value of solution
will be clipped to this value</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">u</span></code> is None computes magnitude of (0,0,w).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">w</span></code> is None computes magnitude of (u[0],u[1],0).</p>
<dl class="py method">
<dt id="thetis.utility.VelocityMagnitudeSolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the magnitude</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.VerticalIntegrator">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">VerticalIntegrator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="n">output</span></em>, <em class="sig-param"><span class="n">bottom_to_top</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">bnd_value</span><span class="o">=</span><span class="default_value">Constant(FiniteElement('Real', None, 0), 5)</span></em>, <em class="sig-param"><span class="n">average</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">bathymetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elevation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical integral (or average) of a field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – 3D field to integrate</p></li>
<li><p><strong>output</strong> – 3D field where the integral is stored</p></li>
<li><p><strong>bottom_to_top</strong> – Defines the integration direction: If True integration is performed along the z axis, from bottom surface to top surface.</p></li>
<li><p><strong>bnd_value</strong> – Value of the integral at the bottom (top) boundary if bottom_to_top is True (False)</p></li>
<li><p><strong>average</strong> – If True computes the vertical average instead. Requires bathymetry and elevation fields</p></li>
<li><p><strong>bathymetry</strong> – 3D field defining the bathymetry</p></li>
<li><p><strong>elevation</strong> – 3D field defining the free surface elevation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.VerticalIntegrator.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the integral and stores it in the output field.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="thetis.utility.VerticalVelocitySolver">
<em class="property">class </em><code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">VerticalVelocitySolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solution</span></em>, <em class="sig-param"><span class="n">uv</span></em>, <em class="sig-param"><span class="n">bathymetry</span></em>, <em class="sig-param"><span class="n">boundary_funcs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical velocity diagnostically from the continuity equation</p>
<p>Vertical velocity is obtained from the continuity equation</p>
<div class="math notranslate nohighlight" id="equation-continuity-eq-3d">
<span class="eqno">(19)<a class="headerlink" href="#equation-continuity-eq-3d" title="Permalink to this equation">¶</a></span>\[\frac{\partial w}{\partial z} = -\nabla_h \cdot \textbf{u}\]</div>
<p>and the bottom impermeability condition (<span class="math notranslate nohighlight">\(h\)</span> denotes the bathymetry)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textbf{n}_h \cdot \textbf{u} + w n_z &amp;= 0 \quad \forall \mathbf{x} \in \Gamma_{b} \\
\Leftrightarrow w &amp;= -\nabla_h h \cdot \mathbf{u} \quad \forall \mathbf{x} \in \Gamma_{b}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(w\)</span> can be solved with the weak form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_{\Gamma_s} w n_z \varphi dS
+ \int_{\mathcal{I}_h} \text{avg}(w) \text{jump}(\varphi n_z) dS
- \int_{\Omega} w \frac{\partial \varphi}{\partial z} dx
= \\
\int_{\Omega} \mathbf{u} \cdot \nabla_h \varphi dx
- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{avg}(\mathbf{u}) \cdot \text{jump}(\varphi \mathbf{n}_h) dS
- \int_{\Gamma_s} \mathbf{u} \cdot \varphi \mathbf{n}_h dS\end{split}\]</div>
<p>where the <span class="math notranslate nohighlight">\(\Gamma_b\)</span> terms vanish due to the bottom impermeability
condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – w <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>uv</strong> – horizontal velocity <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>bathymetry</strong> – bathymetry <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>boundary_funcs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – boundary conditions used in the 3D momentum
equation. Provides external values of uv (if any).</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="thetis.utility.VerticalVelocitySolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute w</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="thetis.utility.beta_plane_coriolis_function">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">beta_plane_coriolis_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">out_function</span></em>, <em class="sig-param"><span class="n">y_offset</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates beta plane Coriolis function to a field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – latitude in degrees</p></li>
<li><p><strong>out_function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where to interpolate</p></li>
<li><p><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – offset (y - y_0) used in Beta-plane approximation.
A constant in mesh coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.beta_plane_coriolis_params">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">beta_plane_coriolis_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes beta plane parameters <span class="math notranslate nohighlight">\(f_0,\beta\)</span> based on latitude</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – latitude in degrees</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>f_0, beta</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.comp_tracer_mass_2d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">comp_tracer_mass_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scalar_func</span></em>, <em class="sig-param"><span class="n">total_depth</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes total tracer mass in the 2D domain
:arg scalar_func: depth-averaged scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to integrate
:arg total_depth: scalar UFL expression (e.g. from get_total_depth())</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.comp_tracer_mass_3d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">comp_tracer_mass_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scalar_func</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes total tracer mass in the 3D domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scalar_func</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to integrate</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.comp_volume_2d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">comp_volume_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">bath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes volume of the 2D domain as an integral of the elevation field</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.comp_volume_3d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">comp_volume_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes volume of the 3D domain as an integral</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.compute_baroclinic_head">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">compute_baroclinic_head</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solver</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_baroclinic_head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_baroclinic_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the baroclinic head <span class="math notranslate nohighlight">\(r\)</span> from the density field</p>
<div class="math notranslate nohighlight">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.compute_boundary_length">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">compute_boundary_length</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_boundary_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_boundary_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the length of the boundary segments in given 2d mesh</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.compute_elem_height">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">compute_elem_height</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">zcoord</span></em>, <em class="sig-param"><span class="n">output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_elem_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_elem_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the element height on an extruded mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zcoord</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field that contains the z coordinates of the mesh</p></li>
<li><p><strong>output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field where element height is stored</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.create_directory">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">create_directory</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#create_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.create_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory on disk</p>
<p>Raises IOError if a file with the same name already exists.</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.element_continuity">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">element_continuity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ufl_element</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#element_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.element_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementContinuity</span></code></a> instance with the
continuity of a given element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ufl_element</strong> – The UFL element to determine the continuity
of.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementContinuity</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.extend_function_to_3d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">extend_function_to_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="n">mesh_extruded</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extend_function_to_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.extend_function_to_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 3D view of a 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> on the extruded domain.</p>
<p>The 3D function resides in V x R function space, where V is the function
space of the source function. The 3D function shares the data of the 2D
function.</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.extrude_mesh_sigma">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">extrude_mesh_sigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh2d</span></em>, <em class="sig-param"><span class="n">n_layers</span></em>, <em class="sig-param"><span class="n">bathymetry_2d</span></em>, <em class="sig-param"><span class="n">z_stretch_fact</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">min_depth</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extrude_mesh_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.extrude_mesh_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrudes a 2d surface mesh with bathymetry data defined in a 2d field.</p>
<p>Generates a uniform terrain following mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – 2D mesh</p></li>
<li><p><strong>n_layers</strong> – number of vertical layers</p></li>
<li><p><strong>bathymetry</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the bathymetry
(the depth of the domain; positive downwards)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_facet_areas">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_facet_areas</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_facet_areas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_facet_areas" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute area of each facet of <cite>mesh</cite>. The facet areas are stored as a HDiv trace field.</p>
<dl class="simple">
<dt>NOTES:</dt><dd><ul class="simple">
<li><p>In the 2D case, this gives edge lengths.</p></li>
<li><p>The plus sign is arbitrary and could equally well be chosen as minus.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_facet_mask">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_facet_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function_space</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'geometric'</span></em>, <em class="sig-param"><span class="n">facet</span><span class="o">=</span><span class="default_value">'bottom'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_facet_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_facet_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top/bottom nodes of extruded 3D elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Firedrake <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘topological’, to retrieve nodes that lie on the facet, or
‘geometric’ for nodes whose basis functions do not vanish on the facet.</p></li>
<li><p><strong>facet</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’ or ‘bottom’</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The definition of top/bottom depends on the direction of the extrusion.
Here we assume that the mesh has been extruded upwards (along positive
z axis).</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_functionspace">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_functionspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh</span></em>, <em class="sig-param"><span class="n">h_family</span></em>, <em class="sig-param"><span class="n">h_degree</span></em>, <em class="sig-param"><span class="n">v_family</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">v_degree</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vector</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hdiv</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">variant</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_functionspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_functionspace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_horizontal_elem_size_2d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_horizontal_elem_size_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sol2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sol2d</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where result is stored</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_horizontal_elem_size_3d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_horizontal_elem_size_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sol2d</span></em>, <em class="sig-param"><span class="n">sol3d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh, then copies it on a 3D
field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sol2d</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> for the element size field</p></li>
<li><p><strong>sol3d</strong> – 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> for the element size field</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_minimum_angles_2d">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_minimum_angles_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh2d</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_minimum_angles_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_minimum_angles_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum angle in each element of a triangular mesh, <cite>mesh2d</cite>, using the
cosine rule. The minimum angles are outputted as a P0 field.</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_sipg_ratio">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_sipg_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nu</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_sipg_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_sipg_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ratio between the maximum of <cite>nu</cite> and the minimum of <cite>nu</cite> in each element. If <cite>nu</cite>
is P0 or a <cite>Constant</cite> then the resulting ratio is unity in each element. If <cite>nu</cite> varies linearly
in each element then the ratios are outputted as a P0 field.</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.get_zcoord_from_mesh">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">get_zcoord_from_mesh</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">zcoord</span></em>, <em class="sig-param"><span class="n">solver_parameters</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_zcoord_from_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_zcoord_from_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates z coordinates from the 3D mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zcoord</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where coordinates will be stored</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.select_and_move_detectors">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">select_and_move_detectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mesh</span></em>, <em class="sig-param"><span class="n">detector_locations</span></em>, <em class="sig-param"><span class="n">detector_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">maximum_distance</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#select_and_move_detectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.select_and_move_detectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Select those detectors that are within the domain and/or move them to
the nearest cell centre within the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – Defines the domain in which detectors are to be located</p></li>
<li><p><strong>detector_locations</strong> – List of x, y locations</p></li>
<li><p><strong>detector_names</strong> – List of detector names (optional). If provided, a list
of selected locations and a list of selected detector names are returned,
otherwise only a list of selected locations is returned</p></li>
<li><p><strong>maximum_distance</strong> – Detectors whose initial locations is outside the domain,
but for which the nearest cell centre is within the specified distance, are
moved to this location. By default a maximum distance of 0.0 is used, i.e
no detectors are moved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.tensor_jump">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">tensor_jump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#tensor_jump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.tensor_jump" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump term for vector functions based on the tensor product</p>
<div class="math notranslate nohighlight">
\[\text{jump}(\mathbf{u}, \mathbf{n}) = (\mathbf{u}^+ \mathbf{n}^+) +
(\mathbf{u}^- \mathbf{n}^-)\]</div>
<p>This is the discrete equivalent of grad(u) as opposed to the
vectorial UFL jump operator <code class="xref py py-meth docutils literal notranslate"><span class="pre">ufl.jump()</span></code> which represents div(u).</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.timed_region">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.utility.timed_stage">
<code class="sig-prename descclassname">thetis.utility.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-thetis" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="thetis.timed_region">
<code class="sig-prename descclassname">thetis.</code><code class="sig-name descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt id="thetis.timed_stage">
<code class="sig-prename descclassname">thetis.</code><code class="sig-name descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2020, Tuomas Karna et al..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>