<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>thetis package &mdash; Thetis 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Thetis 1.0 documentation" href="index.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head>
  <body role="document">
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" height="200px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Documentation for Firedrake">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Obtain the firedrake code">Download</a></li>
        <li class="page_item"><a href="team.html" title="The guilty parties">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="GitHub">GitHub</a></li>
        <li class="page_item"><a href="https://travis-ci.org/thetisproject/thetis" title="Travis">Travis</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="thetis">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="thetis-package">
<h1>thetis package<a class="headerlink" href="#thetis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thetis.callback">
<span id="thetis-callback-module"></span><h2>thetis.callback module<a class="headerlink" href="#module-thetis.callback" title="Permalink to this headline">¶</a></h2>
<p>Callback functions used to compute metrics at runtime.</p>
<p>Tuomas Karna 2016-01-28</p>
<dl class="class">
<dt id="thetis.callback.CallbackManager">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">CallbackManager</code><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/collections.html#collections.defaultdict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">collections.defaultdict</span></code></a></p>
<p>Stores callbacks in different categories and provides methods for
evaluating them.</p>
<dl class="method">
<dt id="thetis.callback.CallbackManager.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>callback</em>, <em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.callback.CallbackManager.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.DiagnosticCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">DiagnosticCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=True</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A base class for all Callback classes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outputdir</strong> &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> &#8211; If True, diagnostics will be stored in hdf5 format</li>
<li><strong>append_to_log</strong> &#8211; If True, diagnostic will be printed in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf stream</p>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> &#8211; If provided, these will be the return value from <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.callback.DiagnosticCallback.name">
<code class="descname">name</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.push_to_hdf5">
<code class="descname">push_to_hdf5</code><span class="sig-paren">(</span><em>time</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_hdf5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Append values to export file.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.push_to_log">
<code class="descname">push_to_log</code><span class="sig-paren">(</span><em>time</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Print diagnostic status message to log</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.callback.DiagnosticCallback.variable_names">
<code class="descname">variable_names</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.DiagnosticHDF5">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">DiagnosticHDF5</code><span class="sig-paren">(</span><em>filename</em>, <em>varnames</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Creates hdf5 files for diagnostic time series arrays.</p>
<dl class="method">
<dt id="thetis.callback.DiagnosticHDF5.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>time</em>, <em>variables</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new entry of (time, variables) to the file</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.MinMaxConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">MinMaxConservationCallback</code><span class="sig-paren">(</span><em>minmax_callback</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a minimum/maximum</p>
<dl class="method">
<dt id="thetis.callback.MinMaxConservationCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.callback.MinMaxConservationCallback.variable_names">
<code class="descname">variable_names</code><em class="property"> = ['min_value', 'max_value', 'undershoot', 'overshoot']</em><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.ScalarConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">ScalarConservationCallback</code><span class="sig-paren">(</span><em>scalar_callback</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a scalar quantity</p>
<dl class="method">
<dt id="thetis.callback.ScalarConservationCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.callback.ScalarConservationCallback.variable_names">
<code class="descname">variable_names</code><em class="property"> = ['integral', 'relative_difference']</em><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.TracerMassConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">TracerMassConservationCallback</code><span class="sig-paren">(</span><em>tracer_name</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of total tracer mass</p>
<dl class="attribute">
<dt id="thetis.callback.TracerMassConservationCallback.name">
<code class="descname">name</code><em class="property"> = 'tracer mass'</em><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.TracerOvershootCallBack">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">TracerOvershootCallBack</code><span class="sig-paren">(</span><em>tracer_name</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerOvershootCallBack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.MinMaxConservationCallback" title="thetis.callback.MinMaxConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.MinMaxConservationCallback</span></code></a></p>
<p>Checks overshoots of the given tracer field.</p>
<dl class="attribute">
<dt id="thetis.callback.TracerOvershootCallBack.name">
<code class="descname">name</code><em class="property"> = 'tracer overshoot'</em><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.VolumeConservation2DCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">VolumeConservation2DCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation2DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 3D volume (volume of 3D mesh)</p>
<dl class="attribute">
<dt id="thetis.callback.VolumeConservation2DCallback.name">
<code class="descname">name</code><em class="property"> = 'volume2d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.VolumeConservation3DCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">VolumeConservation3DCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation3DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 3D volume (volume of 3D mesh)</p>
<dl class="attribute">
<dt id="thetis.callback.VolumeConservation3DCallback.name">
<code class="descname">name</code><em class="property"> = 'volume3d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.callback.timed_region">
<code class="descclassname">thetis.callback.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.callback.timed_stage">
<code class="descclassname">thetis.callback.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.coupled_timeintegrator">
<span id="thetis-coupled-timeintegrator-module"></span><h2>thetis.coupled_timeintegrator module<a class="headerlink" href="#module-thetis.coupled_timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Time integrators for solving coupled 2D-3D-tracer equations.</p>
<p>Tuomas Karna 2015-07-06</p>
<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledSSPIMEX">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledSSPIMEX</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPIMEX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPIMEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Solves coupled 3D equations with SSP IMEX scheme by [1], method (17).</p>
<p>With this scheme all the equations can be advanced in time synchronously.</p>
<dl class="docutils">
<dt>[1] Higueras et al (2014). Optimized strong stability preserving IMEX</dt>
<dd>Runge-Kutta methods. Journal of Computational and Applied
Mathematics 272(2014) 116-140.</dd>
</dl>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPIMEX.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPIMEX.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPIMEX.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPIMEX.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPIMEX.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPIMEX.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledSSPRKSemiImplicit</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Solves coupled equations with simultaneous SSPRK33 stages, where 2d gravity
waves are solved semi-implicitly. This saves CPU cos diffuses gravity waves.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSemiImplicit.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSemiImplicit.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSingleMode">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledSSPRKSingleMode</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSingleMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSingleMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Split-explicit SSPRK33 solver without mode-splitting.
Both 2D and 3D modes are advanced with the same time step, computed based on 2D gravity
wave speed. This time integrator is therefore expensive and should be only used for debugging etc.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSingleMode.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSingleMode.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSingleMode.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSingleMode.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSingleMode.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSingleMode.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSync">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledSSPRKSync</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSync"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSync" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Split-explicit SSPRK time integrator that sub-iterates 2D mode.
3D time step is computed based on horizontal velocity. 2D mode is sub-iterated and hence has
very little numerical diffusion.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSync.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSync.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSync.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSync.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSync.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSync.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledTimeIntegrator</code><span class="sig-paren">(</span><em>solver</em>, <em>options</em>, <em>fields</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Base class for coupled time integrators</p>
</dd></dl>

<dl class="function">
<dt id="thetis.coupled_timeintegrator.timed_region">
<code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.coupled_timeintegrator.timed_stage">
<code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.equation">
<span id="thetis-equation-module"></span><h2>thetis.equation module<a class="headerlink" href="#module-thetis.equation" title="Permalink to this headline">¶</a></h2>
<p>Implements Equation and Term classes.</p>
<dl class="class">
<dt id="thetis.equation.Equation">
<em class="property">class </em><code class="descclassname">thetis.equation.</code><code class="descname">Equation</code><span class="sig-paren">(</span><em>function_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Implements an equation, made out of terms.</p>
<dl class="attribute">
<dt id="thetis.equation.Equation.SUPPORTED_LABELS">
<code class="descname">SUPPORTED_LABELS</code><em class="property"> = ['source', 'explicit', 'implicit', 'nonlinear']</em><a class="headerlink" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.add_term">
<code class="descname">add_term</code><span class="sig-paren">(</span><em>term</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.add_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.add_term" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.jacobian">
<code class="descname">jacobian</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian by summing up all the Jacobians of the terms.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.label_term">
<code class="descname">label_term</code><span class="sig-paren">(</span><em>key</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.label_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.label_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Assings a label to the given term(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>term</strong> &#8211; <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">Term</span></code></a> object, or a tuple of terms</li>
<li><strong>label</strong> &#8211; string label to assign</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.mass_term">
<code class="descname">mass_term</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.mass_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.mass_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Default mass matrix term for the used solution function space.</p>
<p>Can be overloaded in derived classes if needed.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.select_terms">
<code class="descname">select_terms</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.select_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.select_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator function that selects terms by label(s).
label can be a single label (e.g. &#8216;explicit&#8217;), &#8216;all&#8217; or a tuple of labels</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.equation.Term">
<em class="property">class </em><code class="descclassname">thetis.equation.</code><code class="descname">Term</code><span class="sig-paren">(</span><em>function_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Implements a single term of an equation.</p>
<dl class="method">
<dt id="thetis.equation.Term.jacobian">
<code class="descname">jacobian</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian of the term.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Term.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.equation.timed_region">
<code class="descclassname">thetis.equation.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.equation.timed_stage">
<code class="descclassname">thetis.equation.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.exporter">
<span id="thetis-exporter-module"></span><h2>thetis.exporter module<a class="headerlink" href="#module-thetis.exporter" title="Permalink to this headline">¶</a></h2>
<p>Routines for handling file exports.</p>
<p>Tuomas Karna 2015-07-06</p>
<dl class="class">
<dt id="thetis.exporter.ExportManager">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">ExportManager</code><span class="sig-paren">(</span><em>outputdir</em>, <em>fields_to_export</em>, <em>functions</em>, <em>field_metadata</em>, <em>export_type='vtk'</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Handles a list of file exporter objects</p>
<dl class="method">
<dt id="thetis.exporter.ExportManager.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExportManager.export_bathymetry">
<code class="descname">export_bathymetry</code><span class="sig-paren">(</span><em>bathymetry_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export_bathymetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export_bathymetry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExportManager.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the correct export index to all child exporters</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.ExporterBase">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">ExporterBase</code><span class="sig-paren">(</span><em>filename</em>, <em>outputdir</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base class for exporter objects.</p>
<dl class="method">
<dt id="thetis.exporter.ExporterBase.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.export" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExporterBase.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.HDF5Exporter">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">HDF5Exporter</code><span class="sig-paren">(</span><em>function_space</em>, <em>outputdir</em>, <em>filename_prefix</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Stores fields in disk in native discretization using HDF5 containers</p>
<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the given function to disk.
Increments previous export index by 1.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.export_as_index">
<code class="descname">export_as_index</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export_as_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export_as_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the given function to disk using the specified export
index number.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.gen_filename">
<code class="descname">gen_filename</code><span class="sig-paren">(</span><em>iexport</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.gen_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.gen_filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads nodal values from disk and assigns to the given function.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.NaiveFieldExporter">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">NaiveFieldExporter</code><span class="sig-paren">(</span><em>function_space</em>, <em>outputdir</em>, <em>filename_prefix</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#NaiveFieldExporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.NaiveFieldExporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Exports function nodal values to disk in numpy binary format.</p>
<p>Works for simple Pn and PnDG fields.</p>
<dl class="method">
<dt id="thetis.exporter.NaiveFieldExporter.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#NaiveFieldExporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.NaiveFieldExporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the given function to disk.
Increments previous export index by 1.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.NaiveFieldExporter.export_as_index">
<code class="descname">export_as_index</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#NaiveFieldExporter.export_as_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.NaiveFieldExporter.export_as_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the given function to disk using the specified export
index number.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.NaiveFieldExporter.gen_filename">
<code class="descname">gen_filename</code><span class="sig-paren">(</span><em>iexport</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#NaiveFieldExporter.gen_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.NaiveFieldExporter.gen_filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.exporter.NaiveFieldExporter.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#NaiveFieldExporter.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.NaiveFieldExporter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads nodal values from disk and assigns to the given function.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.VTKExporter">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">VTKExporter</code><span class="sig-paren">(</span><em>fs_visu</em>, <em>func_name</em>, <em>outputdir</em>, <em>filename</em>, <em>next_export_ix=0</em>, <em>project_output=False</em>, <em>coords_dg=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Class that handles Paraview file exports.</p>
<dl class="method">
<dt id="thetis.exporter.VTKExporter.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports given function to disk.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.VTKExporter.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.exporter.get_visu_space">
<code class="descclassname">thetis.exporter.</code><code class="descname">get_visu_space</code><span class="sig-paren">(</span><em>fs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#get_visu_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.get_visu_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Figure out the appropriate linear visualization space for fs</p>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.is_2d">
<code class="descclassname">thetis.exporter.</code><code class="descname">is_2d</code><span class="sig-paren">(</span><em>fs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#is_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.is_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests wether a function space is 2d or 3d</p>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.timed_region">
<code class="descclassname">thetis.exporter.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.timed_stage">
<code class="descclassname">thetis.exporter.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.field_defs">
<span id="thetis-field-defs-module"></span><h2>thetis.field_defs module<a class="headerlink" href="#module-thetis.field_defs" title="Permalink to this headline">¶</a></h2>
<p>Definitions of fields.</p>
<p>Tuomas Karna 2015-10-17</p>
<dl class="data">
<dt id="thetis.field_defs.field_metadata">
<code class="descclassname">thetis.field_defs.</code><code class="descname">field_metadata</code><em class="property"> = {'v_elem_size_3d': {'shortname': 'Vertical element size', 'name': 'Element size in vertical direction', 'unit': 'm', 'filename': 'VElemSize3d'}, 'elev_cg_3d': {'shortname': 'Elevation', 'name': 'Water elevation CG', 'unit': 'm', 'filename': 'ElevationCG3d'}, 'density_3d': {'shortname': 'Density', 'name': 'Water density', 'unit': 'kg m-3', 'filename': 'Density3d'}, 'buoy_freq_3d': {'shortname': 'Buoyancy frequency squared', 'name': 'Buoyancy frequency squared', 'unit': 's-2', 'filename': 'BuoyFreq3d'}, 'eps_3d': {'shortname': 'TKE dissipation rate', 'name': 'TKE dissipation rate', 'unit': 'm2 s-2', 'filename': 'TurbEps3d'}, 'h_elem_size_2d': {'shortname': 'Horizontal element size', 'name': 'Element size in horizontal direction', 'unit': 'm', 'filename': 'h_elem_size_2d'}, 'w_mesh_ddz_3d': {'shortname': 'Vertical grad of mesh velocity', 'name': 'Vertical grad of mesh velocity', 'unit': 's-1', 'filename': 'd_mesh_velo_dz_3d'}, 'shear_freq_3d': {'shortname': 'Vertical shear frequency squared', 'name': 'Vertical shear frequency squared', 'unit': 's-2', 'filename': 'ShearFreq3d'}, 'baroc_head_3d': {'shortname': 'Baroclinic head', 'name': 'Baroclinic head', 'unit': 'm', 'filename': 'BaroHead3d'}, 'uv_mag_3d': {'shortname': 'Velocity magnitude', 'name': 'Magnitude of horizontal velocity', 'unit': 'm s-1', 'filename': 'VeloMag3d'}, 'uv_dav_2d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'DAVelocity2d'}, 'bathymetry_2d': {'shortname': 'Bathymetry', 'name': 'Bathymetry', 'unit': 'm', 'filename': 'bathymetry2d'}, 'elev_2d': {'shortname': 'Elevation', 'name': 'Water elevation', 'unit': 'm', 'filename': 'Elevation2d'}, 'z_coord_ref_3d': {'shortname': 'Z coordinates', 'name': 'Static mesh z coordinates', 'unit': 'm', 'filename': 'ZCoordRef3d'}, 'max_h_diff': {'shortname': 'Maximum horizontal diffusivity', 'name': 'Maximum stable horizontal diffusivity', 'unit': 'm2 s-1', 'filename': 'MaxHDiffusivity3d'}, 'bathymetry_3d': {'shortname': 'Bathymetry', 'name': 'Bathymetry', 'unit': 'm', 'filename': 'bathymetry3d'}, 'temp_3d': {'shortname': 'Temperature', 'name': 'Water temperature', 'unit': 'C', 'filename': 'Temperature3d'}, 'uv_dav_3d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'DAVelocity3d'}, 'z_coord_3d': {'shortname': 'Z coordinates', 'name': 'Mesh z coordinates', 'unit': 'm', 'filename': 'ZCoord3d'}, 'bottom_drag_2d': {'shortname': 'Bottom drag coefficient', 'name': 'Bottom drag coefficient', 'unit': '', 'filename': 'BottomDrag2d'}, 'len_3d': {'shortname': 'Turbulent length scale', 'name': 'Turbulent length scale', 'unit': 'm', 'filename': 'TurbLen3d'}, 'gjv_alpha_h_3d': {'shortname': 'GJV Parameter h', 'name': 'GJV Parameter h', 'unit': '', 'filename': 'GJVParamH'}, 'eddy_visc_3d': {'shortname': 'Eddy Viscosity', 'name': 'Eddy Viscosity', 'unit': 'm2 s-1', 'filename': 'EddyVisc3d'}, 'w_3d': {'shortname': 'Vertical velocity', 'name': 'Vertical velocity', 'unit': 'm s-1', 'filename': 'VertVelo3d'}, 'uv_bottom_3d': {'shortname': 'Bottom velocity', 'name': 'Bottom velocity', 'unit': 'm s-1', 'filename': 'BottomVelo3d'}, 'uv_3d': {'shortname': 'Horizontal velocity', 'name': 'Horizontal velocity', 'unit': 'm s-1', 'filename': 'Velocity3d'}, 'parab_visc_3d': {'shortname': 'Parabolic Viscosity', 'name': 'Parabolic Viscosity', 'unit': 'm2 s-1', 'filename': 'ParabVisc3d'}, 'h_elem_size_3d': {'shortname': 'Horizontal element size', 'name': 'Element size in horizontal direction', 'unit': 'm', 'filename': 'h_elem_size_3d'}, 'uv_p1_3d': {'shortname': 'P1 Velocity', 'name': 'P1 projection of horizontal velocity', 'unit': 'm s-1', 'filename': 'VeloCG3d'}, 'v_elem_size_2d': {'shortname': 'Vertical element size', 'name': 'Element size in vertical direction', 'unit': 'm', 'filename': 'VElemSize2d'}, 'salt_jump_diff': {'shortname': 'Salt Jump Diffusivity', 'name': 'Salt Jump Diffusivity', 'unit': 'm2 s-1', 'filename': 'SaltJumpDiff3d'}, 'coriolis_2d': {'shortname': 'Coriolis parameter', 'name': 'Coriolis parameter', 'unit': 's-1', 'filename': 'coriolis_2d'}, 'w_mesh_3d': {'shortname': 'Mesh velocity', 'name': 'Mesh velocity', 'unit': 'm s-1', 'filename': 'MeshVelo3d'}, 'baroc_head_2d': {'shortname': 'Dav baroclinic head', 'name': 'Depth averaged baroclinic head', 'unit': 'm', 'filename': 'BaroHead2d'}, 'coriolis_3d': {'shortname': 'Coriolis parameter', 'name': 'Coriolis parameter', 'unit': 's-1', 'filename': 'coriolis_3d'}, 'eddy_diff_3d': {'shortname': 'Eddy diffusivity', 'name': 'Eddy diffusivity', 'unit': 'm2 s-1', 'filename': 'EddyDiff3d'}, 'elev_3d': {'shortname': 'Elevation', 'name': 'Water elevation', 'unit': 'm', 'filename': 'Elevation3d'}, 'z_bottom_2d': {'shortname': 'Bottom cell z coordinates', 'name': 'Bottom cell z coordinates', 'unit': 'm', 'filename': 'ZBottom2d'}, 'gjv_alpha_v_3d': {'shortname': 'GJV Parameter v', 'name': 'GJV Parameter v', 'unit': '', 'filename': 'GJVParamV'}, 'salt_3d': {'shortname': 'Salinity', 'name': 'Water salinity', 'unit': 'psu', 'filename': 'Salinity3d'}, 'uv_bottom_2d': {'shortname': 'Bottom velocity', 'name': 'Bottom velocity', 'unit': 'm s-1', 'filename': 'BottomVelo2d'}, 'psi_3d': {'shortname': 'Turbulence psi variable', 'name': 'Turbulence psi variable', 'unit': '', 'filename': 'TurbPsi3d'}, 'w_mesh_surf_3d': {'shortname': 'Surface mesh velocity', 'name': 'Surface mesh velocity', 'unit': 'm s-1', 'filename': 'SurfMeshVelo3d'}, 'baroc_head_int_3d': {'shortname': 'Vertically integrated baroclinic head', 'name': 'Vertical integral of baroclinic head', 'unit': 'm2', 'filename': 'BaroHeadInt3d'}, 'smag_visc_3d': {'shortname': 'Smagorinsky viscosity', 'name': 'Smagorinsky viscosity', 'unit': 'm2 s-1', 'filename': 'SmagViscosity3d'}, 'tke_3d': {'shortname': 'Turbulent Kinetic Energy', 'name': 'Turbulent Kinetic Energy', 'unit': 'm2 s-2', 'filename': 'TurbKEnergy3d'}, 'bottom_drag_3d': {'shortname': 'Bottom drag coefficient', 'name': 'Bottom drag coefficient', 'unit': '', 'filename': 'BottomDrag3d'}, 'w_mesh_surf_2d': {'shortname': 'Surface mesh velocity', 'name': 'Surface mesh velocity', 'unit': 'm s-1', 'filename': 'SurfMeshVelo3d'}, 'wind_stress_3d': {'shortname': 'Wind stress', 'name': 'Wind stress', 'unit': 'Pa', 'filename': 'wind_stress_3d'}, 'uv_2d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'Velocity2d'}}</em><a class="headerlink" href="#thetis.field_defs.field_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds description, units and output file information for each field.</p>
<p>name      - human readable description
shortname - description used in visualization etc
unit      - SI unit of the field
filename  - filename for output files</p>
<p>Naming convention for fields is snake_case: field_name_3d</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.firedrake">
<span id="thetis-firedrake-module"></span><h2>thetis.firedrake module<a class="headerlink" href="#module-thetis.firedrake" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thetis.limiter">
<span id="thetis-limiter-module"></span><h2>thetis.limiter module<a class="headerlink" href="#module-thetis.limiter" title="Permalink to this headline">¶</a></h2>
<p>Slope limiter implementation.</p>
<p>Tuomas Karna 2015-08-26</p>
<dl class="class">
<dt id="thetis.limiter.VertexBasedP1DGLimiter">
<em class="property">class </em><code class="descclassname">thetis.limiter.</code><code class="descname">VertexBasedP1DGLimiter</code><span class="sig-paren">(</span><em>p1dg_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter</span></code></p>
<p>Vertex based limiter for P1DG tracer fields.</p>
<p>Based on firedrake implementation by Andrew McRae.</p>
<p>[1] Kuzmin Dmitri (2010). A vertex-based hierarchical slope limiter
for p-adaptive discontinuous Galerkin methods. Journal of Computational
and Applied Mathematics, 233(12):3077-3085.
<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2009.05.028">http://dx.doi.org/10.1016/j.cam.2009.05.028</a></p>
<dl class="method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.compute_bounds">
<code class="descname">compute_bounds</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.compute_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.compute_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-compute min/max values of all neighbouring centroids</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.limiter.assert_function_space">
<code class="descclassname">thetis.limiter.</code><code class="descname">assert_function_space</code><span class="sig-paren">(</span><em>fs</em>, <em>family</em>, <em>degree</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#assert_function_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.assert_function_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the family and degree of function space.</p>
<p>Raises AssertionError if function space differs.
If the function space lies on an extruded mesh, checks both spaces of the
outer product.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.limiter.timed_region">
<code class="descclassname">thetis.limiter.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.limiter.timed_stage">
<code class="descclassname">thetis.limiter.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.log">
<span id="thetis-log-module"></span><h2>thetis.log module<a class="headerlink" href="#module-thetis.log" title="Permalink to this headline">¶</a></h2>
<p>Loggers for Thetis</p>
<p>Creates two logger instances, one for general model output and one for debug,
warning, error etc. messages.</p>
<p>To print to the model output stream, use <code class="xref py py-func docutils literal"><span class="pre">print_output()</span></code>.</p>
<p>Debug, warning etc. messages are issued with <code class="xref py py-func docutils literal"><span class="pre">debug()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">info()</span></code>,
<code class="xref py py-func docutils literal"><span class="pre">warning()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">error()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">critical()</span></code> methods.</p>
</div>
<div class="section" id="module-thetis.momentum_eq">
<span id="thetis-momentum-eq-module"></span><h2>thetis.momentum_eq module<a class="headerlink" href="#module-thetis.momentum_eq" title="Permalink to this headline">¶</a></h2>
<p>3D momentum and tracer equations for hydrostatic Boussinesq flow.</p>
<p>Tuomas Karna 2015-02-23</p>
<dl class="class">
<dt id="thetis.momentum_eq.ALESourceTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">ALESourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#ALESourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.ALESourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.ALESourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#ALESourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.ALESourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.BottomFrictionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">BottomFrictionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.BottomFrictionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.CoriolisTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">CoriolisTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.CoriolisTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.LinearDragTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">LinearDragTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.LinearDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.MomentumEquation">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">MomentumEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>3D momentum equation for hydrostatic Boussinesq flow.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.MomentumTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">MomentumTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term for momentum equation that provides commonly used members and
mapping for boundary functions.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.PressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">PressureGradientTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.PressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.SourceTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">SourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Generic source term</p>
<dl class="method">
<dt id="thetis.momentum_eq.SourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.VerticalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">VerticalViscosityTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<dl class="method">
<dt id="thetis.momentum_eq.VerticalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.momentum_eq.timed_region">
<code class="descclassname">thetis.momentum_eq.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.momentum_eq.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.momentum_eq.timed_stage">
<code class="descclassname">thetis.momentum_eq.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.momentum_eq.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.options">
<span id="thetis-options-module"></span><h2>thetis.options module<a class="headerlink" href="#module-thetis.options" title="Permalink to this headline">¶</a></h2>
<p>This file defines all options of the 2D/3D models excluding field values.</p>
<p>Tuomas Karna 2015-10-17</p>
<dl class="class">
<dt id="thetis.options.ModelOptions">
<em class="property">class </em><code class="descclassname">thetis.options.</code><code class="descname">ModelOptions</code><a class="reference internal" href="_modules/thetis/options.html#ModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a>, <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Stores all circulation model options</p>
<dl class="attribute">
<dt id="thetis.options.ModelOptions.baroclinic">
<code class="descname">baroclinic</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.baroclinic" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute internal pressure gradient in momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.cfl_2d">
<code class="descname">cfl_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.cfl_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Factor to scale the 2d time step</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.cfl_3d">
<code class="descname">cfl_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.cfl_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Factor to scale the 2d time step</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_salt_conservation">
<code class="descname">check_salt_conservation</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_salt_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print deviation from initial salt mass</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_salt_overshoot">
<code class="descname">check_salt_overshoot</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_salt_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print overshoots that exceed initial range</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_temp_conservation">
<code class="descname">check_temp_conservation</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_temp_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print deviation from initial temp mass</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_temp_overshoot">
<code class="descname">check_temp_overshoot</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_temp_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print overshoots that exceed initial range</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_vol_conservation_2d">
<code class="descname">check_vol_conservation_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_vol_conservation_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print deviation from initial volume for 2D mode (eta)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_vol_conservation_3d">
<code class="descname">check_vol_conservation_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_vol_conservation_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Print deviation from initial volume for 3D mode (domain volume)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.constant_salt">
<code class="descname">constant_salt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.constant_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient: Constant salinity if salinity is not solved</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.constant_temp">
<code class="descname">constant_temp</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.constant_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient: Constant temperature if temperature is not solved</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.coriolis">
<code class="descname">coriolis</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.coriolis" title="Permalink to this definition">¶</a></dt>
<dd><p>2D Coefficient or None: Coriolis parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.dt">
<code class="descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Time step. If set overrides automatically computed stable dt</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.dt_2d">
<code class="descname">dt_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Time step for 2d mode. If set overrides automatically computed stable dt</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.element_family">
<code class="descname">element_family</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.element_family" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Finite element family. Currently &#8216;dg-dg&#8217;, &#8216;rt-dg&#8217;, or &#8216;dg-cg&#8217; velocity-pressure pairs are supported.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.elev_source_2d">
<code class="descname">elev_source_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.elev_source_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 2d continuity equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.equation_of_state">
<code class="descname">equation_of_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.equation_of_state" title="Permalink to this definition">¶</a></dt>
<dd><p>str: type of equation of state, either &#8216;full&#8217; or &#8216;linear&#8217;</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.export_diagnostics">
<code class="descname">export_diagnostics</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.export_diagnostics" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Store diagnostic variables to disk in hdf5 format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.fields_to_export">
<code class="descname">fields_to_export</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.fields_to_export" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str: Fields to export in VTK format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.fields_to_export_hdf5">
<code class="descname">fields_to_export_hdf5</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.fields_to_export_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str: Fields to export in numpy format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.fields_to_export_numpy">
<code class="descname">fields_to_export_numpy</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.fields_to_export_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str: Fields to export in HDF5 format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.gls_options">
<code class="descname">gls_options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.gls_options" title="Permalink to this definition">¶</a></dt>
<dd><p>GLSModelOptions: Dictionary of default GLS model options</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.h_diffusivity">
<code class="descname">h_diffusivity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.h_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Background diffusivity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.h_viscosity">
<code class="descname">h_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.h_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.include_grad_depth_viscosity_term">
<code class="descname">include_grad_depth_viscosity_term</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.include_grad_depth_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Include grad(H) term in the depth-averaged viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.include_grad_div_viscosity_term">
<code class="descname">include_grad_div_viscosity_term</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.include_grad_div_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Include grad(nu div(u)) term in the depth-averaged viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.lin_equation_of_state_params">
<code class="descname">lin_equation_of_state_params</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.lin_equation_of_state_params" title="Permalink to this definition">¶</a></dt>
<dd><p>dict: definition of linear equation of state</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.linear_drag">
<code class="descname">linear_drag</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.linear_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: 2D linear drag parameter tau/rho_0 = -drag*u*H</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.mu_manning">
<code class="descname">mu_manning</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.mu_manning" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Manning-Strickler 2D quadratic drag parameter tau/rho_0 = -g*mu**2*|u|*u/H^(1/3)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.no_exports">
<code class="descname">no_exports</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.no_exports" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Do not store any outputs to disk, used in CI test suite. Disables vtk and hdf5 field outputs and hdf5 diagnostic outputs.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.nonlin">
<code class="descname">nonlin</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.nonlin" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use nonlinear shallow water equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.order">
<code class="descname">order</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.order" title="Permalink to this definition">¶</a></dt>
<dd><p>int: Polynomial degree of elements</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.outputdir">
<code class="descname">outputdir</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.outputdir" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Directory where model output files are stored</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.quadratic_drag">
<code class="descname">quadratic_drag</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.quadratic_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: dimensionless 2D quadratic drag parameter tau/rho_0 = -drag*|u|*u</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.salt_jump_diff_factor">
<code class="descname">salt_jump_diff_factor</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.salt_jump_diff_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant or None: Non-linear jump diffusion factor</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.salt_range">
<code class="descname">salt_range</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.salt_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant or None: Salt max-min range for jump diffusion</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.salt_source_3d">
<code class="descname">salt_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.salt_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for salinity equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.shallow_water_theta">
<code class="descname">shallow_water_theta</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.shallow_water_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>float: theta parameter for shallow water semi-implicit scheme</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.smagorinsky_factor">
<code class="descname">smagorinsky_factor</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.smagorinsky_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant or None: Smagorinsky viscosity factor C_S</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_salt">
<code class="descname">solve_salt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve salt transport</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_temp">
<code class="descname">solve_temp</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve temperature transport</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_vert_diffusion">
<code class="descname">solve_vert_diffusion</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_vert_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve implicit vert diffusion</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_momentum_explicit">
<code class="descname">solver_parameters_momentum_explicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_momentum_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for explicit 3D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_momentum_implicit">
<code class="descname">solver_parameters_momentum_implicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_momentum_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for implicit 3D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_sw">
<code class="descname">solver_parameters_sw</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_sw" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for 2D shallow water equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_sw_momentum">
<code class="descname">solver_parameters_sw_momentum</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_sw_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for 2D depth averaged momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_tracer_explicit">
<code class="descname">solver_parameters_tracer_explicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_tracer_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for explicit 3D tracer equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_tracer_implicit">
<code class="descname">solver_parameters_tracer_implicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_tracer_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for implicit 3D tracer equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.t_end">
<code class="descname">t_end</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.t_end" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Simulation duration in seconds</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.t_export">
<code class="descname">t_export</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.t_export" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Export interval in seconds. All fields in fields_to_export list will be stored to disk and diagnostics will be computed.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.temp_source_3d">
<code class="descname">temp_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.temp_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for temperature equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.tracer_lax_friedrichs">
<code class="descname">tracer_lax_friedrichs</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.tracer_lax_friedrichs" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant or None: Scaling factor for tracer L-F stability term.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.turbulence_model">
<code class="descname">turbulence_model</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.turbulence_model" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Defines the type of vertical turbulence model. Currently only &#8216;gls&#8217;</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.u_advection">
<code class="descname">u_advection</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.u_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant: Max. horizontal velocity magnitude for computing max stable advection time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_ale_moving_mesh">
<code class="descname">use_ale_moving_mesh</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_ale_moving_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: 3D mesh tracks free surface</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_bottom_friction">
<code class="descname">use_bottom_friction</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_bottom_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Apply log layer bottom stress</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_imex">
<code class="descname">use_imex</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_imex" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use IMEX time integrator (only with mode split)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_limiter_for_tracers">
<code class="descname">use_limiter_for_tracers</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_limiter_for_tracers" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Apply P1DG limiter for tracer fields</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_linearized_semi_implicit_2d">
<code class="descname">use_linearized_semi_implicit_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_linearized_semi_implicit_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use linearized semi-implicit time integration for the horizontal mode</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_mode_split">
<code class="descname">use_mode_split</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_mode_split" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve 2D/3D modes with different dt</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_parabolic_viscosity">
<code class="descname">use_parabolic_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_parabolic_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute parabolic eddy viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_semi_implicit_2d">
<code class="descname">use_semi_implicit_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_semi_implicit_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Implicit 2D waves (only w. mode split)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_smooth_eddy_viscosity">
<code class="descname">use_smooth_eddy_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_smooth_eddy_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Cast eddy viscosity to p1 space instead of p0</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_turbulence">
<code class="descname">use_turbulence</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_turbulence" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: GLS turbulence model</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_turbulence_advection">
<code class="descname">use_turbulence_advection</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_turbulence_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Advect tke,psi with velocity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_lax_friedrichs">
<code class="descname">uv_lax_friedrichs</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_lax_friedrichs" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant or None: Scaling factor for uv L-F stability term.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_source_2d">
<code class="descname">uv_source_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_source_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 2d momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_source_3d">
<code class="descname">uv_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 3d momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.v_diffusivity">
<code class="descname">v_diffusivity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.v_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background diffusivity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.v_viscosity">
<code class="descname">v_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.v_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.verbose">
<code class="descname">verbose</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>int: Verbosity level</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.wind_stress">
<code class="descname">wind_stress</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.wind_stress" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Stress at free surface (2D vector function)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.options.timed_region">
<code class="descclassname">thetis.options.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.options.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.options.timed_stage">
<code class="descclassname">thetis.options.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.options.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.physical_constants">
<span id="thetis-physical-constants-module"></span><h2>thetis.physical_constants module<a class="headerlink" href="#module-thetis.physical_constants" title="Permalink to this headline">¶</a></h2>
<p>Default values for common constants and parameters in a dictionary.</p>
<p>Tuomas Karna 2015-02-23</p>
</div>
<div class="section" id="module-thetis.shallowwater_eq">
<span id="thetis-shallowwater-eq-module"></span><h2>thetis.shallowwater_eq module<a class="headerlink" href="#module-thetis.shallowwater_eq" title="Permalink to this headline">¶</a></h2>
<p>Depth averaged shallow water equations</p>
<p>TODO: add documentation</p>
<p>Boundary conditions are set with ShallowWaterEquations.bnd_functions dict.
For example to assign elevation and volume flux for boundary 1:
sw.bnd_functions[1] = {&#8216;elev&#8217;:myfunc1, &#8216;flux&#8217;:myfunc2}
where myfunc1 and myfunc2 are Functions in the appropriate function space.</p>
<p>Supported boundary conditions are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;elev&#8217;: elevation only (usually unstable)</li>
<li>&#8216;uv&#8217;: 2d velocity vector (in model coordinates)</li>
<li>&#8216;un&#8217;: normal velocity (scalar, positive out of domain)</li>
<li>&#8216;flux&#8217;: normal volume flux (scalar, positive out of domain)</li>
<li>&#8216;elev&#8217; and &#8216;uv&#8217;: water elevation and uv vector</li>
<li>&#8216;elev&#8217; and &#8216;un&#8217;: water elevation and normal velocity (scalar)</li>
<li>&#8216;elev&#8217; and &#8216;flux&#8217;: water elevation and normal flux (scalar)</li>
</ul>
</div></blockquote>
<p>Tuomas Karna 2015-02-23</p>
<dl class="class">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">BaseShallowWaterEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Abstract base class for ShallowWaterEquations, ShallowWaterMomentumEquation and FreeSurfaceEquation.
Provides common functionality to compute timesteps and add either momentum or continuity terms.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms">
<code class="descname">add_continuity_terms</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_continuity_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms">
<code class="descname">add_momentum_terms</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_momentum_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta">
<code class="descname">residual_uv_eta</code><span class="sig-paren">(</span><em>label</em>, <em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.residual_uv_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</td>
</tr>
</tbody>
</table>
<p>:arg uv:, :arg eta: uv and eta at new time-level, at least one of whom is solved for
:arg uv_old:, :arg eta_old: uv and eta at the old time-level
:arg fields: a dictionary that provides all the remaining fields that the term depends on.</p>
<blockquote>
<div>The keys of the dictionary should standard field names in <cite>field_metadata</cite></div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">BottomDrag3DTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Bottom drag term consistent with 3D model</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ContinuitySourceTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Generic source term in the depth-averaged continuity equation</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.CoriolisTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">CoriolisTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Coriolis term</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.CoriolisTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ExternalPressureGradientTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>External pressure gradient term</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">FreeSurfaceEquation</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D free surface equation.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HUDivTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HUDivTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Divergence of Hu</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.HUDivTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Horizontal advection of momentum</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Viscosity of momentum</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.InternalPressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">InternalPressureGradientTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#InternalPressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.InternalPressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Internal pressure gradient term</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.InternalPressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#InternalPressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.InternalPressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.LinearDragTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">LinearDragTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Linear bottom friction term</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.LinearDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">MomentumSourceTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Generic source term in the shallow water momentum equation</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">QuadraticDragTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Quadratic Manning bottom friction term</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterContinuityTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterContinuityTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterContinuityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the depth-integrated continuity equation that provides commonly used
members and mapping for boundary functions.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterEquations</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations in non-conservative form.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterMomentumEquation</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D free surface equation.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterMomentumTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the shallow water momentum equation that provides commonly used
members and mapping for boundary functions.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterTerm</code><span class="sig-paren">(</span><em>space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term in the shallow water equations that provides commonly used
members and mapping for boundary functions.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions">
<code class="descname">get_bnd_functions</code><span class="sig-paren">(</span><em>eta_in</em>, <em>uv_in</em>, <em>bnd_id</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of elev and uv for all supported
boundary conditions.</p>
<p>volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm.get_total_depth">
<code class="descname">get_total_depth</code><span class="sig-paren">(</span><em>eta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_total_depth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_total_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total water column depth</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.WindStressTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">WindStressTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Wind stress</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.WindStressTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.shallowwater_eq.timed_region">
<code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.shallowwater_eq.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.shallowwater_eq.timed_stage">
<code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.shallowwater_eq.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.solver">
<span id="thetis-solver-module"></span><h2>thetis.solver module<a class="headerlink" href="#module-thetis.solver" title="Permalink to this headline">¶</a></h2>
<p>Module for coupled 2D-3D flow solver.</p>
<p>Tuomas Karna 2015-04-01</p>
<dl class="class">
<dt id="thetis.solver.FlowSolver">
<em class="property">class </em><code class="descclassname">thetis.solver.</code><code class="descname">FlowSolver</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>bathymetry_2d</em>, <em>n_layers</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Creates and solves coupled 2D-3D equations</p>
<dl class="method">
<dt id="thetis.solver.FlowSolver.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>eval_interval='export'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>callback</strong> &#8211; DiagnosticCallback instance</td>
</tr>
</tbody>
</table>
<p>&#8220;arg eval_interval: &#8216;export&#8217;|&#8217;timestep&#8217; Determines when callback will be evaluated.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.assign_initial_conditions">
<code class="descname">assign_initial_conditions</code><span class="sig-paren">(</span><em>elev=None</em>, <em>salt=None</em>, <em>temp=None</em>, <em>uv_2d=None</em>, <em>uv_3d=None</em>, <em>tke=None</em>, <em>psi=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.callbacks">
<code class="descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback manager object</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_time_step_2d">
<code class="descname">compute_time_step_2d</code><span class="sig-paren">(</span><em>u_mag=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>7)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_time_step_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_time_step_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<p>dt = CellSize/U</p>
<p>Assumes velocity scale U = sqrt(g*H) + u_mag
where u_mag is estimated advective velocity</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_time_step_3d">
<code class="descname">compute_time_step_3d</code><span class="sig-paren">(</span><em>u_mag=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>8)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_time_step_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_time_step_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<p>dt = CellSize/U</p>
<p>Assumes velocity scale U = u_mag
where u_mag is estimated advective velocity</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.create_equations">
<code class="descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces, functions, equations and time steppers.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.create_function_spaces">
<code class="descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.export" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.export_initial_state">
<code class="descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.fields">
<code class="descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds all functions needed by the solver object.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.function_spaces">
<code class="descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds all function spaces needed by the solver object.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.iterate">
<code class="descname">iterate</code><span class="sig-paren">(</span><em>update_forcings=None</em>, <em>update_forcings3d=None</em>, <em>export_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.iterate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.load_state">
<code class="descname">load_state</code><span class="sig-paren">(</span><em>i_export</em>, <em>outputdir=None</em>, <em>t=None</em>, <em>iteration=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces assign_initial_conditions in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format.  The required
state variables are: elev_2d, uv_2d, uv_3d, salt_3d, temp_3d, tke_3d,
psi_3d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.print_state">
<code class="descname">print_state</code><span class="sig-paren">(</span><em>cputime</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.set_time_step">
<code class="descname">set_time_step</code><span class="sig-paren">(</span><em>alpha=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.solver.timed_region">
<code class="descclassname">thetis.solver.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.solver.timed_stage">
<code class="descclassname">thetis.solver.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.solver2d">
<span id="thetis-solver2d-module"></span><h2>thetis.solver2d module<a class="headerlink" href="#module-thetis.solver2d" title="Permalink to this headline">¶</a></h2>
<p>Module for 2D solver class.</p>
<p>Tuomas Karna 2015-10-17</p>
<dl class="class">
<dt id="thetis.solver2d.FlowSolver2d">
<em class="property">class </em><code class="descclassname">thetis.solver2d.</code><code class="descname">FlowSolver2d</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>bathymetry_2d</em>, <em>order=1</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Creates and solves 2D depth averaged equations with RT1-P1DG elements</p>
<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>eval_interval='export'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>callback</strong> &#8211; DiagnosticCallback instance</td>
</tr>
</tbody>
</table>
<p>&#8220;arg eval_interval: &#8216;export&#8217;|&#8217;timestep&#8217; Determines when callback will be evaluated.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.assign_initial_conditions">
<code class="descname">assign_initial_conditions</code><span class="sig-paren">(</span><em>elev=None</em>, <em>uv_init=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.callbacks">
<code class="descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback manager object</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.compute_time_step">
<code class="descname">compute_time_step</code><span class="sig-paren">(</span><em>u_mag=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>9)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.compute_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.compute_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<p>dt = CellSize/U</p>
<p>Assumes velocity scale U = sqrt(g*H) + u_mag
where u_mag is estimated advective velocity</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_equations">
<code class="descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates functions, equations and time steppers.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_exporters">
<code class="descname">create_exporters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_exporters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_exporters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_function_spaces">
<code class="descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_timestepper">
<code class="descname">create_timestepper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_timestepper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_timestepper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.export_initial_state">
<code class="descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.fields">
<code class="descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds all functions needed by the solver object.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.function_spaces">
<code class="descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds all function spaces needed by the solver object.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.iterate">
<code class="descname">iterate</code><span class="sig-paren">(</span><em>update_forcings=None</em>, <em>export_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.iterate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.load_state">
<code class="descname">load_state</code><span class="sig-paren">(</span><em>i_export</em>, <em>outputdir=None</em>, <em>t=None</em>, <em>iteration=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces assign_initial_conditions in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format. The required
state variables are: elev_2d, uv_2d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.print_state">
<code class="descname">print_state</code><span class="sig-paren">(</span><em>cputime</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.print_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.set_time_step">
<code class="descname">set_time_step</code><span class="sig-paren">(</span><em>alpha=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.solver2d.timed_region">
<code class="descclassname">thetis.solver2d.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.solver2d.timed_stage">
<code class="descclassname">thetis.solver2d.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.stability_functions">
<span id="thetis-stability-functions-module"></span><h2>thetis.stability_functions module<a class="headerlink" href="#module-thetis.stability_functions" title="Permalink to this headline">¶</a></h2>
<p>Implements turbulence closure model stability functions.</p>
<p>References:</p>
<dl class="docutils">
<dt>[1] Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models</dt>
<dd>for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795&#8211;827.
<a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></dd>
<dt>[2] Burchard, H. and Bolding, K. (2001). Comparative Analysis of Four Second-Moment</dt>
<dd>Turbulence Closure Models for the Oceanic Mixed Layer. Journal of Physical
Oceanography, 31(8):1943&#8211;1968.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></dd>
<dt>[3] Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for</dt>
<dd>geophysical turbulence models. Journal of Marine Research, 61:235&#8211;265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></dd>
</dl>
<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCanutoA</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></p>
<p>Canuto et al. (2001) version A stability functions</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCanutoB</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></p>
<p>Canuto et al. (2001) version B stability functions</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionKanthaClayson">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionKanthaClayson</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionKanthaClayson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionKanthaClayson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></p>
<p>Kantha and Clayson (1994) quasi-equilibrium stability functions</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCheng">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCheng</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCheng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></p>
<p>Cheng et al. (2002) quasi-equilibrium stability functions</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.timeintegrator">
<span id="thetis-timeintegrator-module"></span><h2>thetis.timeintegrator module<a class="headerlink" href="#module-thetis.timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Generic time integration schemes to advance equations in time.</p>
<p>Tuomas Karna 2015-03-27</p>
<dl class="class">
<dt id="thetis.timeintegrator.BackwardEuler">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">BackwardEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#BackwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.BackwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>Backward Euler method</p>
<p>This method has the Butcher tableau</p>
<blockquote>
<div><div class="line-block">
<div class="line">1</div>
</div>
</div></blockquote>
<dl class="attribute">
<dt id="thetis.timeintegrator.BackwardEuler.a">
<code class="descname">a</code><em class="property"> = [[1.0]]</em><a class="headerlink" href="#thetis.timeintegrator.BackwardEuler.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.BackwardEuler.b">
<code class="descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.timeintegrator.BackwardEuler.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.BackwardEuler.c">
<code class="descname">c</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.timeintegrator.BackwardEuler.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.CrankNicolson">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">CrankNicolson</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>theta=0.5</em>, <em>semi_implicit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard Crank-Nicolson time integration scheme.</p>
<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRK22">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRK22</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRK22"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRK22" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>DIRK22, 2-stage, 2nd order, L-stable
Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<p>gamma   | gamma     0
1       | 1-gamma  gamma
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<blockquote>
<div><div class="line-block">
<div class="line">0.5       0.5</div>
</div>
</div></blockquote>
<p>with
gamma = (2 + sqrt(2))/2</p>
<p>From DIRK(2,3,2) IMEX scheme in Ascher et al. (1997)</p>
<dl class="docutils">
<dt>[1] Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for</dt>
<dd>time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167.</dd>
</dl>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK22.a">
<code class="descname">a</code><em class="property"> = [[Constant(FiniteElement('Real', None, 0), 6), 0], [Sum(IntValue(1), Product(IntValue(-1), Constant(FiniteElement('Real', None, 0), 6))), Constant(FiniteElement('Real', None, 0), 6)]]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK22.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK22.b">
<code class="descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK22.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK22.c">
<code class="descname">c</code><em class="property"> = [Constant(FiniteElement('Real', None, 0), 6), 1]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK22.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK22.gamma">
<code class="descname">gamma</code><em class="property"> = Constant(FiniteElement('Real', None, 0), 6)</em><a class="headerlink" href="#thetis.timeintegrator.DIRK22.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRK23">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRK23</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRK23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRK23" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>DIRK23, 2-stage, 3rd order
Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<p>gamma   | gamma     0
1-gamma | 1-2*gamma gamma
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<blockquote>
<div><div class="line-block">
<div class="line">0.5       0.5</div>
</div>
</div></blockquote>
<p>with
gamma = (3 + sqrt(3))/6</p>
<p>From DIRK(2,3,3) IMEX scheme in Ascher et al. (1997)</p>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK23.a">
<code class="descname">a</code><em class="property"> = [[0.78867513459481275, 0], [-0.57735026918962551, 0.78867513459481275]]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK23.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK23.b">
<code class="descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK23.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK23.c">
<code class="descname">c</code><em class="property"> = [0.78867513459481275, 0.21132486540518725]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK23.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK23.gamma">
<code class="descname">gamma</code><em class="property"> = 0.78867513459481275</em><a class="headerlink" href="#thetis.timeintegrator.DIRK23.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRK33">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRK33</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>DIRK33, 3-stage, 3rd order, L-stable
Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(3,4,3) IMEX scheme in Ascher et al. (1997)</p>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.a">
<code class="descname">a</code><em class="property"> = [[0.4358665215, 0, 0], [0.28206673925000003, 0.4358665215, 0], [1.208496649153235, -0.6443631706532353, 0.4358665215]]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.b">
<code class="descname">b</code><em class="property"> = [1.208496649153235, -0.6443631706532353, 0.4358665215]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.b1">
<code class="descname">b1</code><em class="property"> = 1.208496649153235</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.b1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.b2">
<code class="descname">b2</code><em class="property"> = -0.6443631706532353</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.b2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.c">
<code class="descname">c</code><em class="property"> = [0.4358665215, 0.71793326075, 1]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK33.gamma">
<code class="descname">gamma</code><em class="property"> = 0.4358665215</em><a class="headerlink" href="#thetis.timeintegrator.DIRK33.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRK43">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRK43</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRK43"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRK43" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>DIRK43, 4-stage, 3rd order, L-stable
Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(4,4,3) IMEX scheme in Ascher et al. (1997)</p>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK43.a">
<code class="descname">a</code><em class="property"> = [[0.5, 0, 0, 0], [0.16666666666666666, 0.5, 0, 0], [-0.5, 0.5, 0.5, 0], [1.5, -1.5, 0.5, 0.5]]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK43.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK43.b">
<code class="descname">b</code><em class="property"> = [1.5, -1.5, 0.5, 0.5]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK43.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRK43.c">
<code class="descname">c</code><em class="property"> = [0.5, 0.6666666666666666, 0.5, 1.0]</em><a class="headerlink" href="#thetis.timeintegrator.DIRK43.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRKGeneric">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRKGeneric</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Generic implementation of Diagonally Implicit Runge Kutta schemes.</p>
<p>Method is defined by its Butcher tableau</p>
<p>c[0] | a[0, 0]
c[1] | a[1, 0] a[1, 1]
c[2] | a[2, 0] a[2, 1] a[2, 2]
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<blockquote>
<div><div class="line-block">
<div class="line">b[0]    b[1]    b[2]</div>
</div>
</div></blockquote>
<p>All derived classes must define the tableau via properties
a  : array_like (n_stages, n_stages)</p>
<blockquote>
<div>coefficients for the Butcher tableau, must be lower diagonal</div></blockquote>
<dl class="docutils">
<dt>b,c</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array_like (n_stages,)</span><dd>coefficients for the Butcher tableau</dd>
</dl>
<p>This method also works for explicit RK schemes if one with the zeros on the first row of a.</p>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKGeneric.a">
<code class="descname">a</code><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKGeneric.b">
<code class="descname">b</code><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKGeneric.c">
<code class="descname">c</code><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><em>output=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the final solution from the tendencies</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.get_stage_solution">
<code class="descname">get_stage_solution</code><span class="sig-paren">(</span><em>i_stage</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.get_stage_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.get_stage_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores intermediate solution for stage i_stage to the output field</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>init_cond</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>dt</em>, <em>output=None</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one stage.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.DIRKGeneric.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.DIRKLSPUM2">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">DIRKLSPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#DIRKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.DIRKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>DIRKLSPUM2, 3-stage, 2nd order, L-stable
Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<dl class="docutils">
<dt>[1] Higueras et al (2014). Optimized strong stability preserving IMEX</dt>
<dd>Runge-Kutta methods. Journal of Computational and Applied
Mathematics 272(2014) 116-140.</dd>
</dl>
<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKLSPUM2.a">
<code class="descname">a</code><em class="property"> = [[0.18181818181818182, 0, 0], [0.44372294372294374, 0.18181818181818182, 0], [0.44004329004329007, 0.19090909090909092, 0.18181818181818182]]</em><a class="headerlink" href="#thetis.timeintegrator.DIRKLSPUM2.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKLSPUM2.b">
<code class="descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.timeintegrator.DIRKLSPUM2.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.DIRKLSPUM2.c">
<code class="descname">c</code><em class="property"> = [0.18181818181818182, 0.6255411255411255, 0.8127705627705628]</em><a class="headerlink" href="#thetis.timeintegrator.DIRKLSPUM2.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.ERKLSPUM2">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">ERKLSPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ERKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ERKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>ERKLSPUM2, 3-stage, 2nd order
Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<dl class="docutils">
<dt>[1] Higueras et al (2014). Optimized strong stability preserving IMEX</dt>
<dd>Runge-Kutta methods. Journal of Computational and Applied
Mathematics 272(2014) 116-140.</dd>
</dl>
<dl class="attribute">
<dt id="thetis.timeintegrator.ERKLSPUM2.a">
<code class="descname">a</code><em class="property"> = [[0, 0, 0], [0.8333333333333334, 0, 0], [0.4583333333333333, 0.4583333333333333, 0]]</em><a class="headerlink" href="#thetis.timeintegrator.ERKLSPUM2.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.ERKLSPUM2.b">
<code class="descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.timeintegrator.ERKLSPUM2.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.ERKLSPUM2.c">
<code class="descname">c</code><em class="property"> = [0, 0.8333333333333334, 0.9166666666666666]</em><a class="headerlink" href="#thetis.timeintegrator.ERKLSPUM2.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.ForwardEuler">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">ForwardEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard forward Euler time integration scheme.</p>
<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.ImplicitMidpoint">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">ImplicitMidpoint</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ImplicitMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ImplicitMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.DIRKGeneric" title="thetis.timeintegrator.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.DIRKGeneric</span></code></a></p>
<p>Implicit midpoint method, second order.</p>
<p>This method has the Butcher tableau</p>
<blockquote>
<div><div class="line-block">
<div class="line">1</div>
</div>
</div></blockquote>
<dl class="attribute">
<dt id="thetis.timeintegrator.ImplicitMidpoint.a">
<code class="descname">a</code><em class="property"> = [[0.5]]</em><a class="headerlink" href="#thetis.timeintegrator.ImplicitMidpoint.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.ImplicitMidpoint.b">
<code class="descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.timeintegrator.ImplicitMidpoint.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.ImplicitMidpoint.c">
<code class="descname">c</code><em class="property"> = [0.5]</em><a class="headerlink" href="#thetis.timeintegrator.ImplicitMidpoint.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.PressureProjectionPicard">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">PressureProjectionPicard</code><span class="sig-paren">(</span><em>equation</em>, <em>equation_mom</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_mom={}</em>, <em>theta=0.5</em>, <em>semi_implicit=False</em>, <em>iterations=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Pressure projection scheme with Picard iteration.</p>
<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>updateForcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SSPIMEX">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SSPIMEX</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>SSP-IMEX time integration scheme based on [1], method (17).</p>
<dl class="docutils">
<dt>[1] Higueras et al (2014). Optimized strong stability preserving IMEX</dt>
<dd>Runge-Kutta methods. Journal of Computational and Applied
Mathematics 272(2014) 116-140.</dd>
</dl>
<dl class="method">
<dt id="thetis.timeintegrator.SSPIMEX.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPIMEX.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPIMEX.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPIMEX.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPIMEX.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPIMEX.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPIMEX.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SSPRK33">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SSPRK33</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>funcs_nplushalf={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).</p>
<p>This scheme has Butcher tableau
0   |
1   | 1
1/2 | 1/4 1/4
&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<blockquote>
<div><div class="line-block">
<div class="line">1/6 1/6 2/3</div>
</div>
</div></blockquote>
<p>CFL coefficient is 1.0</p>
<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds linear problems for each stage. These problems need to be
re-created after each mesh update.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SSPRK33Stage">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SSPRK33Stage</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33Stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33Stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).
This class only advances one step at a time.</p>
<p>This scheme has Butcher tableau
0   |
1   | 1
1/2 | 1/4 1/4
&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<blockquote>
<div><div class="line-block">
<div class="line">1/6 1/6 2/3</div>
</div>
</div></blockquote>
<p>CFL coefficient is 1.0</p>
<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33Stage.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33Stage.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33Stage.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances one full time step from t to t+dt.
This assumes that all the functions that the equation depends on are
constants across this interval. If dependent functions need to be
updated call solve_stage instead.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33Stage.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33Stage.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33Stage.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33Stage.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33Stage.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33Stage.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33Stage.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33Stage.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33Stage.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds linear problems for each stage. These problems need to be
re-created after each mesh update.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SSPRK33StageSemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SSPRK33StageSemiImplicit</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>semi_implicit=False</em>, <em>theta=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33StageSemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33StageSemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).
This class only advances one step at a time.</p>
<p>This scheme has Butcher tableau
0   |
1   | 1
1/2 | 1/4 1/4
&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<blockquote>
<div><div class="line-block">
<div class="line">1/6 1/6 2/3</div>
</div>
</div></blockquote>
<p>CFL coefficient is 1.0</p>
<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33StageSemiImplicit.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33StageSemiImplicit.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33StageSemiImplicit.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances one full time step from t to t+dt.
This assumes that all the functions that the equation depends on are
constants across this interval. If dependent functions need to be
updated call solve_stage instead.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33StageSemiImplicit.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33StageSemiImplicit.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33StageSemiImplicit.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33StageSemiImplicit.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33StageSemiImplicit.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33StageSemiImplicit.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at rigth state
corresponding to each sub-step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK33StageSemiImplicit.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK33StageSemiImplicit.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK33StageSemiImplicit.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds linear problems for each stage. These problems need to be
re-created after each mesh update.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SteadyState">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SteadyState</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Time integrator that solves the steady state equations, leaving out the mass terms</p>
<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>dt</em>, <em>solution</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.TimeIntegrator">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">TimeIntegrator</code><span class="sig-paren">(</span><em>equation</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base class for all time integrator objects.</p>
<dl class="method">
<dt id="thetis.timeintegrator.TimeIntegrator.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.TimeIntegrator.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>equation</em>, <em>dt</em>, <em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.timeintegrator.timed_region">
<code class="descclassname">thetis.timeintegrator.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.timeintegrator.timed_stage">
<code class="descclassname">thetis.timeintegrator.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.tracer_eq">
<span id="thetis-tracer-eq-module"></span><h2>thetis.tracer_eq module<a class="headerlink" href="#module-thetis.tracer_eq" title="Permalink to this headline">¶</a></h2>
<p>3D advection diffusion equation for tracers.</p>
<p>Tuomas Karna 2015-09-08</p>
<dl class="class">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal scalar advection term</p>
<dl class="method">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">HorizontalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal scalar diffusion term</p>
<dl class="method">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.SourceTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">SourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Generic tracer source term</p>
<dl class="method">
<dt id="thetis.tracer_eq.SourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.TracerEquation">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">TracerEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>3D tracer advection-diffusion equation</p>
</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.TracerTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">TracerTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="method">
<dt id="thetis.tracer_eq.TracerTerm.get_bnd_functions">
<code class="descname">get_bnd_functions</code><span class="sig-paren">(</span><em>c_in</em>, <em>uv_in</em>, <em>elev_in</em>, <em>bnd_id</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values tracer and uv for all supported
boundary conditions.</p>
<p>volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical scalar advection term</p>
<dl class="method">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">VerticalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical scalar diffusion term</p>
<dl class="method">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.tracer_eq.timed_region">
<code class="descclassname">thetis.tracer_eq.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.tracer_eq.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.tracer_eq.timed_stage">
<code class="descclassname">thetis.tracer_eq.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.tracer_eq.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.turbulence">
<span id="thetis-turbulence-module"></span><h2>thetis.turbulence module<a class="headerlink" href="#module-thetis.turbulence" title="Permalink to this headline">¶</a></h2>
<p>Generic Length Scale Turbulence Closure model [1].</p>
<p>This model solves two dynamic equations, for turbulent kinetic energy (tke, k)
and additional variable psi.</p>
<p>dk/dt + 
abla_h(uv*k) + d(w*k)/dz = d/dz(
u_h/sigma_k dk/dz) + P + B - eps
dpsi/dt + 
abla_h(uv*psi) + d(w*psi)/dz = d/dz(
u_h/sigma_psi dpsi/dz) +</p>
<blockquote>
<div>psi/k*(c1*P + c3*B - c2*eps*f_wall)</div></blockquote>
<p>P = viscosity M**2             (production)
B = - diffusivity N**2         (byoyancy production)
M**2 = (du/dz)**2 + (dv/dz)**2 (shear frequency)
N**2 = -g
ho_0 (drho/dz)      (buoyancy frequency)</p>
<p>The additional variable is defined as
psi = (cmu0)**p * k**m * l**n
where p, m, n parameters and cmu0 is an empirical constant.</p>
<p>dpsi/dt + 
abla_h(uv*psi) + d(w*psi)dz = d/dz(
u_h/sigma_psi dpsi/dz) +</p>
<blockquote>
<div>psi/k*(c1*P + c3*B - c2*eps*f_wall)</div></blockquote>
<p>Parameter c3 takes value c3_minus in stably stratified flows and c3_plus in
unstably stratified cases.</p>
<p>Turbulent length scale is obtained diagnostically as
l = (cmu0)**3 * k**(3/2) * eps**(-1)</p>
<p>TKE dissipation rate is given by
eps = (cmu0)**(3+p/n)*tke**(3/2+m/n)*psi**(-1/n)</p>
<p>Finally vertical eddy viscosity and diffusivity are obtained as</p>
<p>viscosity = c*sqrt(2*k)*l*stability_func_m
diffusivity = c*sqrt(2*k)*l*stability_func_rho</p>
<p>Stability functions are defined as obtained from [2] or [3].
Implementation follows [4].</p>
<dl class="docutils">
<dt>[1] Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for</dt>
<dd>geophysical turbulence models. Journal of Marine Research, 61:235&#8211;265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></dd>
<dt>[2] Kantha, L. H. and Clayson, C. A. (1994). An improved mixed layer model for</dt>
<dd>geophysical applications. Journal of Geophysical Research: Oceans,
99(C12):25235&#8211;25266.
<a class="reference external" href="http://dx.doi.org/10.1029/94JC02257">http://dx.doi.org/10.1029/94JC02257</a></dd>
<dt>[3] Canuto et al. (2001). Ocean Turbulence. Part I: One-Point Closure Model -</dt>
<dd>Momentum and Heat Vertical Diffusivities. Journal of Physical Oceanography,
31(6):1413-1426.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></dd>
<dt>[4] Warner et al. (2005). Performance of four turbulence closure models</dt>
<dd>implemented using a generic length scale method. Ocean Modelling,
8(1-2):81&#8211;113.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2003.12.003">http://dx.doi.org/10.1016/j.ocemod.2003.12.003</a></dd>
<dt>[5] Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models</dt>
<dd>for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795&#8211;827.
<a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></dd>
</dl>
<p>Tuomas Karna 2015-09-07</p>
<dl class="class">
<dt id="thetis.turbulence.BuoyFrequencySolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">BuoyFrequencySolver</code><span class="sig-paren">(</span><em>rho</em>, <em>n2</em>, <em>n2_tmp</em>, <em>minval=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes buoyancy frequency squared form the given horizontal
velocity field.</p>
<p>N^2 = -g/rho0 drho/dz</p>
<dl class="method">
<dt id="thetis.turbulence.BuoyFrequencySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GLSModelOptions">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GLSModelOptions</code><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a></p>
<p>Options for Generic Lenght Scale turbulence model</p>
<dl class="method">
<dt id="thetis.turbulence.GLSModelOptions.apply_defaults">
<code class="descname">apply_defaults</code><span class="sig-paren">(</span><em>closure_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions.apply_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.apply_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies default parameters for given closure name.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c1">
<code class="descname">c1</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c1" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c1 parameter for Psi equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c2">
<code class="descname">c2</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c2" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c2 parameter for Psi equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c3_minus">
<code class="descname">c3_minus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, stable stratification</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c3_plus">
<code class="descname">c3_plus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c3_plus" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, unstable stratification</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.closure_name">
<code class="descname">closure_name</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.closure_name" title="Permalink to this definition">¶</a></dt>
<dd><p>str: name of common closures</p>
<p>&#8216;k-epsilon&#8217;: k-epsilon setup
&#8216;k-omega&#8217;: k-epsilon setup
&#8216;gls-a&#8217;: Generic Length Scale setup A</p>
<p>Sets default values for parameters p, m, n, schmidt_nb_tke, schmidt_nb_psi, c1, c2, c3_plus, c3_minus,
f_wall, k_min, psi_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.cmu0">
<code class="descname">cmu0</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>float: cmu0 parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_c3_minus">
<code class="descname">compute_c3_minus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute c3_minus from ri_st</p>
<p>ri_st is the steady state gradient Richardson number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_cmu0">
<code class="descname">compute_cmu0</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute cmu0 from stability function parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_kappa">
<code class="descname">compute_kappa</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute von Karman constant from psi Schmidt number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_len_min">
<code class="descname">compute_len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute min_len from k_min and psi_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_psi_min">
<code class="descname">compute_psi_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_psi_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute psi_len from k_min and eps_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.diff_min">
<code class="descname">diff_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.diff_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy diffusivity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.eps_min">
<code class="descname">eps_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.eps_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for epsilon</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.f_wall">
<code class="descname">f_wall</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.f_wall" title="Permalink to this definition">¶</a></dt>
<dd><p>float: wall function parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.galperin_lim">
<code class="descname">galperin_lim</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.galperin_lim" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Galperin lenght scale limitation parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.k_min">
<code class="descname">k_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.k_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent kinetic energy</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.kappa">
<code class="descname">kappa</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>float: steady state gradient Richardson number</p>
<p>Used to compute c3_minus</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.len_min">
<code class="descname">len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent lenght scale</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_eps">
<code class="descname">limit_eps</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit on epsilon</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_len">
<code class="descname">limit_len</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_len" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_len_min">
<code class="descname">limit_len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: limit minimum turbulent length scale to len_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_psi">
<code class="descname">limit_psi</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit on psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.m">
<code class="descname">m</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.m" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter m for the definition of psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.n">
<code class="descname">n</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.n" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter n for the definition of psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.p">
<code class="descname">p</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.p" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter p for the definition of psi</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GLSModelOptions.print_summary">
<code class="descname">print_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions.print_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.print_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all defined parameters and their values.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.psi_min">
<code class="descname">psi_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.psi_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.schmidt_nb_psi">
<code class="descname">schmidt_nb_psi</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.schmidt_nb_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>float: psi Schmidt number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.schmidt_nb_tke">
<code class="descname">schmidt_nb_tke</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.schmidt_nb_tke" title="Permalink to this definition">¶</a></dt>
<dd><p>float: turbulent kinetic energy Schmidt number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.stability_name">
<code class="descname">stability_name</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.stability_name" title="Permalink to this definition">¶</a></dt>
<dd><p>str: name of used stability function family</p>
<p>&#8216;CA&#8217;: Canuto A
&#8216;CB&#8217;: Canuto B
&#8216;KC&#8217;: Kantha-Clayson
&#8216;CH&#8217;: Cheng</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.visc_min">
<code class="descname">visc_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.visc_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy viscosity</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GLSVerticalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>schmidt_nb</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="thetis.tracer_eq.VerticalDiffusionTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.VerticalDiffusionTerm</span></code></a></p>
<p>Vertical diffusion term where diffusivity is replaced by viscosity/Schmidt number.</p>
<dl class="method">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GenericLengthScaleModel">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GenericLengthScaleModel</code><span class="sig-paren">(</span><em>solver</em>, <em>k_field</em>, <em>psi_field</em>, <em>uv_field</em>, <em>rho_field</em>, <em>l_field</em>, <em>epsilon_field</em>, <em>eddy_diffusivity</em>, <em>eddy_viscosity</em>, <em>n2</em>, <em>m2</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Generic Length Scale turbulence closure model implementation</p>
<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes fields</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.postprocess">
<code class="descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>To be called after evaluating the equations.</p>
<p>Update all fields that depend on turbulence fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.preprocess">
<code class="descname">preprocess</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>To be called before evaluating the equations.</p>
<p>Update all fields that depend on velocity and density.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.P1Average">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">P1Average</code><span class="sig-paren">(</span><em>p0</em>, <em>p1</em>, <em>p1dg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Takes a DP field and computes nodal averages and stores in P1 field.</p>
<p>Source must be either a p0 or p1dg function.
The averaging operation is both mass conservative and positivity preserving.</p>
<dl class="method">
<dt id="thetis.turbulence.P1Average.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.turbulence.P1Average.update_volumes">
<code class="descname">update_volumes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average.update_volumes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average.update_volumes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.PsiEquation">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">PsiEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Psi equation without advection terms.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.PsiSourceTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">PsiSourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the TKE equation</p>
<dl class="method">
<dt id="thetis.turbulence.PsiSourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.ShearFrequencySolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">ShearFrequencySolver</code><span class="sig-paren">(</span><em>uv</em>, <em>m2</em>, <em>mu</em>, <em>mv</em>, <em>mu_tmp</em>, <em>minval=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical shear frequency squared form the given horizontal
velocity field.</p>
<p>M^2 = du/dz^2 + dv/dz^2</p>
<dl class="method">
<dt id="thetis.turbulence.ShearFrequencySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.SmoothVerticalGradSolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">SmoothVerticalGradSolver</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#SmoothVerticalGradSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.SmoothVerticalGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in a smooth(er) way.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or expression to differentiate.</li>
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where the solution will be stored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.SmoothVerticalGradSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#SmoothVerticalGradSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.SmoothVerticalGradSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.TKEEquation">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">TKEEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKEEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKEEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Turbulent kinetic energy equation without advection terms.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.TKESourceTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">TKESourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the TKE equation</p>
<dl class="method">
<dt id="thetis.turbulence.TKESourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.VerticalGradSolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">VerticalGradSolver</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em>, <em>solver_parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in the weak sense.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or expression to differentiate.</li>
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where the solution will be stored.
Must be in P0 space.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.VerticalGradSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.set_func_max_val">
<code class="descclassname">thetis.turbulence.</code><code class="descname">set_func_max_val</code><span class="sig-paren">(</span><em>f</em>, <em>maxval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_max_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_max_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a function</p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.set_func_min_val">
<code class="descclassname">thetis.turbulence.</code><code class="descname">set_func_min_val</code><span class="sig-paren">(</span><em>f</em>, <em>minval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_min_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_min_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a function</p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.timed_region">
<code class="descclassname">thetis.turbulence.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.timed_stage">
<code class="descclassname">thetis.turbulence.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.utility">
<span id="thetis-utility-module"></span><h2>thetis.utility module<a class="headerlink" href="#module-thetis.utility" title="Permalink to this headline">¶</a></h2>
<p>Utility functions and classes for 3D hydrostatic ocean model</p>
<p>Tuomas Karna 2015-02-21</p>
<dl class="class">
<dt id="thetis.utility.ALEMeshCoordinateUpdater">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ALEMeshCoordinateUpdater</code><span class="sig-paren">(</span><em>mesh</em>, <em>eta</em>, <em>bathymetry</em>, <em>z_coord</em>, <em>z_coord_ref</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshCoordinateUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshCoordinateUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Updates extrusion so that free surface mathces eta3d value</p>
<dl class="method">
<dt id="thetis.utility.ALEMeshCoordinateUpdater.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshCoordinateUpdater.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshCoordinateUpdater.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.AttrDict">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">AttrDict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#AttrDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.AttrDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both self[&#8216;key&#8217;] and self.key access to members.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python</a></p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.DensitySolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">DensitySolver</code><span class="sig-paren">(</span><em>salinity</em>, <em>temperature</em>, <em>density</em>, <em>eos_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Density is computed point-wise assuming that T,S and rho are in the same
function space.</p>
<dl class="method">
<dt id="thetis.utility.DensitySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ElementContinuity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ElementContinuity</code><span class="sig-paren">(</span><em>dg</em>, <em>horizontal_dg</em>, <em>vertical_dg</em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.ElementContinuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<p>A named tuple describing the continuity of an element.</p>
<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.dg">
<code class="descname">dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.horizontal_dg">
<code class="descname">horizontal_dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.horizontal_dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.vertical_dg">
<code class="descname">vertical_dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.vertical_dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.EquationOfState">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">EquationOfState</code><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Equation of State according to [1] for computing sea water density.</p>
<dl class="docutils">
<dt>[1] Jackett, D. R., McDougall, T. J., Feistel, R., Wright, D. G., and</dt>
<dd>Griffies, S. M. (2006). Algorithms for Density, Potential Temperature,
Conservative Temperature, and the Freezing Temperature of Seawater.
Journal of Atmospheric and Oceanic Technology, 23(12):1709-1728.</dd>
</dl>
<dl class="method">
<dt id="thetis.utility.EquationOfState.compute_rho">
<code class="descname">compute_rho</code><span class="sig-paren">(</span><em>s</em>, <em>th</em>, <em>p</em>, <em>rho0=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes sea water density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>S</strong> &#8211; Salinity expressed on the Practical Salinity Scale 1978</li>
<li><strong>Th</strong> &#8211; Potential temperature in Celsius</li>
<li><strong>p</strong> &#8211; Pressure in decibars (1 dbar = 1e4 Pa)</li>
<li><strong>rho0</strong> &#8211; Optional reference density</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Th is referenced to pressure p_r = 0 dbar. All pressures are gauge
pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.
Last optional argument rho0 is for computing deviation
rho&#8217; = rho(S, Th, p) - rho0.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ExpandFunctionTo3d">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ExpandFunctionTo3d</code><span class="sig-paren">(</span><em>input_2d</em>, <em>output_3d</em>, <em>elem_height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Copies a field from 2d mesh to 3d mesh, assigning the same value over the
vertical dimension. Horizontal function space must be the same.</p>
<dl class="method">
<dt id="thetis.utility.ExpandFunctionTo3d.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.FieldDict">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">FieldDict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#FieldDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FieldDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a></p>
<p>AttrDict that checks that all added fields have proper meta data.</p>
<p>Values can be either Function or Constant objects.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.FrozenClass">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">FrozenClass</code><a class="reference internal" href="_modules/thetis/utility.html#FrozenClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FrozenClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A class where creating a new attribute will raise an exception if _isfrozen == True</p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.HorizontalJumpDiffusivity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">HorizontalJumpDiffusivity</code><span class="sig-paren">(</span><em>alpha</em>, <em>tracer</em>, <em>output</em>, <em>h_elem_size</em>, <em>umag</em>, <em>tracer_mag</em>, <em>max_val</em>, <em>min_val=1e-06</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#HorizontalJumpDiffusivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.HorizontalJumpDiffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes tracer jump diffusivity for horizontal advection.</p>
<dl class="method">
<dt id="thetis.utility.HorizontalJumpDiffusivity.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#HorizontalJumpDiffusivity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.HorizontalJumpDiffusivity.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.LinearEquationOfState">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">LinearEquationOfState</code><span class="sig-paren">(</span><em>rho_ref</em>, <em>alpha</em>, <em>beta</em>, <em>th_ref</em>, <em>s_ref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Linear Equation of State.</p>
<p>rho = rho_ref - alpha*(T - T_ref) + beta*(S - S_ref)</p>
<dl class="method">
<dt id="thetis.utility.LinearEquationOfState.compute_rho">
<code class="descname">compute_rho</code><span class="sig-paren">(</span><em>s</em>, <em>th</em>, <em>p</em>, <em>rho0=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes sea water density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>S</strong> &#8211; Salinity expressed on the Practical Salinity Scale 1978</li>
<li><strong>Th</strong> &#8211; Potential temperature in Celsius</li>
<li><strong>p</strong> &#8211; Pressure in decibars (1 dbar = 1e4 Pa)</li>
<li><strong>rho0</strong> &#8211; Optional reference density</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Pressure is ingored in this equation of state.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.MeshVelocitySolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">MeshVelocitySolver</code><span class="sig-paren">(</span><em>solver</em>, <em>eta</em>, <em>uv</em>, <em>w</em>, <em>w_mesh</em>, <em>w_mesh_surf</em>, <em>w_mesh_surf_2d</em>, <em>w_mesh_ddz_3d</em>, <em>bathymetry</em>, <em>z_coord_ref</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#MeshVelocitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.MeshVelocitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical mesh velocity for moving sigma mesh</p>
<dl class="method">
<dt id="thetis.utility.MeshVelocitySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#MeshVelocitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.MeshVelocitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ParabolicViscosity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ParabolicViscosity</code><span class="sig-paren">(</span><em>uv_bottom</em>, <em>bottom_drag</em>, <em>bathymetry</em>, <em>nu</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ParabolicViscosity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ParabolicViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes parabolic eddy viscosity profile assuming log layer flow
nu = kappa * u_bf * (-z) * (bath + z0 + z) / (bath + z0)
with
u_bf = sqrt(Cd)*|uv_bottom|</p>
<dl class="method">
<dt id="thetis.utility.ParabolicViscosity.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ParabolicViscosity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ParabolicViscosity.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SmagorinskyViscosity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SmagorinskyViscosity</code><span class="sig-paren">(</span><em>uv</em>, <em>output</em>, <em>c_s</em>, <em>h_elem_size</em>, <em>max_val</em>, <em>min_val=1e-10</em>, <em>weak_form=True</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes Smagorinsky subgrid scale viscosity.</p>
<p>This formulation is according to [1] and [2].</p>
<p>nu = (C_s L_x)**2 <a href="#id1"><span class="problematic" id="id2">|S|</span></a>
<a href="#id3"><span class="problematic" id="id4">|S|</span></a> = sqrt(D_T**2 + D_S**2)
D_T = du/dx - dv/dy
D_S = du/dy + dv/dx
L_x is the horizontal element size
C_s is the Smagorinsky coefficient</p>
<p>To match a certain mesh Reynolds number Re_h set
C_s = 1/sqrt(Re_h)</p>
<dl class="docutils">
<dt>[1] Ilicak et al. (2012). Spurious dianeutral mixing and the role of</dt>
<dd>momentum closure. Ocean Modelling, 45-46(0):37-58.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2011.10.003">http://dx.doi.org/10.1016/j.ocemod.2011.10.003</a></dd>
<dt>[2] Griffies and Hallberg (2000). Biharmonic friction with a</dt>
<dd>Smagorinsky-like viscosity for use in large-scale eddy-permitting
ocean models. Monthly Weather Review, 128(8):2935-2946.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2</a></dd>
</dl>
<dl class="method">
<dt id="thetis.utility.SmagorinskyViscosity.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SubFunctionExtractor">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SubFunctionExtractor</code><span class="sig-paren">(</span><em>input_3d</em>, <em>output_2d</em>, <em>boundary='top'</em>, <em>elem_facet=None</em>, <em>elem_height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Extract a 2D subfunction from a 3D extruded mesh.</p>
<p>input_3d: Function in 3d mesh
output_2d: Function in 2d mesh
boundary: &#8216;top&#8217;|&#8217;bottom&#8217;</p>
<blockquote>
<div>Defines whether to extract from the surface or bottom 3D elements</div></blockquote>
<dl class="docutils">
<dt>elem_facet: &#8216;top&#8217;|&#8217;bottom&#8217;|&#8217;average&#8217;</dt>
<dd>Defines which facet of the 3D element is extracted. The &#8216;average&#8217;
computes mean of the top and bottom facets of the 3D element.</dd>
<dt>elem_height: Function in 2d mesh</dt>
<dd>Function that defines the element heights
(required for Raviart-Thomas spaces only)</dd>
</dl>
<dl class="method">
<dt id="thetis.utility.SubFunctionExtractor.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SumFunction">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SumFunction</code><a class="reference internal" href="_modules/thetis/utility.html#SumFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Helper class to keep track of sum of Coefficients.</p>
<dl class="method">
<dt id="thetis.utility.SumFunction.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>coeff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a coefficient to self</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.SumFunction.get_sum">
<code class="descname">get_sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.get_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.get_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sum of all added Coefficients</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VelocityMagnitudeSolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VelocityMagnitudeSolver</code><span class="sig-paren">(</span><em>solution</em>, <em>u=None</em>, <em>w=None</em>, <em>min_val=1e-06</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes magnitude of (u[0],u[1],w) and stores it in solution</p>
<dl class="method">
<dt id="thetis.utility.VelocityMagnitudeSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VerticalIntegrator">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VerticalIntegrator</code><span class="sig-paren">(</span><em>input</em>, <em>output</em>, <em>bottom_to_top=True</em>, <em>bnd_value=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>5)</em>, <em>average=False</em>, <em>bathymetry=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical integral of the scalar field in the output
function space.</p>
<dl class="method">
<dt id="thetis.utility.VerticalIntegrator.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VerticalVelocitySolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VerticalVelocitySolver</code><span class="sig-paren">(</span><em>solution</em>, <em>uv</em>, <em>bathymetry</em>, <em>boundary_funcs={}</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical velocity from continuity equation</p>
<dl class="method">
<dt id="thetis.utility.VerticalVelocitySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.utility.beta_plane_coriolis_function">
<code class="descclassname">thetis.utility.</code><code class="descname">beta_plane_coriolis_function</code><span class="sig-paren">(</span><em>degrees</em>, <em>out_function</em>, <em>y_offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates beta plane Coriolis parameter to the given functions.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.beta_plane_coriolis_params">
<code class="descclassname">thetis.utility.</code><code class="descname">beta_plane_coriolis_params</code><span class="sig-paren">(</span><em>latitude</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes beta plane parameters based on the latitude (given in degrees).</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_tracer_mass_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_tracer_mass_3d</code><span class="sig-paren">(</span><em>scalar_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_volume_2d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_volume_2d</code><span class="sig-paren">(</span><em>eta</em>, <em>bath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_volume_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_volume_3d</code><span class="sig-paren">(</span><em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_baroclinic_head">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_baroclinic_head</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_baroclinic_head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_baroclinic_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes baroclinic head from density field</p>
<p>r = 1/rho_0 int_{z=-h}^{eta} rho&#8217; dz</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_bottom_drag">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_bottom_drag</code><span class="sig-paren">(</span><em>z_bottom</em>, <em>drag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_bottom_drag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_bottom_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bottom drag coefficient (Cd) from boundary log layer.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_bottom_friction">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_bottom_friction</code><span class="sig-paren">(</span><em>solver</em>, <em>uv_3d</em>, <em>uv_bottom_2d</em>, <em>z_bottom_2d</em>, <em>bathymetry_2d</em>, <em>bottom_drag_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_bottom_friction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_bottom_friction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_boundary_length">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_boundary_length</code><span class="sig-paren">(</span><em>mesh2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_boundary_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_boundary_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the length of the boundary segments in 2d mesh.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_elem_height">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_elem_height</code><span class="sig-paren">(</span><em>zcoord</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_elem_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_elem_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute element heights on an extruded mesh.
zcoord (P1CG) contains zcoordinates of the mesh
element height is stored in output function (typ. P1DG).</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.create_directory">
<code class="descclassname">thetis.utility.</code><code class="descname">create_directory</code><span class="sig-paren">(</span><em>path</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#create_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.create_directory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="thetis.utility.element_continuity">
<code class="descclassname">thetis.utility.</code><code class="descname">element_continuity</code><span class="sig-paren">(</span><em>fiat_element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#element_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.element_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal"><span class="pre">ElementContinuity</span></code></a> instance with the
continuity of a given element.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fiat_element</strong> &#8211; The fiat element to determine the continuity
of.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A new <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal"><span class="pre">ElementContinuity</span></code></a> instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.extrude_mesh_sigma">
<code class="descclassname">thetis.utility.</code><code class="descname">extrude_mesh_sigma</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>n_layers</em>, <em>bathymetry_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extrude_mesh_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.extrude_mesh_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrudes 2d surface mesh with bathymetry data defined in a 2d field.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_horizontal_elem_size_2d">
<code class="descclassname">thetis.utility.</code><code class="descname">get_horizontal_elem_size_2d</code><span class="sig-paren">(</span><em>sol2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh, stores the output in
the given field.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_horizontal_elem_size_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">get_horizontal_elem_size_3d</code><span class="sig-paren">(</span><em>sol2d</em>, <em>sol3d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh, then copies it on a 3D
field.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_zcoord_from_mesh">
<code class="descclassname">thetis.utility.</code><code class="descname">get_zcoord_from_mesh</code><span class="sig-paren">(</span><em>zcoord</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_zcoord_from_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_zcoord_from_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates z coordinates from the 3D mesh</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.tensor_jump">
<code class="descclassname">thetis.utility.</code><code class="descname">tensor_jump</code><span class="sig-paren">(</span><em>v</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#tensor_jump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.tensor_jump" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump term for vector functions based on the tensor product.
This is the discrete equivalent of grad(u) as opposed to the normal vectorial
jump which represents div(u).</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.timed_region">
<code class="descclassname">thetis.utility.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.timed_stage">
<code class="descclassname">thetis.utility.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-thetis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="thetis.timed_region">
<code class="descclassname">thetis.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.timed_stage">
<code class="descclassname">thetis.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Tuomas Karna et al..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>