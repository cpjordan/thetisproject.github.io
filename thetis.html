<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>thetis package &#8212; Thetis 0+untagged.833.g086f878 documentation</title>
    
    <link rel="stylesheet" href="_static/thetis.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0+untagged.833.g086f878',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="_static/featured.css"> -->


<link rel="shortcut icon" href="_static/icon_thetis.ico" />


  </head>
  <body role="document">
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
        <li class="page_item"><a href="https://travis-ci.org/thetisproject/thetis" title="Thetis on Travis">Travis</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="thetis">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="thetis-package">
<h1>thetis package<a class="headerlink" href="#thetis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thetis.callback">
<span id="thetis-callback-module"></span><h2>thetis.callback module<a class="headerlink" href="#module-thetis.callback" title="Permalink to this headline">¶</a></h2>
<p>Defines custom callback functions used to compute various metrics at runtime.</p>
<dl class="class">
<dt id="thetis.callback.CallbackManager">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">CallbackManager</code><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/collections.html#collections.defaultdict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">collections.defaultdict</span></code></a></p>
<p>Stores callbacks in different categories and provides methods for
evaluating them.</p>
<p>Create callbacks and register them under <code class="docutils literal"><span class="pre">'export'</span></code> mode</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cb1</span> <span class="o">=</span> <span class="n">VolumeConservation3DCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">TracerMassConservationCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">CallbackManager</span><span class="p">()</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb2</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluate callbacks, calls <a class="reference internal" href="#thetis.callback.CallbackManager.evaluate" title="thetis.callback.CallbackManager.evaluate"><code class="xref py py-func docutils literal"><span class="pre">evaluate()</span></code></a> method of all callbacks registered
in the given mode.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="thetis.callback.CallbackManager.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>callback</em>, <em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a callback under the given mode</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>callback</strong> &#8211; a <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticCallback</span></code></a> object</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; register callback under this mode</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.CallbackManager.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.CallbackManager.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate all callbacks registered under the given mode</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.DiagnosticCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">DiagnosticCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=True</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A base class for all Callback classes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf file (if enabled)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> &#8211; If provided, these will be the return value from <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.callback.DiagnosticCallback.name">
<code class="descname">name</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.push_to_hdf5">
<code class="descname">push_to_hdf5</code><span class="sig-paren">(</span><em>time</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_hdf5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Append values to HDF5 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> &#8211; time stamp of entry</li>
<li><strong>args</strong> &#8211; the return value from <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.callback.DiagnosticCallback.push_to_log">
<code class="descname">push_to_log</code><span class="sig-paren">(</span><em>time</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Push callback status message to log</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> &#8211; time stamp of entry</li>
<li><strong>args</strong> &#8211; the return value from <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.callback.DiagnosticCallback.variable_names">
<code class="descname">variable_names</code><a class="headerlink" href="#thetis.callback.DiagnosticCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.DiagnosticHDF5">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">DiagnosticHDF5</code><span class="sig-paren">(</span><em>filename</em>, <em>varnames</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A HDF5 file for storing diagnostic time series arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Full filename of the HDF5 file.</li>
<li><strong>varnames</strong> &#8211; List of variable names that the diagnostic callback
provides</li>
<li><strong>comm</strong> &#8211; MPI communicator</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.callback.DiagnosticHDF5.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>time</em>, <em>variables</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a new entry of (time, variables) to the file.</p>
<p>The HDF5 is updated immediately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time stamp of entry</li>
<li><strong>variables</strong> (<em>tuple of float</em>) &#8211; values of entry</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.MinMaxConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">MinMaxConservationCallback</code><span class="sig-paren">(</span><em>minmax_callback</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a minimum/maximum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>minmax_callback</strong> &#8211; Python function that takes the solver object as
an argument and returns a (min, max) value tuple</li>
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.callback.MinMaxConservationCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.callback.MinMaxConservationCallback.variable_names">
<code class="descname">variable_names</code><em class="property"> = ['min_value', 'max_value', 'undershoot', 'overshoot']</em><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.ScalarConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">ScalarConservationCallback</code><span class="sig-paren">(</span><em>scalar_callback</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a scalar quantity</p>
<p>Creates scalar conservation check callback object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scalar_callback</strong> &#8211; Python function that takes the solver object as an argument and
returns a scalar quantity of interest</li>
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.callback.ScalarConservationCallback.message_str">
<code class="descname">message_str</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback.message_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.message_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.callback.ScalarConservationCallback.variable_names">
<code class="descname">variable_names</code><em class="property"> = ['integral', 'relative_difference']</em><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.variable_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.TracerMassConservationCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">TracerMassConservationCallback</code><span class="sig-paren">(</span><em>tracer_name</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of total tracer mass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tracer_name</strong> &#8211; Name of the tracer. Use canonical field names as in <a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal"><span class="pre">FieldDict</span></code></a>.</li>
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.callback.TracerMassConservationCallback.name">
<code class="descname">name</code><em class="property"> = 'tracer mass'</em><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.TracerOvershootCallBack">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">TracerOvershootCallBack</code><span class="sig-paren">(</span><em>tracer_name</em>, <em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerOvershootCallBack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.MinMaxConservationCallback" title="thetis.callback.MinMaxConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.MinMaxConservationCallback</span></code></a></p>
<p>Checks overshoots of the given tracer field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tracer_name</strong> &#8211; Name of the tracer. Use canonical field names as in <a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal"><span class="pre">FieldDict</span></code></a>.</li>
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.callback.TracerOvershootCallBack.name">
<code class="descname">name</code><em class="property"> = 'tracer overshoot'</em><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.VolumeConservation2DCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">VolumeConservation2DCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation2DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 2D volume (integral of water elevation field)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.callback.VolumeConservation2DCallback.name">
<code class="descname">name</code><em class="property"> = 'volume2d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.callback.VolumeConservation3DCallback">
<em class="property">class </em><code class="descclassname">thetis.callback.</code><code class="descname">VolumeConservation3DCallback</code><span class="sig-paren">(</span><em>solver_obj</em>, <em>outputdir=None</em>, <em>export_to_hdf5=False</em>, <em>append_to_log=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation3DCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal"><span class="pre">thetis.callback.ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 3D volume (volume of 3D mesh)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solver_obj</strong> &#8211; Thetis solver object</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Custom directory where hdf5 files will be stored. By
default solver&#8217;s output directory is used.</li>
<li><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, diagnostics will be stored in hdf5
format</li>
<li><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, callback output messages will be printed
in log</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.callback.VolumeConservation3DCallback.name">
<code class="descname">name</code><em class="property"> = 'volume3d'</em><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.callback.timed_region">
<code class="descclassname">thetis.callback.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.callback.timed_stage">
<code class="descclassname">thetis.callback.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.callback.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.coupled_timeintegrator">
<span id="thetis-coupled-timeintegrator-module"></span><h2>thetis.coupled_timeintegrator module<a class="headerlink" href="#module-thetis.coupled_timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Time integrators for solving coupled 2D-3D system of equations.</p>
<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledERKALE</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledERKALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Implicit-Explicit SSP RK solver for conservative ALE formulation</p>
<p>A fully explicit mode-split time integrator where both the 2D and 3D modes
use the same time step. The time step is typically chosen to match the 2D
surface gravity wave speed. Only vertical diffusion is treated implicitly.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledERKALE.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</li>
<li><strong>update_forcings3d</strong> &#8211; Optional user defined function that updates
boundary conditions of the 3D equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE.compute_mesh_velocity">
<code class="descname">compute_mesh_velocity</code><span class="sig-paren">(</span><em>i_stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledERKALE.compute_mesh_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE.compute_mesh_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mesh velocity from 2D solver runge-kutta scheme</p>
<p>Mesh velocity is solved from the Runge-Kutta coefficients of the
implicit 2D solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i_stage</strong> &#8211; state of the Runge-Kutta iteration</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKLPUM2</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKLPUM2ALE</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledERKALE.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledERKALE.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">BackwardEuler</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledIMEXALE</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledIMEXALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Implicit-Explicit SSP RK solver for conservative ALE formulation</p>
<p>Advances the 2D-3D system with IMEX scheme: the free surface gravity waves
are solved with the implicit scheme while all other terms are solved with the
explicit scheme. Vertical diffusion is however solved with a separate
implicit scheme (backward Euler) for efficiency.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledIMEXALE.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</li>
<li><strong>update_forcings3d</strong> &#8211; Optional user defined function that updates
boundary conditions of the 3D equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE.compute_mesh_velocity">
<code class="descname">compute_mesh_velocity</code><span class="sig-paren">(</span><em>i_stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledIMEXALE.compute_mesh_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE.compute_mesh_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mesh velocity from 2D solver runge-kutta scheme</p>
<p>Mesh velocity is solved from the Runge-Kutta coefficients of the
implicit 2D solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i_stage</strong> &#8211; state of the Runge-Kutta iteration</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">IMEXLPUM2</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKLPUM2ALE</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledIMEXALE.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">BackwardEuler</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledLeapFrogAM3</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 time integrator for coupled 2D-3D problem</p>
<p>This is an ALE time integrator.
Implementation follows the SLIM time integrator by Karna et al (2013)</p>
<p>Karna, et al. (2013). A baroclinic discontinuous Galerkin finite element
model for coastal flows. Ocean Modelling, 61(0):1-20.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2012.09.009">http://dx.doi.org/10.1016/j.ocemod.2012.09.009</a></p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</li>
<li><strong>update_forcings3d</strong> &#8211; Optional user defined function that updates
boundary conditions of the 3D equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">DIRK22</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">LeapFrogAM3</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">BackwardEuler</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledSSPRKSemiImplicit</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Solves coupled equations with SSPRK33 time integrator using the same time
step for the 2D and 3D modes.</p>
<p>In the 2D mode the surface gravity waves are solved semi-implicitly. This
allows longer time steps but diffuses free surface waves.</p>
<p>This time integrator uses a static 3D mesh. It is not compliant with the
ALE moving mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>solver</strong> &#8211; <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code></a> object</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledSSPRKSemiImplicit.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</li>
<li><strong>update_forcings3d</strong> &#8211; Optional user defined function that updates
boundary conditions of the 3D equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">SSPRK33SemiImplicit</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">SSPRK33</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledSSPRKSemiImplicit.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">BackwardEuler</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledTimeIntegrator</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegratorBase</span></code></a></p>
<p>Base class of mode-split time integrators that use 2D, 3D and implicit 3D
time integrators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>solver</strong> &#8211; <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code></a> object</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for 2D equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for explicit 3D equations (momentum, tracers)</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>time integrator for implicit 3D equations (vertical diffusion)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt">
<code class="descname">set_dt</code><span class="sig-paren">(</span><em>dt</em>, <em>dt_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Set time step for the coupled time integrator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time step. This is the master (macro) time step used to
march the 3D equations.</li>
<li><strong>dt_2d</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time step for 2D equations. For consistency
<code class="xref py py-attr docutils literal"><span class="pre">dt_2d</span></code> must be an integer fraction of <code class="xref py py-attr docutils literal"><span class="pre">dt</span></code>.
If 2D solver is implicit set <code class="xref py py-attr docutils literal"><span class="pre">dt_2d</span></code> equal to <code class="xref py py-attr docutils literal"><span class="pre">dt</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledTimeIntegratorBase</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegratorBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegratorBase</span></code></a></p>
<p>Base class for coupled 2D-3D time integrators</p>
<p>Provides common functionality for updating diagnostic fields etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>solver</strong> &#8211; <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code></a> object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK">
<em class="property">class </em><code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">CoupledTwoStageRK</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.coupled_timeintegrator.CoupledTimeIntegrator</span></code></a></p>
<p>Coupled time integrator based on SSPRK(2,2) scheme</p>
<p>This ALE time integration method uses SSPRK(2,2) scheme to advance the 3D
equations and a compatible implicit Trapezoid method to advance the 2D
equations. Backward Euler scheme is used for vertical diffusion.</p>
<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em>, <em>update_forcings3d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</li>
<li><strong>update_forcings3d</strong> &#8211; Optional user defined function that updates
boundary conditions of the 3D equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity">
<code class="descname">compute_mesh_velocity</code><span class="sig-paren">(</span><em>istage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.compute_mesh_velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mesh velocity for stage i</p>
<p>Must be called after updating the 2D mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; stage of the Runge-Kutta iteration</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d">
<code class="descname">integrator_2d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">TwoStageTrapezoid</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d">
<code class="descname">integrator_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">SSPRK22ALE</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d">
<code class="descname">integrator_vert_3d</code><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">BackwardEuler</span></code></p>
</dd></dl>

<dl class="method">
<dt id="thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation">
<code class="descname">store_elevation</code><span class="sig-paren">(</span><em>istage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.store_elevation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation" title="Permalink to this definition">¶</a></dt>
<dd><p>Store current elevation field for computing mesh velocity</p>
<p>Must be called before updating the 2D mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; stage of the Runge-Kutta iteration</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.coupled_timeintegrator.timed_region">
<code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.coupled_timeintegrator.timed_stage">
<code class="descclassname">thetis.coupled_timeintegrator.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.coupled_timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.equation">
<span id="thetis-equation-module"></span><h2>thetis.equation module<a class="headerlink" href="#module-thetis.equation" title="Permalink to this headline">¶</a></h2>
<p>Implements Equation and Term classes.</p>
<dl class="class">
<dt id="thetis.equation.Equation">
<em class="property">class </em><code class="descclassname">thetis.equation.</code><code class="descname">Equation</code><span class="sig-paren">(</span><em>function_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Implements an equation, made out of terms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function_space</strong> &#8211; the <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> the solution belongs to</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.equation.Equation.SUPPORTED_LABELS">
<code class="descname">SUPPORTED_LABELS</code><em class="property"> = ['source', 'explicit', 'implicit', 'nonlinear']</em><a class="headerlink" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid labels for terms, indicating how they should be treated in the time
integrator.</p>
<dl class="docutils">
<dt>source</dt>
<dd>The term is a source term, i.e. does not depend on the solution.</dd>
<dt>explicit</dt>
<dd>The term should be treated explicitly</dd>
<dt>implicit</dt>
<dd>The term should be treated implicitly</dd>
<dt>nonlinear</dt>
<dd>The term is nonlinear and should be treated fully implicitly</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.add_term">
<code class="descname">add_term</code><span class="sig-paren">(</span><em>term</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.add_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.add_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a term in the equation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>term</strong> &#8211; <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">Term</span></code></a> object to add_term</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Assign a label to the term. Valid labels are given by
<a class="reference internal" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="thetis.equation.Equation.SUPPORTED_LABELS"><code class="xref py py-attr docutils literal"><span class="pre">SUPPORTED_LABELS</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.jacobian">
<code class="descname">jacobian</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian by summing up all the Jacobians of the terms.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.label_term">
<code class="descname">label_term</code><span class="sig-paren">(</span><em>key</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.label_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.label_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Assings a label to the given term(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>term</strong> &#8211; <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">Term</span></code></a> object, or a tuple of terms</li>
<li><strong>label</strong> &#8211; string label to assign</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.mass_term">
<code class="descname">mass_term</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.mass_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.mass_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">UFL form of the mass term</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> &#8211; string defining the type of terms to sum up. Currently one of
&#8216;source&#8217;|&#8217;explicit&#8217;|&#8217;implicit&#8217;|&#8217;nonlinear&#8217;. Can be a list of multiple labels, or &#8216;all&#8217; in which
case all defined terms are summed.</li>
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Equation.select_terms">
<code class="descname">select_terms</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.select_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Equation.select_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator function that selects terms by label(s).</p>
<p>label can be a single label (e.g. &#8216;explicit&#8217;), &#8216;all&#8217; or a tuple of
labels.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.equation.Term">
<em class="property">class </em><code class="descclassname">thetis.equation.</code><code class="descname">Term</code><span class="sig-paren">(</span><em>function_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Implements a single term of an equation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sign convention: all terms are assumed to be on the left hand side of the equation A + term = 0.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function_space</strong> &#8211; the <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> the solution belongs to</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.equation.Term.jacobian">
<code class="descname">jacobian</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian of the term.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.equation.Term.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.equation.Term.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> &#8211; solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the corresponding equation</li>
<li><strong>solution_old</strong> &#8211; a time lagged solution <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>fields</strong> &#8211; a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></li>
<li><strong>fields_old</strong> &#8211; Time lagged dictionary of fields</li>
<li><strong>bnd_conditions</strong> &#8211; A dictionary describing boundary conditions.
E.g. {3: {&#8216;elev_2d&#8217;: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.equation.timed_region">
<code class="descclassname">thetis.equation.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.equation.timed_stage">
<code class="descclassname">thetis.equation.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.equation.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.exporter">
<span id="thetis-exporter-module"></span><h2>thetis.exporter module<a class="headerlink" href="#module-thetis.exporter" title="Permalink to this headline">¶</a></h2>
<p>Routines for handling file exports.</p>
<dl class="class">
<dt id="thetis.exporter.ExportManager">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">ExportManager</code><span class="sig-paren">(</span><em>outputdir</em>, <em>fields_to_export</em>, <em>functions</em>, <em>field_metadata</em>, <em>export_type='vtk'</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Helper object for exporting multiple fields simultaneously</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.field_defs</span> <span class="kn">import</span> <span class="n">field_metadata</span>
<span class="n">field_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="o">...</span><span class="p">}</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">ExportManager</span><span class="p">(</span><span class="s1">&#39;mydirectory&#39;</span><span class="p">,</span>
                           <span class="p">[</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">,</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">,</span> <span class="n">salt_3d</span><span class="s1">&#39;],</span>
                           <span class="n">field_dict</span><span class="p">,</span>
                           <span class="n">field_metadata</span><span class="p">,</span>
                           <span class="n">export_type</span><span class="o">=</span><span class="s1">&#39;vtk&#39;</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; directory where files are stored</li>
<li><strong>fields_to_export</strong> (<em>list of strings</em>) &#8211; list of fields to export</li>
<li><strong>functions</strong> &#8211; dict that contains all existing <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> s</li>
<li><strong>field_metadata</strong> &#8211; dict of all field metadata.
See <a class="reference internal" href="#module-thetis.field_defs" title="thetis.field_defs"><code class="xref py py-mod docutils literal"><span class="pre">field_defs</span></code></a></li>
<li><strong>export_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; export format, either &#8216;vtk&#8217; or &#8216;hdf5&#8217;</li>
<li><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; index for next export (default 0)</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; print debug info to stdout</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.exporter.ExportManager.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all designated functions to disk</p>
<p>Increments export index by 1.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExportManager.export_bathymetry">
<code class="descname">export_bathymetry</code><span class="sig-paren">(</span><em>bathymetry_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export_bathymetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export_bathymetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function to export 2D bathymetry data to disk</p>
<p>Bathymetry does not vary in time so this only needs to be called once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bathymetry_2d</strong> &#8211; 2D bathymetry <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExportManager.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExportManager.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set export index to all child exporters</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.ExporterBase">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">ExporterBase</code><span class="sig-paren">(</span><em>filename</em>, <em>outputdir</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base class for exporter objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; output file name (without directory)</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; directory where file is stored</li>
<li><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; set the index for next output</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; print debug info to stdout</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.exporter.ExporterBase.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.ExporterBase.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.HDF5Exporter">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">HDF5Exporter</code><span class="sig-paren">(</span><em>function_space</em>, <em>outputdir</em>, <em>filename_prefix</em>, <em>next_export_ix=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Stores fields in disk in native discretization using HDF5 containers</p>
<p>Create exporter object for given function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> (<code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code>) &#8211; space where the exported functions belong</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; directory where outputs will be stored</li>
<li><strong>filename_prefix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; prefix of output filename. Filename is
prefix_nnnnn.h5 where nnnnn is the export number.</li>
<li><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; index for next export (default 0)</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; print debug info to stdout</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export function to disk.</p>
<p>Increments export index by 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> to export</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.export_as_index">
<code class="descname">export_as_index</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export_as_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export_as_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Export function to disk using the specified export index number</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; export index &gt;= 0</li>
<li><strong>function</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> to export</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.gen_filename">
<code class="descname">gen_filename</code><span class="sig-paren">(</span><em>iexport</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.gen_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.gen_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate file name &#8216;prefix_nnnnn.h5&#8217; for i-th export</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; export index &gt;= 0</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.HDF5Exporter.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>iexport</em>, <em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads nodal values from disk and assigns to the given function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; export index &gt;= 0</li>
<li><strong>function</strong> &#8211; target <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.exporter.VTKExporter">
<em class="property">class </em><code class="descclassname">thetis.exporter.</code><code class="descname">VTKExporter</code><span class="sig-paren">(</span><em>fs_visu</em>, <em>func_name</em>, <em>outputdir</em>, <em>filename</em>, <em>next_export_ix=0</em>, <em>project_output=False</em>, <em>coords_dg=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.exporter.ExporterBase</span></code></a></p>
<p>Class that handles Paraview VTK file exports</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fs_visu</strong> &#8211; function space where input function will be cast
before exporting</li>
<li><strong>func_name</strong> &#8211; name of the function</li>
<li><strong>outputdir</strong> &#8211; output directory</li>
<li><strong>filename</strong> &#8211; name of the pvd file</li>
<li><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; index for next export (default 0)</li>
<li><strong>project_output</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; project function to output space instead of
interpolating</li>
<li><strong>coords_dg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Discontinuous coordinate field. Needed to avoid
allocating new coordinate field in case of discontinuous export
functions.</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; print debug info to stdout</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.exporter.VTKExporter.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="method">
<dt id="thetis.exporter.VTKExporter.set_next_export_ix">
<code class="descname">set_next_export_ix</code><span class="sig-paren">(</span><em>next_export_ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.set_next_export_ix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.set_next_export_ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.exporter.get_visu_space">
<code class="descclassname">thetis.exporter.</code><code class="descname">get_visu_space</code><span class="sig-paren">(</span><em>fs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#get_visu_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.get_visu_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an appropriate VTK visualization space for a function space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fs</strong> &#8211; function space</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">function space for VTK visualization</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.is_2d">
<code class="descclassname">thetis.exporter.</code><code class="descname">is_2d</code><span class="sig-paren">(</span><em>fs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#is_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.exporter.is_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests wether a function space is 2D or 3D</p>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.timed_region">
<code class="descclassname">thetis.exporter.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.exporter.timed_stage">
<code class="descclassname">thetis.exporter.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.exporter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.field_defs">
<span id="thetis-field-defs-module"></span><h2>thetis.field_defs module<a class="headerlink" href="#module-thetis.field_defs" title="Permalink to this headline">¶</a></h2>
<p>Definitions and meta data of fields</p>
<dl class="data">
<dt id="thetis.field_defs.field_metadata">
<code class="descclassname">thetis.field_defs.</code><code class="descname">field_metadata</code><em class="property"> = {'v_elem_size_3d': {'shortname': 'Vertical element size', 'name': 'Element size in vertical direction', 'unit': 'm', 'filename': 'VElemSize3d'}, 'elev_cg_3d': {'shortname': 'Elevation', 'name': 'Water elevation CG', 'unit': 'm', 'filename': 'ElevationCG3d'}, 'density_3d': {'shortname': 'Density', 'name': 'Water density', 'unit': 'kg m-3', 'filename': 'Density3d'}, 'buoy_freq_3d': {'shortname': 'Buoyancy frequency squared', 'name': 'Buoyancy frequency squared', 'unit': 's-2', 'filename': 'BuoyFreq3d'}, 'eps_3d': {'shortname': 'TKE dissipation rate', 'name': 'TKE dissipation rate', 'unit': 'm2 s-2', 'filename': 'TurbEps3d'}, 'h_elem_size_2d': {'shortname': 'Horizontal element size', 'name': 'Element size in horizontal direction', 'unit': 'm', 'filename': 'h_elem_size_2d'}, 'shear_freq_3d': {'shortname': 'Vertical shear frequency squared', 'name': 'Vertical shear frequency squared', 'unit': 's-2', 'filename': 'ShearFreq3d'}, 'baroc_head_3d': {'shortname': 'Baroclinic head', 'name': 'Baroclinic head', 'unit': 'm', 'filename': 'BaroHead3d'}, 'eddy_visc_3d': {'shortname': 'Eddy Viscosity', 'name': 'Eddy Viscosity', 'unit': 'm2 s-1', 'filename': 'EddyVisc3d'}, 'uv_mag_3d': {'shortname': 'Velocity magnitude', 'name': 'Magnitude of horizontal velocity', 'unit': 'm s-1', 'filename': 'VeloMag3d'}, 'uv_dav_2d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'DAVelocity2d'}, 'bathymetry_2d': {'shortname': 'Bathymetry', 'name': 'Bathymetry', 'unit': 'm', 'filename': 'bathymetry2d'}, 'elev_2d': {'shortname': 'Elevation', 'name': 'Water elevation', 'unit': 'm', 'filename': 'Elevation2d'}, 'z_coord_ref_3d': {'shortname': 'Z coordinates', 'name': 'Static mesh z coordinates', 'unit': 'm', 'filename': 'ZCoordRef3d'}, 'max_h_diff': {'shortname': 'Maximum horizontal diffusivity', 'name': 'Maximum stable horizontal diffusivity', 'unit': 'm2 s-1', 'filename': 'MaxHDiffusivity3d'}, 'bathymetry_3d': {'shortname': 'Bathymetry', 'name': 'Bathymetry', 'unit': 'm', 'filename': 'bathymetry3d'}, 'temp_3d': {'shortname': 'Temperature', 'name': 'Water temperature', 'unit': 'C', 'filename': 'Temperature3d'}, 'uv_dav_3d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'DAVelocity3d'}, 'h_elem_size_3d': {'shortname': 'Horizontal element size', 'name': 'Element size in horizontal direction', 'unit': 'm', 'filename': 'h_elem_size_3d'}, 'bottom_drag_2d': {'shortname': 'Bottom drag coefficient', 'name': 'Bottom drag coefficient', 'unit': '', 'filename': 'BottomDrag2d'}, 'len_3d': {'shortname': 'Turbulent length scale', 'name': 'Turbulent length scale', 'unit': 'm', 'filename': 'TurbLen3d'}, 'gjv_alpha_h_3d': {'shortname': 'GJV Parameter h', 'name': 'GJV Parameter h', 'unit': '', 'filename': 'GJVParamH'}, 'split_residual_2d': {'shortname': 'Momentum residual', 'name': 'Momentum eq. residual for mode splitting', 'unit': 'm s-2', 'filename': 'SplitResidual2d'}, 'w_3d': {'shortname': 'Vertical velocity', 'name': 'Vertical velocity', 'unit': 'm s-1', 'filename': 'VertVelo3d'}, 'uv_bottom_3d': {'shortname': 'Bottom velocity', 'name': 'Bottom velocity', 'unit': 'm s-1', 'filename': 'BottomVelo3d'}, 'wind_stress_3d': {'shortname': 'Wind stress', 'name': 'Wind stress', 'unit': 'Pa', 'filename': 'wind_stress_3d'}, 'uv_3d': {'shortname': 'Horizontal velocity', 'name': 'Horizontal velocity', 'unit': 'm s-1', 'filename': 'Velocity3d'}, 'parab_visc_3d': {'shortname': 'Parabolic Viscosity', 'name': 'Parabolic Viscosity', 'unit': 'm2 s-1', 'filename': 'ParabVisc3d'}, 'elev_cg_2d': {'shortname': 'Elevation', 'name': 'Water elevation CG', 'unit': 'm', 'filename': 'ElevationCG2d'}, 'uv_p1_3d': {'shortname': 'P1 Velocity', 'name': 'P1 projection of horizontal velocity', 'unit': 'm s-1', 'filename': 'VeloCG3d'}, 'v_elem_size_2d': {'shortname': 'Vertical element size', 'name': 'Element size in vertical direction', 'unit': 'm', 'filename': 'VElemSize2d'}, 'coriolis_2d': {'shortname': 'Coriolis parameter', 'name': 'Coriolis parameter', 'unit': 's-1', 'filename': 'coriolis_2d'}, 'w_mesh_3d': {'shortname': 'Mesh velocity', 'name': 'Mesh velocity', 'unit': 'm s-1', 'filename': 'MeshVelo3d'}, 'baroc_head_bot_2d': {'shortname': 'Baroclinic head at bottom', 'name': 'Baroclinic head at bottom', 'unit': 'm', 'filename': 'BaroHeadBot2d'}, 'baroc_head_2d': {'shortname': 'Dav baroclinic head', 'name': 'Depth averaged baroclinic head', 'unit': 'm', 'filename': 'BaroHead2d'}, 'coriolis_3d': {'shortname': 'Coriolis parameter', 'name': 'Coriolis parameter', 'unit': 's-1', 'filename': 'coriolis_3d'}, 'eddy_diff_3d': {'shortname': 'Eddy diffusivity', 'name': 'Eddy diffusivity', 'unit': 'm2 s-1', 'filename': 'EddyDiff3d'}, 'elev_3d': {'shortname': 'Elevation', 'name': 'Water elevation', 'unit': 'm', 'filename': 'Elevation3d'}, 'z_bottom_2d': {'shortname': 'Bottom cell z coordinates', 'name': 'Bottom cell z coordinates', 'unit': 'm', 'filename': 'ZBottom2d'}, 'gjv_alpha_v_3d': {'shortname': 'GJV Parameter v', 'name': 'GJV Parameter v', 'unit': '', 'filename': 'GJVParamV'}, 'salt_3d': {'shortname': 'Salinity', 'name': 'Water salinity', 'unit': 'psu', 'filename': 'Salinity3d'}, 'uv_bottom_2d': {'shortname': 'Bottom velocity', 'name': 'Bottom velocity', 'unit': 'm s-1', 'filename': 'BottomVelo2d'}, 'psi_3d': {'shortname': 'Turbulence psi variable', 'name': 'Turbulence psi variable', 'unit': '', 'filename': 'TurbPsi3d'}, 'z_coord_3d': {'shortname': 'Z coordinates', 'name': 'Mesh z coordinates', 'unit': 'm', 'filename': 'ZCoord3d'}, 'baroc_head_int_3d': {'shortname': 'Vertically integrated baroclinic head', 'name': 'Vertical integral of baroclinic head', 'unit': 'm2', 'filename': 'BaroHeadInt3d'}, 'smag_visc_3d': {'shortname': 'Smagorinsky viscosity', 'name': 'Smagorinsky viscosity', 'unit': 'm2 s-1', 'filename': 'SmagViscosity3d'}, 'tke_3d': {'shortname': 'Turbulent Kinetic Energy', 'name': 'Turbulent Kinetic Energy', 'unit': 'm2 s-2', 'filename': 'TurbKEnergy3d'}, 'bottom_drag_3d': {'shortname': 'Bottom drag coefficient', 'name': 'Bottom drag coefficient', 'unit': '', 'filename': 'BottomDrag3d'}, 'w_mesh_surf_2d': {'shortname': 'Surface mesh velocity', 'name': 'Surface mesh velocity', 'unit': 'm s-1', 'filename': 'SurfMeshVelo3d'}, 'w_mesh_surf_3d': {'shortname': 'Surface mesh velocity', 'name': 'Surface mesh velocity', 'unit': 'm s-1', 'filename': 'SurfMeshVelo3d'}, 'uv_2d': {'shortname': 'Depth averaged velocity', 'name': 'Depth averaged velocity', 'unit': 'm s-1', 'filename': 'Velocity2d'}}</em><a class="headerlink" href="#thetis.field_defs.field_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary that contains the meta data of each field.</p>
<p>Required meta data entries are:</p>
<ul class="simple">
<li><strong>name</strong>: human readable description</li>
<li><strong>shortname</strong>: description used in visualization etc</li>
<li><strong>unit</strong>: SI unit of the field</li>
<li><strong>filename</strong>: filename for output files</li>
</ul>
<p>The naming convention for field keys is snake_case: <code class="docutils literal"><span class="pre">field_name_3d</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-thetis.firedrake">
<span id="thetis-firedrake-module"></span><h2>thetis.firedrake module<a class="headerlink" href="#module-thetis.firedrake" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thetis.implicitexplicit">
<span id="thetis-implicitexplicit-module"></span><h2>thetis.implicitexplicit module<a class="headerlink" href="#module-thetis.implicitexplicit" title="Permalink to this headline">¶</a></h2>
<p>Implicit-explicit time integrators</p>
<dl class="class">
<dt id="thetis.implicitexplicit.IMEXEuler">
<em class="property">class </em><code class="descclassname">thetis.implicitexplicit.</code><code class="descname">IMEXEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>Forward-Backward Euler</p>
<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXEuler.dirk_class">
<code class="descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">DIRKEuler</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXEuler.erk_class">
<code class="descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKEuler</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.implicitexplicit.IMEXGeneric">
<em class="property">class </em><code class="descclassname">thetis.implicitexplicit.</code><code class="descname">IMEXGeneric</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Generic implementation of Runge-Kutta Implicit-Explicit schemes</p>
<p>Derived classes must define the implicit <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="thetis.implicitexplicit.IMEXGeneric.dirk_class"><code class="xref py py-attr docutils literal"><span class="pre">dirk_class</span></code></a> and explicit
<a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="thetis.implicitexplicit.IMEXGeneric.erk_class"><code class="xref py py-attr docutils literal"><span class="pre">erk_class</span></code></a> Runge-Kutta time integrator classes.</p>
<p>This method solves the linearized equations: All implicit terms are fed to
the implicit solver, while all the other terms are fed to the explicit
solver. In case of non-linear terms proper linearization must defined in the
equation using the two solution functions (solution, solution_old)</p>
<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXGeneric.dirk_class">
<code class="descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Implicit DIRK class</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXGeneric.erk_class">
<code class="descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicit Runge-Kutta class</p>
</dd></dl>

<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the final solution.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.set_dt">
<code class="descname">set_dt</code><span class="sig-paren">(</span><em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Update time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="method">
<dt id="thetis.implicitexplicit.IMEXGeneric.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.implicitexplicit.IMEXLPUM2">
<em class="property">class </em><code class="descclassname">thetis.implicitexplicit.</code><code class="descname">IMEXLPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (20) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXLPUM2.dirk_class">
<code class="descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">DIRKLPUM2</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXLPUM2.erk_class">
<code class="descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKLPUM2</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.implicitexplicit.IMEXLSPUM2">
<em class="property">class </em><code class="descclassname">thetis.implicitexplicit.</code><code class="descname">IMEXLSPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (17) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXLSPUM2.dirk_class">
<code class="descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">DIRKLSPUM2</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXLSPUM2.erk_class">
<code class="descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKLSPUM2</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.implicitexplicit.IMEXMidpoint">
<em class="property">class </em><code class="descclassname">thetis.implicitexplicit.</code><code class="descname">IMEXMidpoint</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_dirk={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.implicitexplicit.IMEXGeneric</span></code></a></p>
<p>Implicit-explicit midpoint scheme (1, 2, 2) from Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXMidpoint.dirk_class">
<code class="descname">dirk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.dirk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ESDIRKMidpoint</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.implicitexplicit.IMEXMidpoint.erk_class">
<code class="descname">erk_class</code><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.erk_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ERKMidpoint</span></code></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.implicitexplicit.timed_region">
<code class="descclassname">thetis.implicitexplicit.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.implicitexplicit.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.implicitexplicit.timed_stage">
<code class="descclassname">thetis.implicitexplicit.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.implicitexplicit.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.limiter">
<span id="thetis-limiter-module"></span><h2>thetis.limiter module<a class="headerlink" href="#module-thetis.limiter" title="Permalink to this headline">¶</a></h2>
<p>Slope limiters for discontinuous fields</p>
<dl class="class">
<dt id="thetis.limiter.VertexBasedP1DGLimiter">
<em class="property">class </em><code class="descclassname">thetis.limiter.</code><code class="descname">VertexBasedP1DGLimiter</code><span class="sig-paren">(</span><em>p1dg_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://firedrakeproject.org/firedrake.slope_limiter.html#firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal"><span class="pre">firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter</span></code></a></p>
<p>Vertex based limiter for P1DG tracer fields, see Kuzmin (2010)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently only scalar fields are supported</p>
</div>
<p>Kuzmin (2010). A vertex-based hierarchical slope limiter
for p-adaptive discontinuous Galerkin methods. Journal of Computational
and Applied Mathematics, 233(12):3077-3085.
<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2009.05.028">http://dx.doi.org/10.1016/j.cam.2009.05.028</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p1dg_space</strong> &#8211; P1DG function space</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the limiter on the given field (in place)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>field</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> to limit</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.limiter.VertexBasedP1DGLimiter.compute_bounds">
<code class="descname">compute_bounds</code><span class="sig-paren">(</span><em>field</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.compute_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.compute_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-compute min/max values of all neighbouring centroids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>field</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> to limit</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.limiter.assert_function_space">
<code class="descclassname">thetis.limiter.</code><code class="descname">assert_function_space</code><span class="sig-paren">(</span><em>fs</em>, <em>family</em>, <em>degree</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#assert_function_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.limiter.assert_function_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the family and degree of function space.</p>
<p>Raises AssertionError if function space differs.
If the function space lies on an extruded mesh, checks both spaces of the
outer product.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fs</strong> &#8211; function space</li>
<li><strong>family</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of element family</li>
<li><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; polynomial degree of the function space</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.limiter.timed_region">
<code class="descclassname">thetis.limiter.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.limiter.timed_stage">
<code class="descclassname">thetis.limiter.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.limiter.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.log">
<span id="thetis-log-module"></span><h2>thetis.log module<a class="headerlink" href="#module-thetis.log" title="Permalink to this headline">¶</a></h2>
<p>Loggers for Thetis</p>
<p>Creates two logger instances, one for general model output and one for debug,
warning, error etc. messages.</p>
<p>To print to the model output stream, use <code class="xref py py-func docutils literal"><span class="pre">print_output()</span></code>.</p>
<p>Debug, warning etc. messages are issued with <code class="xref py py-func docutils literal"><span class="pre">debug()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">info()</span></code>,
<code class="xref py py-func docutils literal"><span class="pre">warning()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">error()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">critical()</span></code> methods.</p>
</div>
<div class="section" id="module-thetis.momentum_eq">
<span id="thetis-momentum-eq-module"></span><h2>thetis.momentum_eq module<a class="headerlink" href="#module-thetis.momentum_eq" title="Permalink to this headline">¶</a></h2>
<p>3D momentum equation for hydrostatic Boussinesq flow.</p>
<p>The three dimensional momentum equation reads</p>
<div class="math" id="equation-mom_eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-mom_eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial \textbf{u}}{\partial t}
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u} + g\nabla_h \eta + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>where <span class="math">\(\textbf{u}\)</span> and <span class="math">\(w\)</span> denote horizontal and vertical velocity,
<span class="math">\(\nabla_h\)</span> is the horizontal gradient,
<span class="math">\(\wedge\)</span> denotes the cross product,
<span class="math">\(g\)</span> is the gravitational acceleration, <span class="math">\(f\)</span> is the Coriolis
frequency, <span class="math">\(\textbf{e}_z\)</span> is a vertical unit vector, and
<span class="math">\(\nu_h, \nu\)</span> stand for horizontal and vertical viscosity.
Water density is given by <span class="math">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math">\(\rho_0\)</span> is a constant reference density.
Above <span class="math">\(r\)</span> denotes the baroclinic head</p>
<div class="math" id="equation-baroc_head">
<span class="eqno">(2)<a class="headerlink" href="#equation-baroc_head" title="Permalink to this equation">¶</a></span>\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>In the case of purely barotropic problems the <span class="math">\(r\)</span> and the internal pressure
gradient are omitted.</p>
<p>When using mode splitting we split the velocity field into a depth average and
a deviation, <span class="math">\(\textbf{u} = \bar{\textbf{u}} + \textbf{u}'\)</span>.
Following Higdon and de Szoeke (1997) we write an equation for the deviation
<span class="math">\(\textbf{u}'\)</span>:</p>
<div class="math" id="equation-mom_eq_split">
<span class="eqno">(3)<a class="headerlink" href="#equation-mom_eq_split" title="Permalink to this equation">¶</a></span>\[\frac{\partial \textbf{u}'}{\partial t} =
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u}' + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu  \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>In <a class="reference internal" href="#equation-mom_eq_split">(3)</a> the external pressure gradient <span class="math">\(g\nabla_h \eta\)</span> vanishes and the
Coriolis term only contains the deviation <span class="math">\(\textbf{u}'\)</span>.
Advection and diffusion terms are not changed.</p>
<p>Higdon and de Szoeke (1997). Barotropic-Baroclinic Time Splitting for Ocean
Circulation Modeling. Journal of Computational Physics, 135(1):30-53.
<a class="reference external" href="http://dx.doi.org/10.1006/jcph.1997.5733">http://dx.doi.org/10.1006/jcph.1997.5733</a></p>
<dl class="class">
<dt id="thetis.momentum_eq.MomentumEquation">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">MomentumEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Hydrostatic 3D momentum equation <a class="reference internal" href="#equation-mom_eq_split">(3)</a> for mode split models</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.MomentumTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">MomentumTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term for momentum equation that provides commonly used members and
mapping for boundary functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Horizontal advection term, <span class="math">\(\nabla_h \cdot (\textbf{u} \textbf{u})\)</span></p>
<p>The weak form reads</p>
<div class="math">
\[\int_\Omega \nabla_h \cdot (\textbf{u} \textbf{u}) \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \boldsymbol{\psi} : (\textbf{u} \textbf{u}) dx
+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \textbf{u}^{\text{up}} \cdot
\text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}(\textbf{u}) dS\]</div>
<p>where the right hand side has been integrated by parts; <span class="math">\(:\)</span> stand for
the Frobenius inner product, <span class="math">\(\textbf{n}_h\)</span> is the horizontal
projection of the normal vector, <span class="math">\(\textbf{u}^{\text{up}}\)</span> is the
upwind value, and <span class="math">\(\text{jump}\)</span> and <span class="math">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Vertical advection term, <span class="math">\(\partial \left(w\textbf{u} \right)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math">
\[\int_\Omega \frac{\partial \left(w\textbf{u} \right)}{\partial z} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \left( w \textbf{u} \right) \cdot \frac{\partial \boldsymbol{\psi}}{\partial z} dx
+ \int_{\mathcal{I}_{h}} \textbf{u}^{\text{up}} \cdot \text{jump}(\boldsymbol{\psi} n_z) \text{avg}(w) dS\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.VerticalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Horizontal viscosity term, <span class="math">\(- \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math">
\[\begin{split}- \int_\Omega \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right) \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega \nu_h (\nabla_h \boldsymbol{\psi}) : (\nabla_h \textbf{u})^T dx \\
&amp;- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \textbf{u}) dS
- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \boldsymbol{\psi}) dS \\
&amp;+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \sigma \text{avg}(\nu_h) \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the minus sign due to <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a> sign convention</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.HorizontalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.VerticalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">VerticalViscosityTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Vertical viscosity term, <span class="math">\(- \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math">
\[\begin{split}- \int_\Omega \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right) \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega \nu \frac{\partial \boldsymbol{\psi}}{\partial z} \cdot \frac{\partial \textbf{u}}{\partial z} dx \\
&amp;- \int_{\mathcal{I}_h} \text{jump}(\boldsymbol{\psi} n_z) \cdot \text{avg}\left(\nu \frac{\partial \textbf{u}}{\partial z}\right) dS
- \int_{\mathcal{I}_h} \text{jump}(\textbf{u} n_z) \cdot \text{avg}\left(\nu \frac{\partial \boldsymbol{\psi}}{\partial z}\right) dS \\
&amp;+ \int_{\mathcal{I}_h} \sigma \text{avg}(\nu) \text{jump}(\textbf{u} n_z) \cdot \text{jump}(\boldsymbol{\psi} n_z) dS\end{split}\]</div>
<p>where <span class="math">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the minus sign due to <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a> sign convention</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.VerticalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.PressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">PressureGradientTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Internal pressure gradient term, <span class="math">\(g\nabla_h r\)</span></p>
<p>where <span class="math">\(r\)</span> is the baroclinic head <a class="reference internal" href="#equation-baroc_head">(2)</a>. Let <span class="math">\(s\)</span>
denote <span class="math">\(r/H\)</span>. We can then write</p>
<div class="math">
\[F_{IPG} = g\nabla_h((s -\bar{s}) H)
    + g\nabla_h\left(\frac{1}{H}\right) H^2\bar{s}
    + g s_{bot}\nabla_h h\]</div>
<p>where <span class="math">\(\bar{s},s_{bot}\)</span> are the depth average and bottom value of
<span class="math">\(s\)</span>.</p>
<p>If <span class="math">\(s\)</span> belongs to a discontinuous function space, the first term is
integrated by parts. Its weak form reads</p>
<div class="math">
\[\int_\Omega g\nabla_h((s -\bar{s}) H) \cdot \boldsymbol{\psi} dx
    = - \int_\Omega g (s -\bar{s}) H \nabla_h \cdot \boldsymbol{\psi} dx
    + \int_{\mathcal{I}_h \cup \mathcal{I}_v} g (s -\bar{s}) H \boldsymbol{\psi}  \cdot \textbf{n}_h dx\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.PressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.CoriolisTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">CoriolisTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.CoriolisTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.BottomFrictionTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">BottomFrictionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Quadratic bottom friction term, <span class="math">\(\tau_b = C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>The weak formulation reads</p>
<div class="math">
\[\int_{\Gamma_{bot}} \tau_b \cdot \boldsymbol{\psi} dx = \int_{\Gamma_{bot}} C_D \| \textbf{u}_b \| \textbf{u}_b \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math">\(\textbf{u}_b\)</span> is reconstructed velocity in the middle of the
bottom element:</p>
<div class="math">
\[\textbf{u}_b = \textbf{u}\Big|_{\Gamma_{bot}} + \frac{\partial \textbf{u}}{\partial z}\Big|_{\Gamma_{bot}} h_b,\]</div>
<p><span class="math">\(h_b\)</span> being half of the element height.
For implicit solvers we linearize the stress as
<span class="math">\(\tau_b = C_D \| \textbf{u}_b^{n} \| \textbf{u}_b^{n+1}\)</span></p>
<p>The drag is computed from the law-of-the wall</p>
<div class="math">
\[C_D = \left( \frac{\kappa}{\ln (h_b + z_0)/z_0} \right)^2\]</div>
<p>where <span class="math">\(z_0\)</span> is the bottom roughness length, read from <code class="docutils literal"><span class="pre">z0_friction</span></code>
field.
The user can override the <span class="math">\(C_D\)</span> value by providing <code class="docutils literal"><span class="pre">quadratic_drag</span></code>
field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.BottomFrictionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.LinearDragTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">LinearDragTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Linear drag term, <span class="math">\(\tau_b = D \textbf{u}_b\)</span></p>
<p>where <span class="math">\(D\)</span> is the drag coefficient, read from <code class="docutils literal"><span class="pre">linear_drag</span></code> field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.LinearDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.momentum_eq.SourceTerm">
<em class="property">class </em><code class="descclassname">thetis.momentum_eq.</code><code class="descname">SourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>nonlin=True</em>, <em>use_bottom_friction=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.momentum_eq.MomentumTerm</span></code></a></p>
<p>Generic momentum source term</p>
<p>The weak form reads</p>
<div class="math">
\[F_s = \int_\Omega \sigma \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math">\(\sigma\)</span> is a user defined vector valued <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.</p>
<p>This term also implements the wind stress, <span class="math">\(-\tau_w/(H \rho_0)\)</span>.
<span class="math">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>
<code class="docutils literal"><span class="pre">wind_stress</span></code>. The weak form is</p>
<div class="math">
\[F_w = \int_{\Gamma_s} \frac{1}{\rho_0} \tau_w \cdot \boldsymbol{\psi} dx\]</div>
<p>Wind stress is only included if vertical viscosity is provided.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the sign convention of <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a>, this term is assembled to the left hand side of the equation</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes bottom friction term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.momentum_eq.SourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.options">
<span id="thetis-options-module"></span><h2>thetis.options module<a class="headerlink" href="#module-thetis.options" title="Permalink to this headline">¶</a></h2>
<p>This file defines all options of the 2D/3D models excluding field values.</p>
<dl class="class">
<dt id="thetis.options.ModelOptions">
<em class="property">class </em><code class="descclassname">thetis.options.</code><code class="descname">ModelOptions</code><a class="reference internal" href="_modules/thetis/options.html#ModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.options.ModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a>, <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Stores all circulation model options</p>
<p>Every instance is initialized with default values</p>
<dl class="attribute">
<dt id="thetis.options.ModelOptions.baroclinic">
<code class="descname">baroclinic</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.baroclinic" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute internal pressure gradient in momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.cfl_2d">
<code class="descname">cfl_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.cfl_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Factor to scale the 2d time step</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.cfl_3d">
<code class="descname">cfl_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.cfl_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Factor to scale the 2d time step</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_salt_conservation">
<code class="descname">check_salt_conservation</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_salt_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute total salinity mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_salt_overshoot">
<code class="descname">check_salt_overshoot</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_salt_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute salinity overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_temp_conservation">
<code class="descname">check_temp_conservation</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_temp_conservation" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute total temperature mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_temp_overshoot">
<code class="descname">check_temp_overshoot</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_temp_overshoot" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute temperature overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_vol_conservation_2d">
<code class="descname">check_vol_conservation_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_vol_conservation_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute volume of the 2D mode at every export</p>
<p>2D volume is defined as the integral of the water elevation field.
Prints deviation from the initial volume to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.check_vol_conservation_3d">
<code class="descname">check_vol_conservation_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.check_vol_conservation_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Compute volume of the 2D domain at every export</p>
<p>Prints deviation from the initial volume to stdout.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.constant_salt">
<code class="descname">constant_salt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.constant_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient: Constant salinity if salinity is not solved</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.constant_temp">
<code class="descname">constant_temp</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.constant_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient: Constant temperature if temperature is not solved</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.coriolis">
<code class="descname">coriolis</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.coriolis" title="Permalink to this definition">¶</a></dt>
<dd><p>2D Coefficient or None: Coriolis parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.dt">
<code class="descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Time step.</p>
<p>If set, overrides automatically computed stable dt</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.dt_2d">
<code class="descname">dt_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Time step of the 2d mode</p>
<p>If set overrides automatically computed stable dt</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.element_family">
<code class="descname">element_family</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.element_family" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Finite element family.</p>
<p>2D solver supports &#8216;dg-dg&#8217;, &#8216;rt-dg&#8217;, or &#8216;dg-cg&#8217; velocity-pressure pairs.
3D solver supports &#8216;dg-dg&#8217;, or &#8216;rt-dg&#8217; velocity-pressure pairs.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.elev_source_2d">
<code class="descname">elev_source_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.elev_source_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 2D continuity equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.equation_of_state">
<code class="descname">equation_of_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.equation_of_state" title="Permalink to this definition">¶</a></dt>
<dd><p>str: type of equation of state that defines water density</p>
<p>Either &#8216;full&#8217; or &#8216;linear&#8217;. See <a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal"><span class="pre">EquationOfState</span></code></a> and
<a class="reference internal" href="#thetis.utility.LinearEquationOfState" title="thetis.utility.LinearEquationOfState"><code class="xref py py-class docutils literal"><span class="pre">LinearEquationOfState</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.export_diagnostics">
<code class="descname">export_diagnostics</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.export_diagnostics" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Store diagnostic variables to disk in HDF5 format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.fields_to_export">
<code class="descname">fields_to_export</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.fields_to_export" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str: Fields to export in VTK format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.fields_to_export_hdf5">
<code class="descname">fields_to_export_hdf5</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.fields_to_export_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str: Fields to export in HDF5 format</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.gls_options">
<code class="descname">gls_options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.gls_options" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.turbulence.GLSModelOptions" title="thetis.turbulence.GLSModelOptions"><code class="xref py py-class docutils literal"><span class="pre">GLSModelOptions</span></code></a>: Dictionary of default GLS model options</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.h_diffusivity">
<code class="descname">h_diffusivity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.h_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Background horizontal diffusivity for tracers</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.h_viscosity">
<code class="descname">h_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.h_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background horizontal viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.include_grad_depth_viscosity_term">
<code class="descname">include_grad_depth_viscosity_term</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.include_grad_depth_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Include <span class="math">\(\nabla H\)</span> term in the depth-averaged viscosity</p>
<p>See <a class="reference internal" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.include_grad_div_viscosity_term">
<code class="descname">include_grad_div_viscosity_term</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.include_grad_div_viscosity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Include <span class="math">\(\nabla (\nu_h \nabla \cdot \bar{\textbf{u}})\)</span> term in the depth-averaged viscosity</p>
<p>See <a class="reference internal" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.lin_equation_of_state_params">
<code class="descname">lin_equation_of_state_params</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.lin_equation_of_state_params" title="Permalink to this definition">¶</a></dt>
<dd><p>dict: Parameters for linear equation of state</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.linear_drag">
<code class="descname">linear_drag</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.linear_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: 2D linear drag parameter <span class="math">\(L\)</span></p>
<p>Bottom stress is <span class="math">\(\tau_b/\rho_0 = -L \mathbf{u} H\)</span></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.log_output">
<code class="descname">log_output</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.log_output" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Redirect all output to log file in output directory</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.mu_manning">
<code class="descname">mu_manning</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.mu_manning" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Manning-Strickler 2D quadratic drag parameter <span class="math">\(\mu\)</span></p>
<p>Bottom stress is <span class="math">\(\tau_b/\rho_0 = -g \mu^2 |\mathbf{u}|\mathbf{u}/H^{1/3}\)</span></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.no_exports">
<code class="descname">no_exports</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.no_exports" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Do not store any outputs to disk</p>
<p>Disables VTK and HDF5 field outputs. and HDF5 diagnostic outputs.
Used in CI test suite.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.nonlin">
<code class="descname">nonlin</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.nonlin" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use nonlinear shallow water equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.nu_viscosity">
<code class="descname">nu_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.nu_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>: Maximum horizontal viscosity</p>
<p>Used to compute max stable diffusion time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.order">
<code class="descname">order</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.order" title="Permalink to this definition">¶</a></dt>
<dd><p>int: Polynomial degree of elements</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.outputdir">
<code class="descname">outputdir</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.outputdir" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Directory where model output files are stored</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.quadratic_drag">
<code class="descname">quadratic_drag</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.quadratic_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: dimensionless 2D quadratic drag parameter <span class="math">\(C_D\)</span></p>
<p>Bottom stress is <span class="math">\(\tau_b/\rho_0 = -C_D |\mathbf{u}|\mathbf{u}\)</span></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.salt_source_3d">
<code class="descname">salt_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.salt_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for salinity equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.shallow_water_theta">
<code class="descname">shallow_water_theta</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.shallow_water_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>float: theta parameter for shallow water semi-implicit scheme</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.smagorinsky_factor">
<code class="descname">smagorinsky_factor</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.smagorinsky_factor" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> or None: Smagorinsky viscosity factor <span class="math">\(C_S\)</span></p>
<p>See <a class="reference internal" href="#thetis.utility.SmagorinskyViscosity" title="thetis.utility.SmagorinskyViscosity"><code class="xref py py-class docutils literal"><span class="pre">SmagorinskyViscosity</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_salt">
<code class="descname">solve_salt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve salt transport</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_temp">
<code class="descname">solve_temp</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve temperature transport</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solve_vert_diffusion">
<code class="descname">solve_vert_diffusion</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solve_vert_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Solve implicit vertical diffusion</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_momentum_explicit">
<code class="descname">solver_parameters_momentum_explicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_momentum_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for explicit 3D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_momentum_implicit">
<code class="descname">solver_parameters_momentum_implicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_momentum_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for implicit 3D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_sw">
<code class="descname">solver_parameters_sw</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_sw" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for 2D shallow water equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_sw_momentum">
<code class="descname">solver_parameters_sw_momentum</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_sw_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for 2D depth averaged momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_tracer_explicit">
<code class="descname">solver_parameters_tracer_explicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_tracer_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for explicit 3D tracer equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.solver_parameters_tracer_implicit">
<code class="descname">solver_parameters_tracer_implicit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.solver_parameters_tracer_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>PETSc solver parameters for implicit 3D tracer equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.t_end">
<code class="descname">t_end</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.t_end" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Simulation duration in seconds</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.t_export">
<code class="descname">t_export</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.t_export" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Export interval in seconds</p>
<p>All fields in fields_to_export list will be stored to disk and
diagnostics will be computed</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.temp_source_3d">
<code class="descname">temp_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.temp_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for temperature equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.timestepper_type">
<code class="descname">timestepper_type</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.timestepper_type" title="Permalink to this definition">¶</a></dt>
<dd><p>str: time integrator option.</p>
<p>Valid options for the 2D solver: &#8216;forwardeuler&#8217;|&#8217;backwardeuler&#8217;|&#8217;ssprk33&#8217;|&#8217;ssprk33semi&#8217;|&#8217;cranknicolson&#8217;|&#8217;sspimex&#8217;|&#8217;pressureprojectionpicard&#8217;|&#8217;steadystate&#8217;</p>
<p>Valid options for the 2D solver: &#8216;ssprk33&#8217;|&#8217;erkale&#8217;|&#8217;leapfrog&#8217;|&#8217;imexale&#8217;|&#8217;ssprk22&#8217;</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.tracer_lax_friedrichs">
<code class="descname">tracer_lax_friedrichs</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.tracer_lax_friedrichs" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> or None: Scaling factor for tracer L-F stability term.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.turbulence_model">
<code class="descname">turbulence_model</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.turbulence_model" title="Permalink to this definition">¶</a></dt>
<dd><p>str: Defines the type of vertical turbulence model.</p>
<p>Currently only &#8216;gls&#8217; is supported</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.u_advection">
<code class="descname">u_advection</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.u_advection" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>: Maximum horizontal velocity magnitude</p>
<p>Used to compute max stable advection time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_ale_moving_mesh">
<code class="descname">use_ale_moving_mesh</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_ale_moving_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use ALE formulation where 3D mesh tracks free surface</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_bottom_friction">
<code class="descname">use_bottom_friction</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_bottom_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Apply log layer bottom stress in the 3D model</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_limiter_for_tracers">
<code class="descname">use_limiter_for_tracers</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_limiter_for_tracers" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Apply P1DG limiter for tracer fields</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_linearized_semi_implicit_2d">
<code class="descname">use_linearized_semi_implicit_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_linearized_semi_implicit_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use linearized semi-implicit time integration for the horizontal mode</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_parabolic_viscosity">
<code class="descname">use_parabolic_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_parabolic_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Use idealized parabolic eddy viscosity</p>
<p>See <a class="reference internal" href="#thetis.utility.ParabolicViscosity" title="thetis.utility.ParabolicViscosity"><code class="xref py py-class docutils literal"><span class="pre">ParabolicViscosity</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_smooth_eddy_viscosity">
<code class="descname">use_smooth_eddy_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_smooth_eddy_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Cast eddy viscosity to p1 space instead of p0</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_turbulence">
<code class="descname">use_turbulence</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_turbulence" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Activate GLS turbulence model</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.use_turbulence_advection">
<code class="descname">use_turbulence_advection</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.use_turbulence_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: Advect TKE and Psi in the GLS turbulence model</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_lax_friedrichs">
<code class="descname">uv_lax_friedrichs</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_lax_friedrichs" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> or None: Scaling factor for uv L-F stability term.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_source_2d">
<code class="descname">uv_source_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_source_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 2D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.uv_source_3d">
<code class="descname">uv_source_3d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.uv_source_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: source term for 3D momentum equation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.v_diffusivity">
<code class="descname">v_diffusivity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.v_diffusivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background vertical diffusivity for tracers</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.v_viscosity">
<code class="descname">v_viscosity</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.v_viscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: background vertical viscosity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.verbose">
<code class="descname">verbose</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>int: Verbosity level</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.w_advection">
<code class="descname">w_advection</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.w_advection" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>: Maximum vertical velocity magnitude</p>
<p>Used to compute max stable advection time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.options.ModelOptions.wind_stress">
<code class="descname">wind_stress</code><em class="property"> = None</em><a class="headerlink" href="#thetis.options.ModelOptions.wind_stress" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient or None: Stress at free surface (2D vector function)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.options.timed_region">
<code class="descclassname">thetis.options.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.options.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.options.timed_stage">
<code class="descclassname">thetis.options.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.options.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.physical_constants">
<span id="thetis-physical-constants-module"></span><h2>thetis.physical_constants module<a class="headerlink" href="#module-thetis.physical_constants" title="Permalink to this headline">¶</a></h2>
<p>Default values for physical constants and parameters</p>
</div>
<div class="section" id="module-thetis.rungekutta">
<span id="thetis-rungekutta-module"></span><h2>thetis.rungekutta module<a class="headerlink" href="#module-thetis.rungekutta" title="Permalink to this headline">¶</a></h2>
<p>Implements Runge-Kutta time integration methods.</p>
<p>The abstract class <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">AbstractRKScheme</span></code></a> defines the Runge-Kutta
coefficients, and can be used to implement generic time integrators.</p>
<dl class="class">
<dt id="thetis.rungekutta.AbstractRKScheme">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">AbstractRKScheme</code><a class="reference internal" href="_modules/thetis/rungekutta.html#AbstractRKScheme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Abstract class for defining Runge-Kutta schemes.</p>
<p>Derived classes must define the Butcher tableau (arrays <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.a" title="thetis.rungekutta.AbstractRKScheme.a"><code class="xref py py-attr docutils literal"><span class="pre">a</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.b" title="thetis.rungekutta.AbstractRKScheme.b"><code class="xref py py-attr docutils literal"><span class="pre">b</span></code></a>,
<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.c" title="thetis.rungekutta.AbstractRKScheme.c"><code class="xref py py-attr docutils literal"><span class="pre">c</span></code></a>) and the CFL number (<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="thetis.rungekutta.AbstractRKScheme.cfl_coeff"><code class="xref py py-attr docutils literal"><span class="pre">cfl_coeff</span></code></a>).</p>
<p>Currently only explicit or diagonally implicit schemes are supported.</p>
<dl class="attribute">
<dt id="thetis.rungekutta.AbstractRKScheme.a">
<code class="descname">a</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.a" title="Permalink to this definition">¶</a></dt>
<dd><p>Runge-Kutta matrix <span class="math">\(a_{i,j}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.AbstractRKScheme.b">
<code class="descname">b</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.b" title="Permalink to this definition">¶</a></dt>
<dd><p>weights <span class="math">\(b_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.AbstractRKScheme.c">
<code class="descname">c</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.c" title="Permalink to this definition">¶</a></dt>
<dd><p>nodes <span class="math">\(c_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.AbstractRKScheme.cfl_coeff">
<code class="descname">cfl_coeff</code><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>CFL number of the scheme</p>
<p>Value 1.0 corresponds to Forward Euler time step.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.BackwardEuler">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">BackwardEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.BackwardEulerAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.BackwardEulerAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">BackwardEulerAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEulerAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Backward Euler method</p>
<dl class="attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.a">
<code class="descname">a</code><em class="property"> = [[1.0]]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.b">
<code class="descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.c">
<code class="descname">c</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.BackwardEulerAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.CrankNicolsonAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">CrankNicolsonAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Crack-Nicolson scheme</p>
<dl class="attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.a">
<code class="descname">a</code><em class="property"> = [[0.0, 0.0], [0.5, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.b">
<code class="descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.c">
<code class="descname">c</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.CrankNicolsonRK">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">CrankNicolsonRK</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonRK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonRK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.CrankNicolsonAbstract" title="thetis.rungekutta.CrankNicolsonAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.CrankNicolsonAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK22">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK22</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK22Abstract" title="thetis.rungekutta.DIRK22Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRK22Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK22Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK22Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>2-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math">
\[\begin{split}\begin{array}{c|cc}
\gamma &amp;   \gamma &amp;       0 \\
      1 &amp; 1-\gamma &amp; \gamma \\ \hline
        &amp;       1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math">\(\gamma = (2 + \sqrt{2})/2\)</span>.</p>
<p>From DIRK(2,3,2) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.a">
<code class="descname">a</code><em class="property"> = [[1.7071067811865475, 0], [-0.70710678118654746, 1.7071067811865475]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.b">
<code class="descname">b</code><em class="property"> = [-0.70710678118654746, 1.7071067811865475]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.c">
<code class="descname">c</code><em class="property"> = [1.7071067811865475, 1]</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK22Abstract.gamma">
<code class="descname">gamma</code><em class="property"> = 1.7071067811865475</em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK23">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK23</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK23Abstract" title="thetis.rungekutta.DIRK23Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRK23Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK23Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK23Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>2-stage, 3rd order Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math">
\[\begin{split}\begin{array}{c|cc}
  \gamma &amp;    \gamma &amp;       0 \\
1-\gamma &amp; 1-2\gamma &amp; \gamma \\ \hline
          &amp;        1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math">\(\gamma = (3 + \sqrt{3})/6\)</span>.</p>
<p>From DIRK(2,3,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.a">
<code class="descname">a</code><em class="property"> = [[0.78867513459481275, 0], [-0.57735026918962551, 0.78867513459481275]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.b">
<code class="descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.c">
<code class="descname">c</code><em class="property"> = [0.78867513459481275, 0.21132486540518725]</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK23Abstract.gamma">
<code class="descname">gamma</code><em class="property"> = 0.78867513459481275</em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK33">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK33</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK33Abstract" title="thetis.rungekutta.DIRK33Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRK33Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK33Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK33Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>3-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(3,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.a">
<code class="descname">a</code><em class="property"> = [[0.4358665215, 0, 0], [0.28206673925000003, 0.4358665215, 0], [1.208496649153235, -0.6443631706532353, 0.4358665215]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b">
<code class="descname">b</code><em class="property"> = [1.208496649153235, -0.6443631706532353, 0.4358665215]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b1">
<code class="descname">b1</code><em class="property"> = 1.208496649153235</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.b2">
<code class="descname">b2</code><em class="property"> = -0.6443631706532353</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.c">
<code class="descname">c</code><em class="property"> = [0.4358665215, 0.71793326075, 1]</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK33Abstract.gamma">
<code class="descname">gamma</code><em class="property"> = 0.4358665215</em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK43">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK43</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK43Abstract" title="thetis.rungekutta.DIRK43Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRK43Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRK43Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRK43Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>4-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(4,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.a">
<code class="descname">a</code><em class="property"> = [[0.5, 0, 0, 0], [0.16666666666666666, 0.5, 0, 0], [-0.5, 0.5, 0.5, 0], [1.5, -1.5, 0.5, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.b">
<code class="descname">b</code><em class="property"> = [1.5, -1.5, 0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.c">
<code class="descname">c</code><em class="property"> = [0.5, 0.6666666666666666, 0.5, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRK43Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKEuler">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.BackwardEulerAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKGeneric">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKGeneric</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic implementation of Diagonally Implicit Runge Kutta schemes.</p>
<p>All derived classes must define the Butcher tableau coefficients <code class="xref py py-attr docutils literal"><span class="pre">a</span></code>,
<code class="xref py py-attr docutils literal"><span class="pre">b</span></code>, <code class="xref py py-attr docutils literal"><span class="pre">c</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code></p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>init_cond</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.solve_tendency">
<code class="descname">solve_tendency</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.update_solution">
<code class="descname">update_solution</code><span class="sig-paren">(</span><em>i_stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates solution to i_stage sub-stage.</p>
<p>Tendencies must have been evaluated first.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.DIRKGeneric.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKLPUM2">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKLPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="thetis.rungekutta.DIRKLPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKLPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKLPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>DIRKLPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.a">
<code class="descname">a</code><em class="property"> = [[0.18181818181818182, 0, 0], [0.2662337662337662, 0.18181818181818182, 0], [0.3412042502951594, 0.34710743801652894, 0.18181818181818182]]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.b">
<code class="descname">b</code><em class="property"> = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.c">
<code class="descname">c</code><em class="property"> = [0.18181818181818182, 0.44805194805194803, 0.8701298701298701]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 4.34</em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKLSPUM2">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKLSPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="thetis.rungekutta.DIRKLSPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKLSPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">DIRKLSPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>DIRKLSPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.a">
<code class="descname">a</code><em class="property"> = [[0.18181818181818182, 0, 0], [0.44372294372294374, 0.18181818181818182, 0], [0.44004329004329007, 0.19090909090909092, 0.18181818181818182]]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.b">
<code class="descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.c">
<code class="descname">c</code><em class="property"> = [0.18181818181818182, 0.6255411255411255, 0.8127705627705628]</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 4.34</em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKEuler">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ForwardEulerAbstract" title="thetis.rungekutta.ForwardEulerAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ForwardEulerAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKEulerALE">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKEulerALE</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKEulerALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKEulerALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericALE2" title="thetis.rungekutta.ERKGenericALE2"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGenericALE2</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ForwardEulerAbstract" title="thetis.rungekutta.ForwardEulerAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ForwardEulerAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKGeneric">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKGeneric</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Butcher form. All terms in the equation are treated explicitly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><em>additive=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code></p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.solve_tendency">
<code class="descname">solve_tendency</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.update_solution">
<code class="descname">update_solution</code><span class="sig-paren">(</span><em>i_stage</em>, <em>additive=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the solution of the i-th stage</p>
<p>Tendencies must have been evaluated first.</p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGeneric.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKGenericALE2">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKGenericALE2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator for conservative ALE schemes.</p>
<p>Implements the Butcher tableau.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code></p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.solve_tendency">
<code class="descname">solve_tendency</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.solve_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.solve_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.update_solution">
<code class="descname">update_solution</code><span class="sig-paren">(</span><em>i_stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.update_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.update_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the solution of the i-th stage</p>
<p>Tendencies must have been evaluated first.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericALE2.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericALE2.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericALE2.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKGenericShuOsher">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKGenericShuOsher</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Shu-Osher form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKGenericShuOsher.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLPUM2">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2Abstract" title="thetis.rungekutta.ERKLPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLPUM2ALE">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLPUM2ALE</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2ALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2ALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericALE2" title="thetis.rungekutta.ERKGenericALE2"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGenericALE2</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2Abstract" title="thetis.rungekutta.ERKLPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLPUM2Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>ERKLPUM2, 3-stage, 2nd order
Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.a">
<code class="descname">a</code><em class="property"> = [[0, 0, 0], [0.5, 0, 0], [0.5, 0.5, 0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.b">
<code class="descname">b</code><em class="property"> = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.c">
<code class="descname">c</code><em class="property"> = [0, 0.5, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 2.0</em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLPUM2SemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLPUM2SemiImplicit</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>semi_implicit=False</em>, <em>theta=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2SemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2SemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKSemiImplicitGeneric" title="thetis.rungekutta.ERKSemiImplicitGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKSemiImplicitGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2Abstract" title="thetis.rungekutta.ERKLPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLSPUM2">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLSPUM2</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="thetis.rungekutta.ERKLSPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLSPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLSPUM2ALE">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLSPUM2ALE</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2ALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2ALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericALE2" title="thetis.rungekutta.ERKGenericALE2"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGenericALE2</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="thetis.rungekutta.ERKLSPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLSPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLSPUM2Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>ERKLSPUM2, 3-stage, 2nd order Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.a">
<code class="descname">a</code><em class="property"> = [[0, 0, 0], [0.8333333333333334, 0, 0], [0.4583333333333333, 0.4583333333333333, 0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.b">
<code class="descname">b</code><em class="property"> = [0.43636363636363634, 0.2, 0.36363636363636365]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.c">
<code class="descname">c</code><em class="property"> = [0, 0.8333333333333334, 0.9166666666666666]</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.2</em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKLSPUM2SemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKLSPUM2SemiImplicit</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>semi_implicit=False</em>, <em>theta=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2SemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2SemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKSemiImplicitGeneric" title="thetis.rungekutta.ERKSemiImplicitGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKSemiImplicitGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="thetis.rungekutta.ERKLSPUM2Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKLSPUM2Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKMidpoint">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKMidpoint</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKMidpointAbstract" title="thetis.rungekutta.ERKMidpointAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKMidpointAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKMidpointALE">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKMidpointALE</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpointALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpointALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericALE2" title="thetis.rungekutta.ERKGenericALE2"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGenericALE2</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKMidpointAbstract" title="thetis.rungekutta.ERKMidpointAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKMidpointAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKMidpointAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.a">
<code class="descname">a</code><em class="property"> = [[0.0, 0.0], [0.5, 0.0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.b">
<code class="descname">b</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.c">
<code class="descname">c</code><em class="property"> = [0.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKMidpointAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKSemiImplicitGeneric">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKSemiImplicitGeneric</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>semi_implicit=False</em>, <em>theta=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKSemiImplicitGeneric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKSemiImplicitGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic implementation of semi-implicit RK schemes.</p>
<p>If semi_implicit=True, this corresponds to a linearized semi-implicit
scheme. The linearization must be defined in the equation using solution and
solution_old functions: residual = residual(solution, solution_old)</p>
<p>If semi_implicit=False, this corresponds to a fully non-linear scheme:
residual = residual(solution, solution)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.ERKSemiImplicitGeneric.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKSemiImplicitGeneric.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKSemiImplicitGeneric.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKSemiImplicitGeneric.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKSemiImplicitGeneric.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKSemiImplicitGeneric.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKSemiImplicitGeneric.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKSemiImplicitGeneric.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKSemiImplicitGeneric.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.ERKSemiImplicitGeneric.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKSemiImplicitGeneric.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKSemiImplicitGeneric.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKTrapezoidAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKTrapezoidAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKTrapezoidAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Explicit Trapezoid scheme</p>
<p>This method has the Butcher tableau</p>
<div class="math">
\[\begin{split}\begin{array}{c|cc}
0.0 &amp; 0.0 &amp; 0.0 \\
1.0 &amp; 1.0 &amp; 0.0 \\ \hline
    &amp; 0.5 &amp; 0.5
\end{array}\end{split}\]</div>
<dl class="attribute">
<dt id="thetis.rungekutta.ERKTrapezoidAbstract.a">
<code class="descname">a</code><em class="property"> = [[0.0, 0.0], [1.0, 0.0]]</em><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKTrapezoidAbstract.b">
<code class="descname">b</code><em class="property"> = [0.5, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKTrapezoidAbstract.c">
<code class="descname">c</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ERKTrapezoidAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ERKTrapezoidRK">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ERKTrapezoidRK</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKTrapezoidRK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ERKTrapezoidRK" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKTrapezoidAbstract" title="thetis.rungekutta.ERKTrapezoidAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKTrapezoidAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ESDIRKMidpoint">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ESDIRKMidpoint</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="thetis.rungekutta.ESDIRKMidpointAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ESDIRKMidpointAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ESDIRKMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<dl class="attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.a">
<code class="descname">a</code><em class="property"> = [[0.0, 0.0], [0.0, 0.5]]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.b">
<code class="descname">b</code><em class="property"> = [0.0, 1.0]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.c">
<code class="descname">c</code><em class="property"> = [0.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ForwardEulerAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ForwardEulerAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ForwardEulerAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Forward Euler method</p>
<dl class="attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.a">
<code class="descname">a</code><em class="property"> = [[0]]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.b">
<code class="descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.c">
<code class="descname">c</code><em class="property"> = [0]</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ForwardEulerAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ImplicitMidpoint">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ImplicitMidpoint</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="thetis.rungekutta.ImplicitMidpointAbstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ImplicitMidpointAbstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">ImplicitMidpointAbstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpointAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>Implicit midpoint method, second order.</p>
<p>This method has the Butcher tableau</p>
<div class="math">
\[\begin{split}\begin{array}{c|c}
0.5 &amp; 0.5 \\ \hline
    &amp; 1.0
\end{array}\end{split}\]</div>
<dl class="attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.a">
<code class="descname">a</code><em class="property"> = [[0.5]]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.b">
<code class="descname">b</code><em class="property"> = [1.0]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.c">
<code class="descname">c</code><em class="property"> = [0.5]</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">RungeKuttaTimeIntegrator</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Abstract base class for all Runge-Kutta time integrators</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution">
<code class="descname">get_final_solution</code><span class="sig-paren">(</span><em>additive=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.get_final_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the final solution</p>
</dd></dl>

<dl class="method">
<dt id="thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.SSPRK33">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">SSPRK33</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericShuOsher" title="thetis.rungekutta.ERKGenericShuOsher"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKGenericShuOsher</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.SSPRK33Abstract" title="thetis.rungekutta.SSPRK33Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.SSPRK33Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.SSPRK33Abstract">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">SSPRK33Abstract</code><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33Abstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.AbstractRKScheme</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).</p>
<p>This scheme has Butcher tableau</p>
<div class="math">
\[\begin{split}\begin{array}{c|ccc}
    0 &amp;                 \\
    1 &amp; 1               \\
  1/2 &amp; 1/4 &amp; 1/4 &amp;     \\ \hline
      &amp; 1/6 &amp; 1/6 &amp; 2/3
\end{array}\end{split}\]</div>
<p>CFL coefficient is 1.0</p>
<dl class="attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.a">
<code class="descname">a</code><em class="property"> = [[0, 0, 0], [1.0, 0, 0], [0.25, 0.25, 0]]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.b">
<code class="descname">b</code><em class="property"> = [0.16666666666666666, 0.16666666666666666, 0.6666666666666666]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.c">
<code class="descname">c</code><em class="property"> = [0, 1.0, 0.5]</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="thetis.rungekutta.SSPRK33Abstract.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.rungekutta.SSPRK33SemiImplicit">
<em class="property">class </em><code class="descclassname">thetis.rungekutta.</code><code class="descname">SSPRK33SemiImplicit</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>semi_implicit=False</em>, <em>theta=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33SemiImplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33SemiImplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKSemiImplicitGeneric" title="thetis.rungekutta.ERKSemiImplicitGeneric"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.ERKSemiImplicitGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.SSPRK33Abstract" title="thetis.rungekutta.SSPRK33Abstract"><code class="xref py py-class docutils literal"><span class="pre">thetis.rungekutta.SSPRK33Abstract</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.rungekutta.butcher_to_shuosher_form">
<code class="descclassname">thetis.rungekutta.</code><code class="descname">butcher_to_shuosher_form</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#butcher_to_shuosher_form"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.rungekutta.butcher_to_shuosher_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts Butcher tableau to Shu-Osher form.</p>
<p>The Shu-Osher form of a s-stage scheme is defined by two s+1 by s+1 arrays
<span class="math">\(\alpha\)</span> and <span class="math">\(\beta\)</span>:</p>
<div class="math">
\[\begin{split}u^{0} &amp;= u^n \\
u^{(i)} &amp;= \sum_{j=0}^s \alpha_{i,j} u^{(j)} + \sum_{j=0}^s \beta_{i,j} F(u^{(j)}) \\
u^{n+1} &amp;= u^{(s)}\end{split}\]</div>
<p>The Shu-Osher form is not unique. Here we construct the form where beta
values are the diagonal entries (for DIRK schemes) or sub-diagonal entries
(for explicit schemes) of the concatenated Butcher tableau [<span class="math">\(a\)</span>; <span class="math">\(b\)</span>].</p>
<p>For more information see Ketchelson et al. (2009) <a class="reference external" href="http://dx.doi.org/10.1016/j.apnum.2008.03.034">http://dx.doi.org/10.1016/j.apnum.2008.03.034</a></p>
</dd></dl>

<dl class="function">
<dt id="thetis.rungekutta.timed_region">
<code class="descclassname">thetis.rungekutta.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.rungekutta.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.rungekutta.timed_stage">
<code class="descclassname">thetis.rungekutta.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.rungekutta.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.shallowwater_eq">
<span id="thetis-shallowwater-eq-module"></span><h2>thetis.shallowwater_eq module<a class="headerlink" href="#module-thetis.shallowwater_eq" title="Permalink to this headline">¶</a></h2>
<p>Depth averaged shallow water equations</p>
<div class="section" id="equations">
<h3>Equations<a class="headerlink" href="#equations" title="Permalink to this headline">¶</a></h3>
<p>The state variables are water elevation, <span class="math">\(\eta\)</span>, and depth averaged
velocity <span class="math">\(\bar{\textbf{u}}\)</span>.</p>
<p>Denoting the total water depth by <span class="math">\(H=\eta + h\)</span>, the non-conservative form of
the free surface equation is</p>
<div class="math" id="equation-swe_freesurf">
<span class="eqno">(4)<a class="headerlink" href="#equation-swe_freesurf" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<p>The non-conservative momentum equation reads</p>
<div class="math" id="equation-swe_momentum">
<span class="eqno">(5)<a class="headerlink" href="#equation-swe_momentum" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta +
g \frac{1}{H}\int_{-h}^\eta \nabla r dz
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ),\]</div>
<p>where <span class="math">\(g\)</span> is the gravitational acceleration, <span class="math">\(f\)</span> is the Coriolis
frequency, <span class="math">\(\wedge\)</span> is the cross product,
<span class="math">\(\textbf{e}_z\)</span> is a vertical unit vector, and <span class="math">\(\nu_h\)</span>
is viscosity. Water density is given by <span class="math">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math">\(\rho_0\)</span> is a constant reference density.</p>
<p>Above <span class="math">\(r\)</span> denotes the baroclinic head</p>
<div class="math">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>In the case of purely barotropic problems the <span class="math">\(r\)</span> and the internal pressure
gradient are omitted.</p>
<p>If the option <a class="reference internal" href="#thetis.options.ModelOptions.nonlin" title="thetis.options.ModelOptions.nonlin"><code class="xref py py-attr docutils literal"><span class="pre">ModelOptions.nonlin</span></code></a> is <code class="docutils literal"><span class="pre">False</span></code>, we solve the linear shallow water
equations (i.e. wave equation):</p>
<div class="math" id="equation-swe_freesurf_linear">
<span class="eqno">(6)<a class="headerlink" href="#equation-swe_freesurf_linear" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (h \bar{\textbf{u}}) = 0\]</div>
<div class="math" id="equation-swe_momentum_linear">
<span class="eqno">(7)<a class="headerlink" href="#equation-swe_momentum_linear" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ).\]</div>
<p>In case of a 3D problem with mode splitting, we use a simplified 2D
system that contains nothing but the rotational external gravity waves:</p>
<div class="math" id="equation-swe_freesurf_modesplit">
<span class="eqno">(8)<a class="headerlink" href="#equation-swe_freesurf_modesplit" title="Permalink to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<div class="math" id="equation-swe_momentum_modesplit">
<span class="eqno">(9)<a class="headerlink" href="#equation-swe_momentum_modesplit" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta + g \frac{1}{H}\int_{-h}^\eta \nabla r dz
= \textbf{G},\]</div>
<p>where <span class="math">\(\textbf{G}\)</span> is a source term used to couple the 2D and 3D momentum
equations.</p>
</div>
<div class="section" id="boundary-conditions">
<h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>All boundary conditions are imposed weakly by providing external values for
<span class="math">\(\eta\)</span> and <span class="math">\(\bar{\textbf{u}}\)</span>.</p>
<p>Boundary conditions are set with a dictionary that defines all prescribed
variables at each open boundary.
For example, to assign elevation and volume flux on boundary <code class="docutils literal"><span class="pre">1</span></code> we set</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">swe_bnd_funcs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">swe_bnd_funcs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev&#39;</span><span class="p">:</span><span class="n">myfunc1</span><span class="p">,</span> <span class="s1">&#39;flux&#39;</span><span class="p">:</span><span class="n">myfunc2</span><span class="p">}</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">myfunc1</span></code> and <code class="docutils literal"><span class="pre">myfunc2</span></code> are <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>
objects.</p>
<p>The user can provide <span class="math">\(\eta\)</span> and/or <span class="math">\(\bar{\textbf{u}}\)</span> values.
Supported combinations are:</p>
<ul class="simple">
<li><em>unspecified</em> : impermeable (land) boundary, implies symmetric <span class="math">\(\eta\)</span> condition and zero normal velocity</li>
<li><code class="docutils literal"><span class="pre">'elev'</span></code>: elevation only, symmetric velocity (usually unstable)</li>
<li><code class="docutils literal"><span class="pre">'uv'</span></code>: 2d velocity vector <span class="math">\(\bar{\textbf{u}}=(u, v)\)</span> (in mesh coordinates), symmetric elevation</li>
<li><code class="docutils literal"><span class="pre">'un'</span></code>: normal velocity (scalar, positive out of domain), symmetric elevation</li>
<li><code class="docutils literal"><span class="pre">'flux'</span></code>: normal volume flux (scalar, positive out of domain), symmetric elevation</li>
<li><code class="docutils literal"><span class="pre">'elev'</span></code> and <code class="docutils literal"><span class="pre">'uv'</span></code>: water elevation and 2d velocity vector</li>
<li><code class="docutils literal"><span class="pre">'elev'</span></code> and <code class="docutils literal"><span class="pre">'un'</span></code>: water elevation and normal velocity</li>
<li><code class="docutils literal"><span class="pre">'elev'</span></code> and <code class="docutils literal"><span class="pre">'flux'</span></code>: water elevation and normal flux</li>
</ul>
<p>The boundary conditions are assigned to the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal"><span class="pre">FlowSolver2d</span></code></a> or
<a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code></a> objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">bnd_functions</span><span class="p">[</span><span class="s1">&#39;shallow_water&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">swe_bnd_funcs</span>
</pre></div>
</div>
<p>Internally the boundary conditions passed to the <a class="reference internal" href="#thetis.equation.Term.residual" title="thetis.equation.Term.residual"><code class="xref py py-meth docutils literal"><span class="pre">Term.residual()</span></code></a> method
of each term:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">adv_term</span> <span class="o">=</span> <span class="n">shallowwater_eq</span><span class="o">.</span><span class="n">HorizontalAdvectionTerm</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">adv_form</span> <span class="o">=</span> <span class="n">adv_term</span><span class="o">.</span><span class="n">residual</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bnd_conditions</span><span class="o">=</span><span class="n">swe_bnd_funcs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">BaseShallowWaterEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Abstract base class for ShallowWaterEquations, ShallowWaterMomentumEquation
and FreeSurfaceEquation.</p>
<p>Provides common functionality to compute time steps and add either momentum
or continuity terms.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms">
<code class="descname">add_continuity_terms</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_continuity_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms">
<code class="descname">add_momentum_terms</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_momentum_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta">
<code class="descname">residual_uv_eta</code><span class="sig-paren">(</span><em>label</em>, <em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.residual_uv_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterEquations</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations in non-conservative form.</p>
<p>This defines the full 2D SWE equations <a class="reference internal" href="#equation-swe_freesurf">(4)</a> -
<a class="reference internal" href="#equation-swe_momentum">(5)</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; Mixed function space where the solution belongs</li>
<li><strong>bathymetry</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>include_grad_div_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(nu div(u))
viscosity term</li>
<li><strong>include_grad_depth_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(H) term
in viscosity operator</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterEquations.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ModeSplit2DEquations</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations for mode splitting schemes.</p>
<p>Defines the equations <a class="reference internal" href="#equation-swe_freesurf_modesplit">(8)</a> -
<a class="reference internal" href="#equation-swe_momentum_modesplit">(9)</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; Mixed function space where the solution belongs</li>
<li><strong>bathymetry</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>include_grad_div_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(nu div(u))
viscosity term</li>
<li><strong>include_grad_depth_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(H) term
in viscosity operator</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms">
<code class="descname">add_momentum_terms</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.add_momentum_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.ModeSplit2DEquations.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterMomentumEquation</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D depth averaged momentum equation <a class="reference internal" href="#equation-swe_momentum">(5)</a> in non-conservative
form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>eta_test</strong> &#8211; test function of the elevation function space</li>
<li><strong>eta_space</strong> &#8211; elevation function space</li>
<li><strong>u_space</strong> &#8211; velocity function space</li>
<li><strong>function_space</strong> &#8211; Mixed function space where the solution belongs</li>
<li><strong>bathymetry</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
<li><strong>include_grad_div_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(nu div(u))
viscosity term</li>
<li><strong>include_grad_depth_viscosity_term</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True includes grad(H) term
in viscosity operator</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">FreeSurfaceEquation</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.BaseShallowWaterEquation</span></code></a></p>
<p>2D free surface equation <a class="reference internal" href="#equation-swe_freesurf">(4)</a> in non-conservative form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>eta_test</strong> &#8211; test function of the elevation function space</li>
<li><strong>eta_space</strong> &#8211; elevation function space</li>
<li><strong>u_space</strong> &#8211; velocity function space</li>
<li><strong>function_space</strong> &#8211; Mixed function space where the solution belongs</li>
<li><strong>bathymetry</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>nonlin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If False defines the linear shallow water equations</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.shallowwater_eq.FreeSurfaceEquation.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>label</em>, <em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterTerm</code><span class="sig-paren">(</span><em>space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic term in the shallow water equations that provides commonly used
members and mapping for boundary functions.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions">
<code class="descname">get_bnd_functions</code><span class="sig-paren">(</span><em>eta_in</em>, <em>uv_in</em>, <em>bnd_id</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of elev and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.shallowwater_eq.ShallowWaterTerm.get_total_depth">
<code class="descname">get_total_depth</code><span class="sig-paren">(</span><em>eta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_total_depth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_total_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total water column depth</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterMomentumTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterMomentumTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the shallow water momentum equation that provides commonly used
members and mapping for boundary functions.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ShallowWaterContinuityTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ShallowWaterContinuityTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterContinuityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterTerm</span></code></a></p>
<p>Generic term in the depth-integrated continuity equation that provides commonly used
members and mapping for boundary functions.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HUDivTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HUDivTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Divergence term, <span class="math">\(\nabla \cdot (H \bar{\textbf{u}})\)</span></p>
<p>The weak form reads</p>
<div class="math">
\[\int_\Omega \nabla \cdot (H \bar{\textbf{u}}) \phi dx
= \int_\Gamma (H^* \bar{\textbf{u}}^*) \cdot \text{jump}(\phi \textbf{n}) dS
- \int_\Omega H (\bar{\textbf{u}}\cdot\nabla \phi) dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, and <span class="math">\(\text{jump}\)</span>
and <span class="math">\(\text{avg}\)</span> denote the jump and average operators across the
interface. <span class="math">\(H^*, \bar{\textbf{u}}^*\)</span> are values at the interface
obtained from an approximate Riemann solver.</p>
<p>If <span class="math">\(\bar{\textbf{u}}\)</span> belongs to a discontinuous function space,
the form on the right hand side is used.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.HUDivTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ContinuitySourceTerm</code><span class="sig-paren">(</span><em>eta_test</em>, <em>eta_space</em>, <em>u_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterContinuityTerm</span></code></a></p>
<p>Generic source term in the depth-averaged continuity equation</p>
<p>The weak form reads</p>
<div class="math">
\[F_s = \int_\Omega S \phi dx\]</div>
<p>where <span class="math">\(S\)</span> is a user defined scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the sign convention of <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a>, this term is assembled to the left hand side of the equation</p>
</div>
<dl class="method">
<dt id="thetis.shallowwater_eq.ContinuitySourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Advection of momentum term, <span class="math">\(\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}}\)</span></p>
<p>The weak form is</p>
<div class="math">
\[\int_\Omega \bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot \bar{\textbf{u}} dx
+ \int_\Gamma \text{avg}(\bar{\textbf{u}}) \cdot \text{jump}(\boldsymbol{\psi}
(\bar{\textbf{u}}\cdot\textbf{n})) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math">\(\text{jump}\)</span> and <span class="math">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">HorizontalViscosityTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Viscosity of momentum term</p>
<p>If option <a class="reference internal" href="#thetis.options.ModelOptions.include_grad_div_viscosity_term" title="thetis.options.ModelOptions.include_grad_div_viscosity_term"><code class="xref py py-attr docutils literal"><span class="pre">ModelOptions.include_grad_div_viscosity_term</span></code></a> is <code class="docutils literal"><span class="pre">True</span></code>, we
use the symmetric viscous stress <span class="math">\(\boldsymbol{\tau}_\nu = \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\)</span>.
Using the symmetric interior penalty method the weak form then reads</p>
<div class="math">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>where <span class="math">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>If option <a class="reference internal" href="#thetis.options.ModelOptions.include_grad_div_viscosity_term" title="thetis.options.ModelOptions.include_grad_div_viscosity_term"><code class="xref py py-attr docutils literal"><span class="pre">ModelOptions.include_grad_div_viscosity_term</span></code></a> is <code class="docutils literal"><span class="pre">False</span></code>,
we use viscous stress <span class="math">\(\boldsymbol{\tau}_\nu = \nu_h \nabla \bar{\textbf{u}}\)</span>.
In this case the weak form is</p>
<div class="math">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>If option <a class="reference internal" href="#thetis.options.ModelOptions.include_grad_depth_viscosity_term" title="thetis.options.ModelOptions.include_grad_depth_viscosity_term"><code class="xref py py-attr docutils literal"><span class="pre">ModelOptions.include_grad_depth_viscosity_term</span></code></a> is <code class="docutils literal"><span class="pre">True</span></code>, we also include
the term</p>
<div class="math">
\[\boldsymbol{\tau}_{\nabla H} = - \frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\]</div>
<p>as a source term.</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the minus sign due to <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a> sign convention</p>
</div>
<dl class="method">
<dt id="thetis.shallowwater_eq.HorizontalViscosityTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">ExternalPressureGradientTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>External pressure gradient term, <span class="math">\(g \nabla \eta\)</span></p>
<p>The weak form reads</p>
<div class="math">
\[\int_\Omega g \nabla \eta \cdot \boldsymbol{\psi} dx
= \int_\Gamma g \eta^* \text{jump}(\boldsymbol{\psi} \cdot \textbf{n}) dS
- \int_\Omega g \eta \nabla \cdot \boldsymbol{\psi} dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, <span class="math">\(n^*\)</span> is value at
the interface obtained from an approximate Riemann solver.</p>
<p>If <span class="math">\(\eta\)</span> belongs to a discontinuous function space, the form on the
right hand side is used.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.ExternalPressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.InternalPressureGradientTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">InternalPressureGradientTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#InternalPressureGradientTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.InternalPressureGradientTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Internal pressure gradient term</p>
<div class="math">
\[F_{IPG} = \frac{g}{H} \int_{-h}^{\eta} (\nabla r) dz,\]</div>
<p>where <span class="math">\(r\)</span> is the baroc_head.
Let <span class="math">\(s\)</span> denote <span class="math">\(r/H\)</span>. We can then write</p>
<div class="math">
\[F_{IPG} = g\nabla(\bar{s} H) - g\nabla \Big(\frac{1}{H} \Big) H^2\bar{s} - g s_{bot}\nabla h\]</div>
<p>where <span class="math">\(\bar{s},s_{bot}\)</span> are the depth average and bottom value of
<span class="math">\(s\)</span>. This term is implemented as a source term not integrated by
parts.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.InternalPressureGradientTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#InternalPressureGradientTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.InternalPressureGradientTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.CoriolisTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">CoriolisTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<dl class="method">
<dt id="thetis.shallowwater_eq.CoriolisTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.LinearDragTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">LinearDragTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Linear friction term, <span class="math">\(C \bar{\textbf{u}}\)</span></p>
<p>Here <span class="math">\(C\)</span> is a user-defined drag coefficient.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.LinearDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">QuadraticDragTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Quadratic Manning bottom friction term
<span class="math">\(C_D \| \bar{\textbf{u}} \| \bar{\textbf{u}}\)</span></p>
<p>where the drag term is computed with the Manning formula</p>
<div class="math">
\[C_D = g \frac{\mu^2}{H^{1/3}}\]</div>
<p>if the Manning coefficient <span class="math">\(\mu\)</span> is defined (see field <code class="xref py py-attr docutils literal"><span class="pre">mu_manning</span></code>).
Otherwise <span class="math">\(C_D\)</span> is taken as a constant (see field <code class="xref py py-attr docutils literal"><span class="pre">quadratic_drag</span></code>).</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.QuadraticDragTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">BottomDrag3DTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Bottom drag term consistent with the 3D mode,
<span class="math">\(C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>Here <span class="math">\(\textbf{u}_b\)</span> is the bottom velocity used in the 3D mode, and
<span class="math">\(C_D\)</span> the corresponding bottom drag.
These fields are computed in the 3D model.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.BottomDrag3DTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">MomentumSourceTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Generic source term in the shallow water momentum equation</p>
<p>The weak form reads</p>
<div class="math">
\[F_s = \int_\Omega \boldsymbol{\tau} \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math">\(\boldsymbol{\tau}\)</span> is a user defined vector valued <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the sign convention of <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a>, this term is assembled to the left hand side of the equation</p>
</div>
<dl class="method">
<dt id="thetis.shallowwater_eq.MomentumSourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.shallowwater_eq.WindStressTerm">
<em class="property">class </em><code class="descclassname">thetis.shallowwater_eq.</code><code class="descname">WindStressTerm</code><span class="sig-paren">(</span><em>u_test</em>, <em>u_space</em>, <em>eta_space</em>, <em>bathymetry=None</em>, <em>nonlin=True</em>, <em>include_grad_div_viscosity_term=False</em>, <em>include_grad_depth_viscosity_term=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.shallowwater_eq.ShallowWaterMomentumTerm</span></code></a></p>
<p>Wind stress term, <span class="math">\(-\tau_w/(H \rho_0)\)</span></p>
<p>Here <span class="math">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.</p>
<dl class="method">
<dt id="thetis.shallowwater_eq.WindStressTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>uv</em>, <em>eta</em>, <em>uv_old</em>, <em>eta_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-thetis.solver">
<span id="thetis-solver-module"></span><h2>thetis.solver module<a class="headerlink" href="#module-thetis.solver" title="Permalink to this headline">¶</a></h2>
<p>Module for three dimensional baroclinic solver</p>
<dl class="class">
<dt id="thetis.solver.FlowSolver">
<em class="property">class </em><code class="descclassname">thetis.solver.</code><code class="descname">FlowSolver</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>bathymetry_2d</em>, <em>n_layers</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Main object for 3D solver</p>
<p><strong>Example</strong></p>
<p>Create 2D mesh</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thetis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a 3D model with 6 uniform levels, and set some options
(see <a class="reference internal" href="#thetis.options.ModelOptions" title="thetis.options.ModelOptions"><code class="xref py py-class docutils literal"><span class="pre">ModelOptions</span></code></a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;ssprk22&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_salt</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_temp</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">t_export</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">t_end</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh2d</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code> object of the 2D mesh</li>
<li><strong>bathymetry_2d</strong> (2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</li>
<li><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of layers in the vertical direction.
Elements are distributed uniformly over the vertical.</li>
<li><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions" title="thetis.options.ModelOptions"><code class="xref py py-class docutils literal"><span class="pre">ModelOptions</span></code></a> instance) &#8211; Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver.FlowSolver.options" title="thetis.solver.FlowSolver.options"><code class="xref py py-attr docutils literal"><span class="pre">options</span></code></a> class property.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="thetis.solver.FlowSolver.M_modesplit">
<code class="descname">M_modesplit</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.M_modesplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Mode split ratio (int)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>eval_interval='export'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>callback</strong> &#8211; <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticCallback</span></code></a> instance</li>
<li><strong>eval_interval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Determines when callback will be evaluated,
either &#8216;export&#8217; or &#8216;timestep&#8217; for evaluating after each export or
time step.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.assign_initial_conditions">
<code class="descname">assign_initial_conditions</code><span class="sig-paren">(</span><em>elev=None</em>, <em>salt=None</em>, <em>temp=None</em>, <em>uv_2d=None</em>, <em>uv_3d=None</em>, <em>tke=None</em>, <em>psi=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>elev</strong> (scalar 2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for water elevation</li>
<li><strong>salt</strong> (scalar 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for salinity field</li>
<li><strong>temp</strong> (scalar 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for temperature field</li>
<li><strong>uv_2d</strong> (vector valued 2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for depth averaged velocity</li>
<li><strong>uv_3d</strong> (vector valued 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for horizontal velocity</li>
<li><strong>tke</strong> (scalar 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for turbulent kinetic energy field</li>
<li><strong>psi</strong> (scalar 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for turbulence generic lenght scale field</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.callbacks">
<code class="descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dt_2d">
<code class="descname">compute_dt_2d</code><span class="sig-paren">(</span><em>u_scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math">\(U_{scale}\)</span> is estimated advective velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; User provided maximum advective velocity scale</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dt_diffusion">
<code class="descname">compute_dt_diffusion</code><span class="sig-paren">(</span><em>nu_scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_diffusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal diffusion.</p>
<div class="math">
\[\Delta t = \alpha \frac{(\Delta x)^2}{\nu_{scale}}\]</div>
<p>where <span class="math">\(\nu_{scale}\)</span> is estimated diffusivity scale.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dt_h_advection">
<code class="descname">compute_dt_h_advection</code><span class="sig-paren">(</span><em>u_scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_h_advection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_h_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal advection</p>
<div class="math">
\[\Delta t = \frac{\Delta x}{U_{scale}}\]</div>
<p>where <span class="math">\(U_{scale}\)</span> is estimated horizontal advective velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; User provided maximum horizontal velocity scale</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dt_v_advection">
<code class="descname">compute_dt_v_advection</code><span class="sig-paren">(</span><em>w_scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_v_advection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_v_advection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for vertical advection</p>
<div class="math">
\[\Delta t = \frac{\Delta z}{W_{scale}}\]</div>
<p>where <span class="math">\(W_{scale}\)</span> is estimated vertical advective velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>w_scale</strong> (float or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; User provided maximum vertical velocity scale</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dx_factor">
<code class="descname">compute_dx_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dx_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dx_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes normalized distance between nodes in the horizontal direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.compute_dz_factor">
<code class="descname">compute_dz_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dz_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dz_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a normalized distance between nodes in the vertical direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.create_equations">
<code class="descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates all dynamic equations and time integrators</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.create_function_spaces">
<code class="descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver.FlowSolver.function_spaces" title="thetis.solver.FlowSolver.function_spaces"><code class="xref py py-attr docutils literal"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.dt">
<code class="descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.dt_2d">
<code class="descname">dt_2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.dt_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Time of the 2D solver</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to &#8216;export&#8217; interval.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.export_initial_state">
<code class="descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.fields">
<code class="descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.fields" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.function_spaces">
<code class="descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.iterate">
<code class="descname">iterate</code><span class="sig-paren">(</span><em>update_forcings=None</em>, <em>update_forcings3d=None</em>, <em>export_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Iterates over the time loop until time <code class="docutils literal"><span class="pre">options.t_end</span></code> is reached.
Exports fields to disk on <code class="docutils literal"><span class="pre">options.t_export</span></code> intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>update_forcings</strong> &#8211; User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 2D system (if any).</li>
<li><strong>update_forcings_3d</strong> &#8211; User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 3D equations (if any).</li>
<li><strong>export_func</strong> &#8211; User-defined function (with no arguments) that will
be called on every export.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.load_state">
<code class="descname">load_state</code><span class="sig-paren">(</span><em>i_export</em>, <em>outputdir=None</em>, <em>t=None</em>, <em>iteration=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces <a class="reference internal" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="thetis.solver.FlowSolver.assign_initial_conditions"><code class="xref py py-meth docutils literal"><span class="pre">assign_initial_conditions()</span></code></a> in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format.  The required
state variables are: elev_2d, uv_2d, uv_3d, salt_3d, temp_3d, tke_3d,
psi_3d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; export index to load</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; (optional) directory where files are read from.
By default <code class="docutils literal"><span class="pre">options.outputdir</span></code>.</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time. Overrides the time stamp stored in the
hdf5 files.</li>
<li><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Overrides the iteration count in the hdf5 files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.mesh">
<code class="descname">mesh</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>3D :class`Mesh`</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.mesh2d">
<code class="descname">mesh2d</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.mesh2d" title="Permalink to this definition">¶</a></dt>
<dd><p>2D :class`Mesh`</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver.FlowSolver.options">
<code class="descname">options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver.FlowSolver.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions" title="thetis.options.ModelOptions"><code class="xref py py-class docutils literal"><span class="pre">ModelOptions</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.print_state">
<code class="descname">print_state</code><span class="sig-paren">(</span><em>cputime</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Measured CPU time</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver.FlowSolver.set_time_step">
<code class="descname">set_time_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver.FlowSolver.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>Uses <code class="docutils literal"><span class="pre">options.dt</span></code> and <code class="docutils literal"><span class="pre">options.dt_2d</span></code> if set, otherwise sets the
maximum time step allowed by the CFL conditions.</p>
<p>Once the time step is determined, will adjust it to be an integer
fraction of export interval <code class="docutils literal"><span class="pre">options.t_export</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.solver.timed_region">
<code class="descclassname">thetis.solver.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.solver.timed_stage">
<code class="descclassname">thetis.solver.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.solver2d">
<span id="thetis-solver2d-module"></span><h2>thetis.solver2d module<a class="headerlink" href="#module-thetis.solver2d" title="Permalink to this headline">¶</a></h2>
<p>Module for 2D depth averaged solver</p>
<dl class="class">
<dt id="thetis.solver2d.FlowSolver2d">
<em class="property">class </em><code class="descclassname">thetis.solver2d.</code><code class="descname">FlowSolver2d</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>bathymetry_2d</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.FrozenClass</span></code></a></p>
<p>Main object for 2D depth averaged solver</p>
<p><strong>Example</strong></p>
<p>Create mesh</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thetis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create solver object and set some options</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;cranknicolson&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">t_export</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">t_end</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh2d</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Mesh</span></code> object of the 2D mesh</li>
<li><strong>bathymetry_2d</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</li>
<li><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions" title="thetis.options.ModelOptions"><code class="xref py py-class docutils literal"><span class="pre">ModelOptions</span></code></a> instance) &#8211; Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.options" title="thetis.solver2d.FlowSolver2d.options"><code class="xref py py-attr docutils literal"><span class="pre">options</span></code></a> class property.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.add_callback">
<code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>eval_interval='export'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>callback</strong> &#8211; <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticCallback</span></code></a> instance</li>
<li><strong>eval_interval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Determines when callback will be evaluated,
either &#8216;export&#8217; or &#8216;timestep&#8217; for evaluating after each export or
time step.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.assign_initial_conditions">
<code class="descname">assign_initial_conditions</code><span class="sig-paren">(</span><em>elev=None</em>, <em>uv=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.assign_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>elev</strong> (scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for water elevation</li>
<li><strong>uv</strong> (vector valued <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>, or an expression) &#8211; Initial condition for depth averaged velocity</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.callbacks">
<code class="descname">callbacks</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.compute_time_step">
<code class="descname">compute_time_step</code><span class="sig-paren">(</span><em>u_scale=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>6)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.compute_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.compute_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math">\(U_{scale}\)</span> is estimated advective velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; User provided maximum advective velocity scale</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_equations">
<code class="descname">create_equations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates shallow water equations</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_exporters">
<code class="descname">create_exporters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_exporters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_exporters" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates file exporters</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_function_spaces">
<code class="descname">create_function_spaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_function_spaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="thetis.solver2d.FlowSolver2d.function_spaces"><code class="xref py py-attr docutils literal"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.create_timestepper">
<code class="descname">create_timestepper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_timestepper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_timestepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates time stepper instance</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.dt">
<code class="descname">dt</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.export">
<code class="descname">export</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to &#8216;export&#8217; interval.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.export_initial_state">
<code class="descname">export_initial_state</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.fields">
<code class="descname">fields</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.fields" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.function_spaces">
<code class="descname">function_spaces</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates function spaces, equations, time stepper and exporters</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.iterate">
<code class="descname">iterate</code><span class="sig-paren">(</span><em>update_forcings=None</em>, <em>export_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Iterates over the time loop until time <code class="docutils literal"><span class="pre">options.t_end</span></code> is reached.
Exports fields to disk on <code class="docutils literal"><span class="pre">options.t_export</span></code> intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>update_forcings</strong> &#8211; User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
(if any).</li>
<li><strong>export_func</strong> &#8211; User-defined function (with no arguments) that will
be called on every export.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.load_state">
<code class="descname">load_state</code><span class="sig-paren">(</span><em>i_export</em>, <em>outputdir=None</em>, <em>t=None</em>, <em>iteration=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.load_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.load_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>This replaces <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="thetis.solver2d.FlowSolver2d.assign_initial_conditions"><code class="xref py py-meth docutils literal"><span class="pre">assign_initial_conditions()</span></code></a> in model initilization.</p>
<p>This assumes that model setup is kept the same (e.g. time step) and
all pronostic state variables are exported in hdf5 format. The required
state variables are: elev_2d, uv_2d</p>
<p>Currently hdf5 field import only works for the same number of MPI
processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; export index to load</li>
<li><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; (optional) directory where files are read from.
By default <code class="docutils literal"><span class="pre">options.outputdir</span></code>.</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time. Overrides the time stamp stored in the
hdf5 files.</li>
<li><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Overrides the iteration count in the hdf5 files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="thetis.solver2d.FlowSolver2d.options">
<code class="descname">options</code><em class="property"> = None</em><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions" title="thetis.options.ModelOptions"><code class="xref py py-class docutils literal"><span class="pre">ModelOptions</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.print_state">
<code class="descname">print_state</code><span class="sig-paren">(</span><em>cputime</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.print_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.print_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Measured CPU time</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.solver2d.FlowSolver2d.set_time_step">
<code class="descname">set_time_step</code><span class="sig-paren">(</span><em>alpha=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_time_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>Uses <code class="docutils literal"><span class="pre">options.dt</span></code> if set, otherwise sets the maximum time step
allowed by the CFL condition (see <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.compute_time_step" title="thetis.solver2d.FlowSolver2d.compute_time_step"><code class="xref py py-meth docutils literal"><span class="pre">compute_time_step()</span></code></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; CFL number scaling factor</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.solver2d.timed_region">
<code class="descclassname">thetis.solver2d.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.solver2d.timed_stage">
<code class="descclassname">thetis.solver2d.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.solver2d.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.stability_functions">
<span id="thetis-stability-functions-module"></span><h2>thetis.stability_functions module<a class="headerlink" href="#module-thetis.stability_functions" title="Permalink to this headline">¶</a></h2>
<p>Implements turbulence closure model stability functions.</p>
<div class="math">
\[\begin{split}S_m &amp;= S_m(\alpha_M, \alpha_N) \\
S_\rho &amp;= S_\rho(\alpha_M, \alpha_N)\end{split}\]</div>
<p>where <span class="math">\(\alpha_M, \alpha_N\)</span> are the normalized shear and buoyancy frequency</p>
<blockquote>
<div><div class="math">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
</div></blockquote>
<p>The following stability functions have been implemented</p>
<ul class="simple">
<li>Canuto A</li>
<li>Canuto B</li>
<li>Kantha-Clayson</li>
<li>Cheng</li>
</ul>
<p>References:</p>
<p>Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models
for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795&#8211;827. <a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></p>
<p>Burchard, H. and Bolding, K. (2001). Comparative Analysis of Four
Second-Moment Turbulence Closure Models for the Oceanic Mixed Layer. Journal of
Physical Oceanography, 31(8):1943&#8211;1968.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></p>
<p>Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for
geophysical turbulence models. Journal of Marine Research, 61:235&#8211;265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></p>
<dl class="class">
<dt id="thetis.stability_functions.StabilityFunction">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunction</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Base class for all stability functions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; limit maximum <span class="math">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</li>
<li><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; limit minimum (negative) <span class="math">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</li>
<li><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; if <span class="math">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math">\(\alpha_N\)</span> is clipped at minimum value.</li>
<li><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; parameter for <span class="math">\(\alpha_N\)</span> smooth limiter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.compute_c3_minus">
<code class="descname">compute_c3_minus</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em>, <em>ri_st</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.compute_c3_minus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.compute_c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute c3_minus parameter from c1, c2 and stability functions.</p>
<p>c3_minus is solved from equation</p>
<div class="math">
\[Ri_{st} = \frac{s_m}{s_h} \frac{c2 - c1}{c2 - c3_minus}\]</div>
<p>where <span class="math">\(Ri_{st}\)</span> is the steady state gradient Richardson number.
(see Burchard and Bolding, 2001, eq 32)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.compute_cmu0">
<code class="descname">compute_cmu0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.compute_cmu0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.compute_cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the paramenter c_mu_0 from stability function parameters</p>
<p>Umlauf and Buchard (2005) eq A.22</p>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.compute_kappa">
<code class="descname">compute_kappa</code><span class="sig-paren">(</span><em>sigma_psi</em>, <em>n</em>, <em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.compute_kappa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.compute_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes von Karman constant from the Psi Schmidt number.</p>
<p>n, c1, c2 are GLS model parameters.</p>
<p>from Umlauf and Burchard (2003) eq (14)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.eval_funcs">
<code class="descname">eval_funcs</code><span class="sig-paren">(</span><em>alpha_buoy</em>, <em>alpha_shear</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.eval_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.eval_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate (unlimited) stability functions</p>
<p>from Burchard and Petersen (1999) eqns (30) and (31)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alpha_buoy</strong> &#8211; normalized buoyancy frequency <span class="math">\(\alpha_N\)</span></li>
<li><strong>alpha_shear</strong> &#8211; normalized shear frequency <span class="math">\(\alpha_M\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>shear2</em>, <em>buoy2</em>, <em>k</em>, <em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates stability functions. Applies limiters on alpha_buoy and alpha_shear.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shear2</strong> &#8211; <span class="math">\(M^2\)</span></li>
<li><strong>buoy2</strong> &#8211; <span class="math">\(N^2\)</span></li>
<li><strong>k</strong> &#8211; turbulent kinetic energy</li>
<li><strong>eps</strong> &#8211; TKE dissipation rate</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.get_alpha_buoy_min">
<code class="descname">get_alpha_buoy_min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.get_alpha_buoy_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.get_alpha_buoy_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute minimum alpha buoy</p>
<p>from Umlauf and Buchard (2005) table 3</p>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.get_alpha_buoy_smooth_min">
<code class="descname">get_alpha_buoy_smooth_min</code><span class="sig-paren">(</span><em>alpha_buoy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.get_alpha_buoy_smooth_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.get_alpha_buoy_smooth_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothed alpha_buoy minimum</p>
<p>from Burchard and Petersen (1999) eq (19)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alpha_buoy</strong> &#8211; normalized buoyancy frequency <span class="math">\(\alpha_N\)</span></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.stability_functions.StabilityFunction.get_alpha_shear_max">
<code class="descname">get_alpha_shear_max</code><span class="sig-paren">(</span><em>alpha_buoy</em>, <em>alpha_shear</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunction.get_alpha_shear_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunction.get_alpha_shear_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute maximum alpha shear</p>
<p>from Umlauf and Buchard (2005) eq (44)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alpha_buoy</strong> &#8211; normalized buoyancy frequency <span class="math">\(\alpha_N\)</span></li>
<li><strong>alpha_shear</strong> &#8211; normalized shear frequency <span class="math">\(\alpha_M\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoA">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCanutoA</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.stability_functions.StabilityFunction" title="thetis.stability_functions.StabilityFunction"><code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></a></p>
<p>Canuto et al. (2001) version A stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCanutoB">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCanutoB</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.stability_functions.StabilityFunction" title="thetis.stability_functions.StabilityFunction"><code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></a></p>
<p>Canuto et al. (2001) version B stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionKanthaClayson">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionKanthaClayson</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionKanthaClayson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionKanthaClayson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.stability_functions.StabilityFunction" title="thetis.stability_functions.StabilityFunction"><code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></a></p>
<p>Kantha and Clayson (1994) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
</dd></dl>

<dl class="class">
<dt id="thetis.stability_functions.StabilityFunctionCheng">
<em class="property">class </em><code class="descclassname">thetis.stability_functions.</code><code class="descname">StabilityFunctionCheng</code><span class="sig-paren">(</span><em>lim_alpha_shear=True</em>, <em>lim_alpha_buoy=True</em>, <em>smooth_alpha_buoy_lim=True</em>, <em>alpha_buoy_crit=-1.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCheng"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.stability_functions.StabilityFunction" title="thetis.stability_functions.StabilityFunction"><code class="xref py py-class docutils literal"><span class="pre">thetis.stability_functions.StabilityFunction</span></code></a></p>
<p>Cheng et al. (2002) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
</dd></dl>

<dl class="function">
<dt id="thetis.stability_functions.compute_normalized_frequencies">
<code class="descclassname">thetis.stability_functions.</code><code class="descname">compute_normalized_frequencies</code><span class="sig-paren">(</span><em>shear2</em>, <em>buoy2</em>, <em>k</em>, <em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#compute_normalized_frequencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.stability_functions.compute_normalized_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes normalized buoyancy and shear frequency squared.</p>
<div class="math">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
<p>From Burchard and Bolding (2001).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shear2</strong> &#8211; <span class="math">\(M^2\)</span></li>
<li><strong>buoy2</strong> &#8211; <span class="math">\(N^2\)</span></li>
<li><strong>k</strong> &#8211; turbulent kinetic energy</li>
<li><strong>eps</strong> &#8211; TKE dissipation rate</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-thetis.timeintegrator">
<span id="thetis-timeintegrator-module"></span><h2>thetis.timeintegrator module<a class="headerlink" href="#module-thetis.timeintegrator" title="Permalink to this headline">¶</a></h2>
<p>Generic time integration schemes to advance equations in time.</p>
<dl class="class">
<dt id="thetis.timeintegrator.CrankNicolson">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">CrankNicolson</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>theta=0.5</em>, <em>semi_implicit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard Crank-Nicolson time integration scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.CrankNicolson.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.CrankNicolson.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.ForwardEuler">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">ForwardEuler</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Standard forward Euler time integration scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.ForwardEuler.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.ForwardEuler.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.update_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.LeapFrogAM3">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">LeapFrogAM3</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 ALE time integrator</p>
<p>Defined in (2.27)-(2.30) in [1]; (2.21)-(2.22) in [2]</p>
<p>[1] Shchepetkin and McWilliams (2005). The regional oceanic modeling system
(ROMS): a split-explicit, free-surface, topography-following-coordinate
oceanic model. Ocean Modelling, 9(4):347-404.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2013.04.010">http://dx.doi.org/10.1016/j.ocemod.2013.04.010</a></p>
<p>[2] Shchepetkin and McWilliams (2009). Computational Kernel Algorithms for
Fine-Scale, Multiprocess, Longtime Oceanic Simulations, 14:121-183.
<a class="reference external" href="http://dx.doi.org/10.1016/S1570-8659(08)01202-0">http://dx.doi.org/10.1016/S1570-8659(08)01202-0</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.LeapFrogAM3.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.LeapFrogAM3.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.5874</em><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.LeapFrogAM3.correct">
<code class="descname">correct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Correction step from <span class="math">\(t_{n}\)</span> to <span class="math">\(t_{n+1}\)</span></p>
<p>Let <span class="math">\(M_n\)</span> denote the mass matrix at time <span class="math">\(t_{n}\)</span>.
The correction step is</p>
<div class="math">
\[M_{n+1} T_{n+1} = M_{n} T_{n} + \Delta t L_{n+1/2}\]</div>
<p>This is Euler ALE step: LHS is evaluated in <span class="math">\(\Omega_{n+1}\)</span>,
RHS in <span class="math">\(\Omega_n\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.LeapFrogAM3.eval_rhs">
<code class="descname">eval_rhs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.eval_rhs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.eval_rhs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.LeapFrogAM3.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.LeapFrogAM3.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Prediction step from <span class="math">\(t_{n-1/2}\)</span> to <span class="math">\(t_{n+1/2}\)</span></p>
<p>Let <span class="math">\(M_n\)</span> denote the mass matrix at time <span class="math">\(t_{n}\)</span>.
The prediction step is</p>
<div class="math">
\[\begin{split}T_{n-1/2} &amp;= (1/2 - 2\gamma) T_{n-1} + (1/2 + 2 \gamma) T_{n} \\
M_n T_{n+1/2} &amp;= M_n T_{n-1/2} + \Delta t (1 - 2\gamma) M_n L_{n}\end{split}\]</div>
<p>This is computed in a fixed mesh: all terms are evaluated in
<span class="math">\(\Omega_n\)</span>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.PressureProjectionPicard">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">PressureProjectionPicard</code><span class="sig-paren">(</span><em>equation</em>, <em>equation_mom</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>solver_parameters_mom={}</em>, <em>theta=0.5</em>, <em>semi_implicit=False</em>, <em>iterations=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Pressure projection scheme with Picard iteration for shallow water
equations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; free surface equation</li>
<li><strong>equation_mom</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; momentum equation</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>solver_parameters_mom</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options for velocity solver</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Implicitness parameter, default 0.5</li>
<li><strong>semi_implicit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True use a linearized semi-implicit scheme</li>
<li><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of Picard iterations</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>updateForcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.PressureProjectionPicard.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.PressureProjectionPicard.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SSPRK22ALE">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SSPRK22ALE</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>SSPRK(2,2) ALE time integrator for 3D fields</p>
<p>The scheme is</p>
<div class="math">
\[\begin{split}u^{(1)} &amp;= u^{n} + \Delta t F(u^{n}) \\
u^{n+1} &amp;= u^{n} + \frac{\Delta t}{2}(F(u^{n}) +  F(u^{(1)}))\end{split}\]</div>
<p>Both stages are implemented as ALE updates from geometry <span class="math">\(\Omega_n\)</span>
to <span class="math">\(\Omega_{(1)}\)</span>, and <span class="math">\(\Omega_{n+1}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.SSPRK22ALE.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = 1.0</em><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.prepare_stage">
<code class="descname">prepare_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.prepare_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.prepare_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess stage i_stage.</p>
<p>This must be called prior to updating mesh geometry.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_one_prep">
<code class="descname">stage_one_prep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess first stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_one_solve">
<code class="descname">stage_one_solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>First stage: solve <span class="math">\(u^{(1)}\)</span> given previous solution <span class="math">\(u^n\)</span>.</p>
<p>This is a forward Euler ALE step between domains <span class="math">\(\Omega^n\)</span> and <span class="math">\(\Omega^{(1)}\)</span>:</p>
<div class="math">
\[\int_{\Omega^{(1)}} u^{(1)} \psi dx = \int_{\Omega^n} u^n \psi dx + \Delta t \int_{\Omega^n} F(u^n) \psi dx\]</div>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_two_prep">
<code class="descname">stage_two_prep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess 2nd stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SSPRK22ALE.stage_two_solve">
<code class="descname">stage_two_solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>2nd stage: solve <span class="math">\(u^{n+1}\)</span> given previous solutions <span class="math">\(u^n, u^{(1)}\)</span>.</p>
<p>This is an ALE step:</p>
<div class="math">
\[\begin{split}\int_{\Omega^{n+1}} u^{n+1} \psi dx &amp;= \int_{\Omega^n} u^n \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^n} F(u^n) \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^{(1)}} F(u^{(1)}) \psi dx\end{split}\]</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.SteadyState">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">SteadyState</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Time integrator that solves the steady state equations, leaving out the
mass terms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.SteadyState.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.timeintegrator.SteadyState.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.SteadyState.update_solver">
<code class="descname">update_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.update_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.update_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.TimeIntegrator">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">TimeIntegrator</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegratorBase</span></code></a></p>
<p>Base class for all time integrator objects that march a single equation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; the equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.TimeIntegrator.set_dt">
<code class="descname">set_dt</code><span class="sig-paren">(</span><em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.set_dt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.set_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Update time step</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.TimeIntegratorBase">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">TimeIntegratorBase</code><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Abstract class that defines the API for all time integrators</p>
<p>Both <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">TimeIntegrator</span></code></a> and <code class="xref py py-class docutils literal"><span class="pre">CoupledTimeIntegrator</span></code> inherit
from this class.</p>
<dl class="method">
<dt id="thetis.timeintegrator.TimeIntegratorBase.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; simulation time</li>
<li><strong>update_forcings</strong> &#8211; user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.TimeIntegratorBase.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>init_solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the time integrator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>init_solution</strong> &#8211; initial solution</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.timeintegrator.TwoStageTrapezoid">
<em class="property">class </em><code class="descclassname">thetis.timeintegrator.</code><code class="descname">TwoStageTrapezoid</code><span class="sig-paren">(</span><em>equation</em>, <em>solution</em>, <em>fields</em>, <em>dt</em>, <em>bnd_conditions=None</em>, <em>solver_parameters={}</em>, <em>terms_to_add='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TwoStageTrapezoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TwoStageTrapezoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal"><span class="pre">thetis.timeintegrator.TimeIntegrator</span></code></a></p>
<p>Implicit scheme to accompany SSPRK(2,2) ALE time integrator.</p>
<p>The scheme is</p>
<div class="math">
\[\begin{split}u^{(1)} &amp;= u^{n} + \Delta t F(u^{n}) \\
u^{n+1} &amp;= u^{n} + \frac{\Delta t}{2}(F(u^{n}) +  F(u^{n+1}))\end{split}\]</div>
<p>This time integrator is used to solve the 2D system with the 3D SSPRK(2,2)
scheme.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>equation</strong> (<code class="xref py py-class docutils literal"><span class="pre">Equation</span></code> object) &#8211; equation to solve</li>
<li><strong>solution</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where solution will be stored</li>
<li><strong>fields</strong> (dict of <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> objects) &#8211; Dictionary of fields that are passed to the equation</li>
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time step in seconds</li>
<li><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of boundary conditions passed to the equation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
<li><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list of 'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) &#8211; Defines which terms of the equation are to be
added to this solver. Default &#8216;all&#8217; implies [&#8216;implicit&#8217;, &#8216;explicit&#8217;, &#8216;source&#8217;].</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.timeintegrator.TwoStageTrapezoid.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TwoStageTrapezoid.advance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TwoStageTrapezoid.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.timeintegrator.TwoStageTrapezoid.cfl_coeff">
<code class="descname">cfl_coeff</code><em class="property"> = inf</em><a class="headerlink" href="#thetis.timeintegrator.TwoStageTrapezoid.cfl_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.TwoStageTrapezoid.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TwoStageTrapezoid.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TwoStageTrapezoid.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.timeintegrator.TwoStageTrapezoid.solve_stage">
<code class="descname">solve_stage</code><span class="sig-paren">(</span><em>i_stage</em>, <em>t</em>, <em>update_forcings=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TwoStageTrapezoid.solve_stage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.timeintegrator.TwoStageTrapezoid.solve_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.timeintegrator.timed_region">
<code class="descclassname">thetis.timeintegrator.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.timeintegrator.timed_stage">
<code class="descclassname">thetis.timeintegrator.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timeintegrator.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis.tracer_eq">
<span id="thetis-tracer-eq-module"></span><h2>thetis.tracer_eq module<a class="headerlink" href="#module-thetis.tracer_eq" title="Permalink to this headline">¶</a></h2>
<p>3D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of tracer <span class="math">\(T\)</span> in conservative form reads</p>
<div class="math" id="equation-tracer_eq">
<span class="eqno">(10)<a class="headerlink" href="#equation-tracer_eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t}
 + \nabla_h \cdot (\textbf{u} T)
 + \frac{\partial (w T)}{\partial z}
 = \nabla_h \cdot (\mu_h \nabla_h T)
 + \frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big)\]</div>
<p>where <span class="math">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math">\(\textbf{u}\)</span> and
<span class="math">\(w\)</span> are the horizontal and vertical velocities, respectively, and
<span class="math">\(\mu_h\)</span> and <span class="math">\(\mu\)</span> denote horizontal and vertical diffusivity.</p>
<dl class="class">
<dt id="thetis.tracer_eq.TracerEquation">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">TracerEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>3D tracer advection-diffusion equation <a class="reference internal" href="#equation-tracer_eq">(10)</a> in conservative form</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.TracerTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">TracerTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.TracerTerm.get_bnd_functions">
<code class="descname">get_bnd_functions</code><span class="sig-paren">(</span><em>c_in</em>, <em>uv_in</em>, <em>elev_in</em>, <em>bnd_id</em>, <em>bnd_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm.get_bnd_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm.get_bnd_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c_in</strong> &#8211; Internal value of tracer</li>
<li><strong>uv_in</strong> &#8211; Internal value of horizontal velocity</li>
<li><strong>elev_in</strong> &#8211; Internal value of elevation</li>
<li><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; boundary id</li>
<li><strong>bnd_conditions</strong> &#8211; dict of boundary conditions:
<code class="docutils literal"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">HorizontalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal advection term <span class="math">\(\nabla_h \cdot (\textbf{u} T)\)</span></p>
<p>The weak formulation reads</p>
<div class="math">
\[\int_\Omega \nabla_h \cdot (\textbf{u} T) \phi dx
    = -\int_\Omega T\textbf{u} \cdot \nabla_h \phi dx
    + \int_{\mathcal{I}_h\cup\mathcal{I}_v}
        T^{\text{up}} \text{avg}(\textbf{u}) \cdot
        \text{jump}(\phi \textbf{n}_h) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math">\(\mathcal{I}_h,\mathcal{I}_v\)</span> denote the set of horizontal and
vertical facets,
<span class="math">\(\textbf{n}_h\)</span> is the horizontal projection of the unit normal vector,
<span class="math">\(T^{\text{up}}\)</span> is the upwind value, and <span class="math">\(\text{jump}\)</span> and
<span class="math">\(\text{avg}\)</span> denote the jump and average operators across the
interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.HorizontalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">VerticalAdvectionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical advection term <span class="math">\(\partial (w T)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math">
\[\int_\Omega \frac{\partial (w T)}{\partial z} \phi dx
= - \int_\Omega T w \frac{\partial \phi}{\partial z} dx
+ \int_{\mathcal{I}_v} T^{\text{up}} \text{avg}(w) \text{jump}(\phi n_z) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math">\(\mathcal{I}_v\)</span> denotes the set of vertical facets,
<span class="math">\(n_z\)</span> is the vertical projection of the unit normal vector,
<span class="math">\(T^{\text{up}}\)</span> is the
upwind value, and <span class="math">\(\text{jump}\)</span> and <span class="math">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<p>In the case of ALE moving mesh we substitute <span class="math">\(w\)</span> with <span class="math">\(w - w_m\)</span>,
<span class="math">\(w_m\)</span> being the mesh velocity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.VerticalAdvectionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">HorizontalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math">\(-\nabla_h \cdot (\mu_h \nabla_h T)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math">
\[\begin{split}-\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
=&amp; \int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h T) dS
- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(T \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(T \textbf{n}_h) \cdot
    \text{jump}(\phi \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the minus sign due to <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a> sign convention</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.HorizontalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">VerticalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Vertical diffusion term <span class="math">\(-\frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math">
\[\begin{split}-\int_\Omega \frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big) \phi dx
=&amp; \int_\Omega \mu \frac{\partial T}{\partial z} \frac{\partial \phi}{\partial z} dz \\
&amp;- \int_{\mathcal{I}_{h}} \text{jump}(\phi n_z) \text{avg}\Big(\mu \frac{\partial T}{\partial z}\Big) dS
- \int_{\mathcal{I}_{h}} \text{jump}(T n_z) \text{avg}\Big(\mu \frac{\partial \phi}{\partial z}\Big) dS \\
&amp;+ \int_{\mathcal{I}_{h}} \sigma \text{avg}(\mu) \text{jump}(T n_z) \cdot
    \text{jump}(\phi n_z) dS\end{split}\]</div>
<p>where <span class="math">\(\sigma\)</span> is a penalty parameter,
see Epshteyn and Riviere (2007).</p>
<p>Epshteyn and Riviere (2007). Estimation of penalty parameters for symmetric
interior penalty Galerkin methods. Journal of Computational and Applied
Mathematics, 206(2):843-872. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2006.08.029">http://dx.doi.org/10.1016/j.cam.2006.08.029</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the minus sign due to <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a> sign convention</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.VerticalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.tracer_eq.SourceTerm">
<em class="property">class </em><code class="descclassname">thetis.tracer_eq.</code><code class="descname">SourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em>, <em>use_symmetric_surf_bnd=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the sign convention of <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal"><span class="pre">equation.Term</span></code></a>, this term is assembled to the left hand side of the equation</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
<li><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, use symmetric surface boundary
condition in the horizontal advection term</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.tracer_eq.SourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-thetis.turbulence">
<span id="thetis-turbulence-module"></span><h2>thetis.turbulence module<a class="headerlink" href="#module-thetis.turbulence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generic-length-scale-turbulence-closure-model">
<h3>Generic Length Scale Turbulence Closure model<a class="headerlink" href="#generic-length-scale-turbulence-closure-model" title="Permalink to this headline">¶</a></h3>
<p>This model solves two dynamic equations, for turbulent kinetic energy
(TKE, <span class="math">\(k\)</span>) and one for an additional variable, the generic length scale
<span class="math">\(\psi\)</span> [1]:</p>
<div class="math" id="equation-turb_tke_eq">
<span class="eqno">(11)<a class="headerlink" href="#equation-turb_tke_eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial k}{\partial t} + \nabla_h \cdot (\textbf{u} k)
    + \frac{\partial (w k)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_k} \frac{\partial k}{\partial z}\right)
    + P + B - \varepsilon\]</div>
<div class="math" id="equation-turb_psi_eq">
<span class="eqno">(12)<a class="headerlink" href="#equation-turb_psi_eq" title="Permalink to this equation">¶</a></span>\[\frac{\partial \psi}{\partial t} + \nabla_h \cdot (\textbf{u} \psi)
    + \frac{\partial (w \psi)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_\psi} \frac{\partial \psi}{\partial z}\right)
    + \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>with the production <span class="math">\(P\)</span> and buoyancy production <span class="math">\(B\)</span> are</p>
<div class="math">
\[\begin{split}P &amp;= \nu M^2 \\
B &amp;= -\mu N^2\end{split}\]</div>
<p>where <span class="math">\(M\)</span> and <span class="math">\(N\)</span> are the shear and buoyancy frequencies</p>
<div class="math">
\[\begin{split}M^2 &amp;= \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2 \\
N^2 &amp;= -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\end{split}\]</div>
<p>The generic lenght scale variable is defined as</p>
<div class="math">
\[\psi = (c_\mu^0)^p k^m l^n\]</div>
<p>where <span class="math">\(p, m, n\)</span> are parameters and <span class="math">\(c_\mu^0\)</span> is an empirical constant.</p>
<p>The parameters <span class="math">\(c_1,c_2,c_3,f_{wall}\)</span> depend on the chosen closure.
The parameter <span class="math">\(c_3\)</span> takes two values: <span class="math">\(c_3^-\)</span> in stably stratified
regime, and <span class="math">\(c_3^+\)</span> in unstably stratified cases.</p>
<p>Turbulent length scale <span class="math">\(l\)</span>, and the TKE dissipation rate
<span class="math">\(\varepsilon\)</span> are obtained diagnostically as</p>
<div class="math">
\[\begin{split}l &amp;= (c_\mu^0)^3 k^{3/2} \varepsilon^{-1} \\
\varepsilon &amp;= (c_\mu^0)^{3+p/n} k^{3/2 + m/n} \psi^{-1/n}\end{split}\]</div>
<p>Finally the vertical eddy viscosity and diffusivity are also computed
diagnostically</p>
<div class="math">
\[\begin{split}\nu &amp;= \sqrt{2k} l S_m \\
\mu &amp;= \sqrt{2k} l S_\rho\end{split}\]</div>
<p>Stability functions <span class="math">\(S_m\)</span> and <span class="math">\(S_\rho\)</span> are defined in [2] or [3].
Implementation follows [4].</p>
<div class="section" id="supported-closures">
<h4>Supported closures<a class="headerlink" href="#supported-closures" title="Permalink to this headline">¶</a></h4>
<p>The GLS model parameters are controlled via the <a class="reference internal" href="#thetis.turbulence.GLSModelOptions" title="thetis.turbulence.GLSModelOptions"><code class="xref py py-class docutils literal"><span class="pre">GLSModelOptions</span></code></a> class.</p>
<p>The parameters can be accessed from the solver object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">FlowSolver</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">turbulence_model</span> <span class="o">=</span> <span class="s1">&#39;gls&#39;</span>  <span class="c1"># activate GLS model (default)</span>
<span class="n">gls_options</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">gls_options</span>
<span class="n">gls_options</span><span class="o">.</span><span class="n">closure_name</span> <span class="o">=</span> <span class="s1">&#39;k-omega&#39;</span>
<span class="n">gls_options</span><span class="o">.</span><span class="n">stability_name</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span>
<span class="n">gls_options</span><span class="o">.</span><span class="n">compute_c3_minus</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>Currently the following closures have been implemented:</p>
<ul>
<li><dl class="first docutils">
<dt><span class="math">\(k-\varepsilon\)</span> model</dt>
<dd><p class="first last">This closure is obtained with <span class="math">\(p=3, m=3/2, n=-1\)</span>, resulting in
<span class="math">\(\psi=\varepsilon\)</span>.
To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-epsilon</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(k-\omega\)</span> model</dt>
<dd><p class="first last">This closure is obtained with <span class="math">\(p=-1, m=1/2, n=-1\)</span>, resulting in
<span class="math">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-omega</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>GLS model A</dt>
<dd><p class="first last">This closure is obtained with <span class="math">\(p=2, m=1, n=-2/3\)</span>, resulting in
<span class="math">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">gen</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>The following stability functions have been implemented</p>
<ul>
<li><dl class="first docutils">
<dt>Canuto A [3]</dt>
<dd><p class="first last">To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CA</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Canuto B [3]</dt>
<dd><p class="first last">To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CB</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Kantha-Clayson [2]</dt>
<dd><p class="first last">To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">KC</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Cheng [6]</dt>
<dd><p class="first last">To use this option set <code class="docutils literal"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CH</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>See <a class="reference internal" href="#module-thetis.stability_functions" title="thetis.stability_functions"><code class="xref py py-mod docutils literal"><span class="pre">stability_functions</span></code></a> for more information.</p>
<dl class="docutils">
<dt>[1] Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for</dt>
<dd>geophysical turbulence models. Journal of Marine Research, 61:235&#8211;265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></dd>
<dt>[2] Kantha, L. H. and Clayson, C. A. (1994). An improved mixed layer model for</dt>
<dd>geophysical applications. Journal of Geophysical Research: Oceans,
99(C12):25235&#8211;25266.
<a class="reference external" href="http://dx.doi.org/10.1029/94JC02257">http://dx.doi.org/10.1029/94JC02257</a></dd>
<dt>[3] Canuto et al. (2001). Ocean Turbulence. Part I: One-Point Closure Model -</dt>
<dd>Momentum and Heat Vertical Diffusivities. Journal of Physical Oceanography,
31(6):1413-1426.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></dd>
<dt>[4] Warner et al. (2005). Performance of four turbulence closure models</dt>
<dd>implemented using a generic length scale method. Ocean Modelling,
8(1-2):81&#8211;113.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2003.12.003">http://dx.doi.org/10.1016/j.ocemod.2003.12.003</a></dd>
<dt>[5] Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models</dt>
<dd>for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795&#8211;827.
<a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></dd>
<dt>[6] Cheng et al. (2002). An improved model for the turbulent PBL.</dt>
<dd>J. Atmos. Sci., 59:1550-1565.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2</a></dd>
<dt>[7] Burchard and Petersen (1999). Models of turbulence in the marine</dt>
<dd>environment - a comparative study of two-equation turbulence models.
Journal of Marine Systems, 21(1-4):29-53.
<a class="reference external" href="http://dx.doi.org/10.1016/S0924-7963(99)00004-4">http://dx.doi.org/10.1016/S0924-7963(99)00004-4</a></dd>
</dl>
<dl class="class">
<dt id="thetis.turbulence.BuoyFrequencySolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">BuoyFrequencySolver</code><span class="sig-paren">(</span><em>rho</em>, <em>n2</em>, <em>n2_tmp</em>, <em>relaxation=1.0</em>, <em>minval=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes buoyancy frequency squared form the given horizontal
velocity field.</p>
<div class="math">
\[N^2 = -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rho</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; water density field</li>
<li><strong>n2</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; <span class="math">\(N^2\)</span> field</li>
<li><strong>n2_tmp</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; temporary field</li>
<li><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; relaxation coefficient for mixing old and new
values N2 = relaxation*N2_new + (1-relaxation)*N2_old</li>
<li><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; minimum value for <span class="math">\(N^2\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.BuoyFrequencySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True if solving for the first time, skips
relaxation</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GLSModelOptions">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GLSModelOptions</code><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a></p>
<p>Options for Generic Length Scale turbulence model</p>
<dl class="method">
<dt id="thetis.turbulence.GLSModelOptions.apply_defaults">
<code class="descname">apply_defaults</code><span class="sig-paren">(</span><em>closure_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions.apply_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.apply_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies default parameters for given closure name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>closure_name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the turbulence closure model</td>
</tr>
</tbody>
</table>
<p>Sets default values for parameters p, m, n, schmidt_nb_tke,
schmidt_nb_psi, c1, c2, c3_plus, c3_minus,
f_wall, k_min, psi_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c1">
<code class="descname">c1</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c1" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c1 parameter for Psi equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c2">
<code class="descname">c2</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c2" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c2 parameter for Psi equations</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c3_minus">
<code class="descname">c3_minus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, stable stratification</p>
<p>If <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.compute_c3_minus" title="thetis.turbulence.GLSModelOptions.compute_c3_minus"><code class="xref py py-attr docutils literal"><span class="pre">compute_c3_minus</span></code></a> is True this value will be overriden</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.c3_plus">
<code class="descname">c3_plus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.c3_plus" title="Permalink to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, unstable stratification</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.closure_name">
<code class="descname">closure_name</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.closure_name" title="Permalink to this definition">¶</a></dt>
<dd><p>str: name of common closures, one of</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k-epsilon</span></code>: k-epsilon setup</li>
<li><code class="docutils literal"><span class="pre">k-omega</span></code>: k-epsilon setup</li>
<li><code class="docutils literal"><span class="pre">gen</span></code>: Generic Length Scale setup A</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.cmu0">
<code class="descname">cmu0</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>float: cmu0 parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_c3_minus">
<code class="descname">compute_c3_minus</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_c3_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.c3_minus" title="thetis.turbulence.GLSModelOptions.c3_minus"><code class="xref py py-attr docutils literal"><span class="pre">c3_minus</span></code></a> from <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.ri_st" title="thetis.turbulence.GLSModelOptions.ri_st"><code class="xref py py-attr docutils literal"><span class="pre">ri_st</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_cmu0">
<code class="descname">compute_cmu0</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_cmu0" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute cmu0 from stability function parameters</p>
<p>If <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.compute_cmu0" title="thetis.turbulence.GLSModelOptions.compute_cmu0"><code class="xref py py-attr docutils literal"><span class="pre">compute_cmu0</span></code></a> is True, this value will be overriden</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_kappa">
<code class="descname">compute_kappa</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute von Karman constant from <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.schmidt_nb_psi" title="thetis.turbulence.GLSModelOptions.schmidt_nb_psi"><code class="xref py py-attr docutils literal"><span class="pre">schmidt_nb_psi</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_len_min">
<code class="descname">compute_len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute min_len from k_min and psi_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.compute_psi_min">
<code class="descname">compute_psi_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.compute_psi_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: compute psi_len from k_min and eps_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.diff_min">
<code class="descname">diff_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.diff_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy diffusivity</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.eps_min">
<code class="descname">eps_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.eps_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for epsilon</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.f_wall">
<code class="descname">f_wall</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.f_wall" title="Permalink to this definition">¶</a></dt>
<dd><p>float: wall function parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.galperin_lim">
<code class="descname">galperin_lim</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.galperin_lim" title="Permalink to this definition">¶</a></dt>
<dd><p>float: Galperin lenght scale limitation parameter</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.k_min">
<code class="descname">k_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.k_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent kinetic energy</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.kappa">
<code class="descname">kappa</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>float: von Karman constant</p>
<p>If <a class="reference internal" href="#thetis.turbulence.GLSModelOptions.compute_kappa" title="thetis.turbulence.GLSModelOptions.compute_kappa"><code class="xref py py-attr docutils literal"><span class="pre">compute_kappa</span></code></a> is True this value will be overriden</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.len_min">
<code class="descname">len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent lenght scale</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_eps">
<code class="descname">limit_eps</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit on epsilon</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_len">
<code class="descname">limit_len</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_len" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_len_min">
<code class="descname">limit_len_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_len_min" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: limit minimum turbulent length scale to len_min</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.limit_psi">
<code class="descname">limit_psi</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.limit_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>bool: apply Galperin lenght scale limit on psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.m">
<code class="descname">m</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.m" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter m for the definition of psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.n">
<code class="descname">n</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.n" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter n for the definition of psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.p">
<code class="descname">p</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.p" title="Permalink to this definition">¶</a></dt>
<dd><p>float: parameter p for the definition of psi</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GLSModelOptions.print_summary">
<code class="descname">print_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSModelOptions.print_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.print_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all defined parameters and their values.</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.psi_min">
<code class="descname">psi_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.psi_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for psi</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.ri_st">
<code class="descname">ri_st</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.ri_st" title="Permalink to this definition">¶</a></dt>
<dd><p>steady state gradient Richardson number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.schmidt_nb_psi">
<code class="descname">schmidt_nb_psi</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.schmidt_nb_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>float: psi Schmidt number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.schmidt_nb_tke">
<code class="descname">schmidt_nb_tke</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.schmidt_nb_tke" title="Permalink to this definition">¶</a></dt>
<dd><p>float: turbulent kinetic energy Schmidt number</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.stability_name">
<code class="descname">stability_name</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.stability_name" title="Permalink to this definition">¶</a></dt>
<dd><p>str: name of used stability function family</p>
<p>&#8216;CA&#8217;: Canuto A
&#8216;CB&#8217;: Canuto B
&#8216;KC&#8217;: Kantha-Clayson
&#8216;CH&#8217;: Cheng</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.turbulence.GLSModelOptions.visc_min">
<code class="descname">visc_min</code><em class="property"> = None</em><a class="headerlink" href="#thetis.turbulence.GLSModelOptions.visc_min" title="Permalink to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy viscosity</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GLSVerticalDiffusionTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>schmidt_nb</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="thetis.tracer_eq.VerticalDiffusionTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.VerticalDiffusionTerm</span></code></a></p>
<p>Vertical diffusion term where the diffusivity is replaced by
viscosity/Schmidt number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>schmidt_nb</strong> &#8211; the Schmidt number of TKE or Psi</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.GLSVerticalDiffusionTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.GenericLengthScaleModel">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">GenericLengthScaleModel</code><span class="sig-paren">(</span><em>solver</em>, <em>k_field</em>, <em>psi_field</em>, <em>uv_field</em>, <em>rho_field</em>, <em>l_field</em>, <em>epsilon_field</em>, <em>eddy_diffusivity</em>, <em>eddy_viscosity</em>, <em>n2</em>, <em>m2</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Generic Length Scale turbulence closure model implementation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solver</strong> &#8211; FlowSolver object</li>
<li><strong>k_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; turbulent kinetic energy (TKE) field</li>
<li><strong>psi_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; generic length scale field</li>
<li><strong>uv_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; horizontal velocity field</li>
<li><strong>rho_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; water density field</li>
<li><strong>l_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; turbulence length scale field</li>
<li><strong>epsilon_field</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; TKE dissipation rate field</li>
<li><strong>eddy_diffusivity</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; eddy diffusivity field</li>
<li><strong>eddy_viscosity</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; eddy viscosity field</li>
<li><strong>n2</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field for buoyancy frequency squared</li>
<li><strong>m2</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field for vertical shear frequency squared</li>
<li><strong>options</strong> &#8211; GLS model options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes fields</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.postprocess">
<code class="descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables <span class="math">\(k,\psi\)</span></p>
<p>To be called after evaluating the equations.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.GenericLengthScaleModel.preprocess">
<code class="descname">preprocess</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes diagnostic variables that the dynamic equations depend on</p>
<p>To be called before evaluating the equations.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.P1Average">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">P1Average</code><span class="sig-paren">(</span><em>p0</em>, <em>p1</em>, <em>p1dg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Takes a discontinuous field and computes a P1 field by averaging around
nodes</p>
<p>Source must be either a P0 or P1DG <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>.
The averaging operation is both mass conservative and positivity preserving.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>p0</strong> &#8211; P0 function space</li>
<li><strong>p1</strong> &#8211; P1 function space</li>
<li><strong>p1dg</strong> &#8211; P1DG function space</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.P1Average.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Averages discontinuous <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> <code class="xref py py-attr docutils literal"><span class="pre">source</span></code> on P1
<code class="xref py py-class docutils literal"><span class="pre">Function</span></code> <code class="xref py py-attr docutils literal"><span class="pre">solution</span></code></p>
</dd></dl>

<dl class="method">
<dt id="thetis.turbulence.P1Average.update_volumes">
<code class="descname">update_volumes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#P1Average.update_volumes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.P1Average.update_volumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes nodal volume of the P1 and P1DG function function_spaces</p>
<p>This must be called when the mesh geometry is updated</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.PsiEquation">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">PsiEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Generic length scale equation <a class="reference internal" href="#equation-turb_psi_eq">(12)</a> without advection terms.</p>
<p>Advection of <span class="math">\(\psi\)</span> is implemented using the standard tracer equation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>gls_model</strong> &#8211; <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal"><span class="pre">GenericLengthScaleModel</span></code></a> object</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.PsiSourceTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">PsiSourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the Psi equation <a class="reference internal" href="#equation-turb_psi_eq">(12)</a></p>
<div class="math">
\[F_\psi = \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math">\(c_3 B\)</span> is split in two:</p>
<div class="math">
\[F_\psi = \frac{\psi^n}{k^n} (c_1 P + B_{source})
    + \frac{\psi^{n+1}}{k^n} (B_{sink} - c_2 \varepsilon f_{wall})\]</div>
<p>with <span class="math">\(B_{source} \ge 0\)</span> and <span class="math">\(B_{sink} &lt; 0\)</span>.</p>
<p>Also implements Neumann boundary condition at top and bottom [7]</p>
<div class="math">
\[\left( \frac{\nu}{\sigma_\psi} \frac{\psi}{z} \right)\Big|_{\Gamma_b} =
n_z \frac{\nu}{\sigma_\psi} (c_\mu^0)^p k^m \kappa^n (z_b + z_0)^{n-1}\]</div>
<p>where <span class="math">\(z_b\)</span> is the distance from boundary, and <span class="math">\(z_0\)</span> is the
roughness length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>gls_model</strong> &#8211; <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal"><span class="pre">GenericLengthScaleModel</span></code></a> object</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.PsiSourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.ShearFrequencySolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">ShearFrequencySolver</code><span class="sig-paren">(</span><em>uv</em>, <em>m2</em>, <em>mu</em>, <em>mv</em>, <em>mu_tmp</em>, <em>relaxation=1.0</em>, <em>minval=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical shear frequency squared form the given horizontal
velocity field.</p>
<div class="math">
\[M^2 = \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>uv</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; horizontal velocity field</li>
<li><strong>m2</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; <span class="math">\(M^2\)</span> field</li>
<li><strong>mu</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field for x component of <span class="math">\(M^2\)</span></li>
<li><strong>mv</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field for y component of <span class="math">\(M^2\)</span></li>
<li><strong>mu_tmp</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; temporary field</li>
<li><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; relaxation coefficient for mixing old and new values
M2 = relaxation*M2_new + (1-relaxation)*M2_old</li>
<li><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; minimum value for <span class="math">\(M^2\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.ShearFrequencySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>init_solve=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True if solving for the first time, skips
relaxation</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.SmoothVerticalGradSolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">SmoothVerticalGradSolver</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#SmoothVerticalGradSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.SmoothVerticalGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in a smooth(er) way.</p>
<p>The source is first interpolated on P0 field. The gradient is computed as
<span class="math">\(G = (G_{P0} + G_{P1DG})/2\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or expression to differentiate.</li>
<li><strong>solution</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where the solution will be stored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.SmoothVerticalGradSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#SmoothVerticalGradSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.SmoothVerticalGradSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the gradient</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.TKEEquation">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">TKEEquation</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKEEquation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKEEquation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal"><span class="pre">thetis.equation.Equation</span></code></a></p>
<p>Turbulent kinetic energy equation <a class="reference internal" href="#equation-turb_tke_eq">(11)</a> without advection terms.</p>
<p>Advection of TKE is implemented using the standard tracer equation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>gls_model</strong> &#8211; <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal"><span class="pre">GenericLengthScaleModel</span></code></a> object</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.TKESourceTerm">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">TKESourceTerm</code><span class="sig-paren">(</span><em>function_space</em>, <em>gls_model</em>, <em>bathymetry=None</em>, <em>v_elem_size=None</em>, <em>h_elem_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal"><span class="pre">thetis.tracer_eq.TracerTerm</span></code></a></p>
<p>Production and destruction terms of the TKE equation <a class="reference internal" href="#equation-turb_tke_eq">(11)</a></p>
<div class="math">
\[F_k = P + B - \varepsilon\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math">\(B\)</span> is split in two:</p>
<div class="math">
\[F_k = P + B_{source} + \frac{k^{n+1}}{k^n}(B_{sink} - \varepsilon)\]</div>
<p>with <span class="math">\(B_{source} \ge 0\)</span> and <span class="math">\(B_{sink} &lt; 0\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_space</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code> where the solution belongs</li>
<li><strong>gls_model</strong> &#8211; <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal"><span class="pre">GenericLengthScaleModel</span></code></a> object</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; bathymetry of the domain</li>
<li><strong>v_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the vertical
element size</li>
<li><strong>h_elem_size</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> that defines the horizontal
element size</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.TKESourceTerm.residual">
<code class="descname">residual</code><span class="sig-paren">(</span><em>solution</em>, <em>solution_old</em>, <em>fields</em>, <em>fields_old</em>, <em>bnd_conditions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm.residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm.residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.turbulence.VerticalGradSolver">
<em class="property">class </em><code class="descclassname">thetis.turbulence.</code><code class="descname">VerticalGradSolver</code><span class="sig-paren">(</span><em>source</em>, <em>solution</em>, <em>solver_parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in the weak sense.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or expression to differentiate.</li>
<li><strong>solution</strong> &#8211; A <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where the solution will be stored.
Must be in P0 space.</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.turbulence.VerticalGradSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the gradient</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.set_func_max_val">
<code class="descclassname">thetis.turbulence.</code><code class="descname">set_func_max_val</code><span class="sig-paren">(</span><em>f</em>, <em>maxval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_max_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_max_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.set_func_min_val">
<code class="descclassname">thetis.turbulence.</code><code class="descname">set_func_min_val</code><span class="sig-paren">(</span><em>f</em>, <em>minval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_min_val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.turbulence.set_func_min_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.timed_region">
<code class="descclassname">thetis.turbulence.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.turbulence.timed_stage">
<code class="descclassname">thetis.turbulence.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.turbulence.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-thetis.utility">
<span id="thetis-utility-module"></span><h2>thetis.utility module<a class="headerlink" href="#module-thetis.utility" title="Permalink to this headline">¶</a></h2>
<p>Utility functions and classes for 3D hydrostatic ocean model</p>
<dl class="class">
<dt id="thetis.utility.ALEMeshUpdater">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ALEMeshUpdater</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class that handles vertically moving ALE mesh</p>
<p>Mesh geometry is updated to match the elevation field
(<code class="docutils literal"><span class="pre">solver.fields.elev_2d</span></code>). First the discontinuous elevation field is
projected to continuous space, and this field is used to update the mesh
coordinates.</p>
<p>This class stores the reference coordinate field and keeps track of the
updated mesh coordinates. It also provides a method for computing the mesh
velocity from two adjacent elevation fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>solver</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code> object</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.ALEMeshUpdater.compute_mesh_velocity_begin">
<code class="descname">compute_mesh_velocity_begin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.compute_mesh_velocity_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.compute_mesh_velocity_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the current 2D elevation state as the &#8220;old&#8221; field</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.ALEMeshUpdater.compute_mesh_velocity_finalize">
<code class="descname">compute_mesh_velocity_finalize</code><span class="sig-paren">(</span><em>c=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.compute_mesh_velocity_finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.compute_mesh_velocity_finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mesh velocity from the elevation difference</p>
<p>Stores the current 2D elevation state as the &#8220;new&#8221; field,
and computes w_mesh using the given time step factor <code class="docutils literal"><span class="pre">c</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.ALEMeshUpdater.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set values for initial mesh (elevation at rest)</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.ALEMeshUpdater.update_elem_height">
<code class="descname">update_elem_height</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.update_elem_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.update_elem_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates vertical element size fields</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.ALEMeshUpdater.update_mesh_coordinates">
<code class="descname">update_mesh_coordinates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ALEMeshUpdater.update_mesh_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ALEMeshUpdater.update_mesh_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates 3D mesh coordinates to match current elev_2d field</p>
<p>elev_2d is first projected to continous space</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.AttrDict">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">AttrDict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#AttrDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.AttrDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both self[&#8216;key&#8217;] and self.key access to members.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python</a></p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.DensitySolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">DensitySolver</code><span class="sig-paren">(</span><em>salinity</em>, <em>temperature</em>, <em>density</em>, <em>eos_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Water density is defined as</p>
<div class="math">
\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>This method computes the density anomaly <span class="math">\(\rho'\)</span>.
Density is computed point-wise assuming that temperature, salinity and
density are in the same function space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>salinity</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; water salinity field</li>
<li><strong>temperature</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; water temperature field</li>
<li><strong>density</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; water density field</li>
<li><strong>eos_class</strong> (<a class="reference internal" href="#thetis.utility.EquationOfState" title="thetis.utility.EquationOfState"><code class="xref py py-class docutils literal"><span class="pre">EquationOfState</span></code></a>) &#8211; equation of state that defines water density</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.DensitySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DensitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.DensitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ElementContinuity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ElementContinuity</code><span class="sig-paren">(</span><em>dg</em>, <em>horizontal_dg</em>, <em>vertical_dg</em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.ElementContinuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<p>A named tuple describing the continuity of an element.</p>
<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.dg">
<code class="descname">dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.horizontal_dg">
<code class="descname">horizontal_dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.horizontal_dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="thetis.utility.ElementContinuity.vertical_dg">
<code class="descname">vertical_dg</code><a class="headerlink" href="#thetis.utility.ElementContinuity.vertical_dg" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.EquationOfState">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">EquationOfState</code><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Equation of State according of Jackett et al. (2006) for computing sea
water density.</p>
<div class="math" id="equation-equation_of_state">
<span class="eqno">(13)<a class="headerlink" href="#equation-equation_of_state" title="Permalink to this equation">¶</a></span>\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>Jackett et al. (2006). Algorithms for Density, Potential Temperature,
Conservative Temperature, and the Freezing Temperature of Seawater.
Journal of Atmospheric and Oceanic Technology, 23(12):1709-1728.
<a class="reference external" href="http://dx.doi.org/10.1175/JTECH1946.1">http://dx.doi.org/10.1175/JTECH1946.1</a></p>
<p>Sets coefficients</p>
<dl class="method">
<dt id="thetis.utility.EquationOfState.compute_rho">
<code class="descname">compute_rho</code><span class="sig-paren">(</span><em>s</em>, <em>th</em>, <em>p</em>, <em>rho0=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#EquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.EquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes sea water density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Salinity expressed on the Practical Salinity Scale 1978</li>
<li><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Potential temperature in Celsius, referenced to pressure
p_r = 0 dbar.</li>
<li><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Pressure in decibars (1 dbar = 1e4 Pa)</li>
<li><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Optional reference density. If provided computes
<span class="math">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">water density</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</td>
</tr>
</tbody>
</table>
<p>All pressures are gauge pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ExpandFunctionTo3d">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ExpandFunctionTo3d</code><span class="sig-paren">(</span><em>input_2d</em>, <em>output_3d</em>, <em>elem_height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Copy a 2D field to 3D</p>
<p>Copies a field from 2D mesh to 3D mesh, assigning the same value over the
vertical dimension. Horizontal function spaces must be the same.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">ExpandFunctionTo3d</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">func3d</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_2d</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; 2D source field</li>
<li><strong>output_3d</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; 3D target field</li>
<li><strong>elem_height</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> in 3D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.ExpandFunctionTo3d.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExpandFunctionTo3d.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ExpandFunctionTo3d.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.FieldDict">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">FieldDict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#FieldDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FieldDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal"><span class="pre">thetis.utility.AttrDict</span></code></a></p>
<p>AttrDict that checks that all added fields have proper meta data.</p>
<p>Values can be either Function or Constant objects.</p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.FrozenClass">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">FrozenClass</code><a class="reference internal" href="_modules/thetis/utility.html#FrozenClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.FrozenClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A class where creating a new attribute will raise an exception if _isfrozen == True</p>
</dd></dl>

<dl class="class">
<dt id="thetis.utility.LinearEquationOfState">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">LinearEquationOfState</code><span class="sig-paren">(</span><em>rho_ref</em>, <em>alpha</em>, <em>beta</em>, <em>th_ref</em>, <em>s_ref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Linear Equation of State for computing sea water density</p>
<div class="math">
\[\rho = \rho_{ref} - \alpha (T - T_{ref}) + \beta (S - S_{ref})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rho_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; reference density</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; thermal expansion coefficient</li>
<li><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; haline contraction coefficient</li>
<li><strong>th_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; reference temperature</li>
<li><strong>s_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; reference salinity</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.LinearEquationOfState.compute_rho">
<code class="descname">compute_rho</code><span class="sig-paren">(</span><em>s</em>, <em>th</em>, <em>p</em>, <em>rho0=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#LinearEquationOfState.compute_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.LinearEquationOfState.compute_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes sea water density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Salinity expressed on the Practical Salinity Scale 1978</li>
<li><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Potential temperature in Celsius</li>
<li><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) &#8211; Pressure in decibars (1 dbar = 1e4 Pa)</li>
<li><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Optional reference density. If provided computes
<span class="math">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">water density</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</td>
</tr>
</tbody>
</table>
<p>Pressure is ingored in this equation of state.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.ParabolicViscosity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">ParabolicViscosity</code><span class="sig-paren">(</span><em>uv_bottom</em>, <em>bottom_drag</em>, <em>bathymetry</em>, <em>nu</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ParabolicViscosity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ParabolicViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes parabolic eddy viscosity profile assuming log layer flow</p>
<div class="math">
\[\nu = \kappa u_{bf}  \frac{(-z)(h + z_0 + z)}{h + z_0}\]</div>
<p>with</p>
<div class="math">
\[u_{bf} = \sqrt{C_D} |\mathbf{u}_b|\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>uv_bottom</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; bottom velocity</li>
<li><strong>bottom_drag</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; bottom drag field</li>
<li><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; bathymetry field</li>
<li><strong>nu</strong> (3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; eddy viscosity field</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.ParabolicViscosity.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ParabolicViscosity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.ParabolicViscosity.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes viscosity and stores it in nu field</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SmagorinskyViscosity">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SmagorinskyViscosity</code><span class="sig-paren">(</span><em>uv</em>, <em>output</em>, <em>c_s</em>, <em>h_elem_size</em>, <em>max_val</em>, <em>min_val=1e-10</em>, <em>weak_form=True</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes Smagorinsky subgrid scale horizontal viscosity</p>
<p>This formulation is according to Ilicak et al. (2012) and
Griffies and Hallberg (2000).</p>
<div class="math">
\[\nu = (C_s \Delta x)^2 |S|\]</div>
<p>with the deformation rate</p>
<div class="math">
\[\begin{split}|S| &amp;= \sqrt{D_T^2 + D_S^2} \\
D_T &amp;= \frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} \\
D_S &amp;= \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}\end{split}\]</div>
<p><span class="math">\(\Delta x\)</span> is the horizontal element size and <span class="math">\(C_s\)</span> is the
Smagorinsky coefficient.</p>
<p>To match a certain mesh Reynolds number <span class="math">\(Re_h\)</span> set
<span class="math">\(C_s = 1/\sqrt{Re_h}\)</span>.</p>
<p>Ilicak et al. (2012). Spurious dianeutral mixing and the role of
momentum closure. Ocean Modelling, 45-46(0):37-58.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2011.10.003">http://dx.doi.org/10.1016/j.ocemod.2011.10.003</a></p>
<p>Griffies and Hallberg (2000). Biharmonic friction with a
Smagorinsky-like viscosity for use in large-scale eddy-permitting
ocean models. Monthly Weather Review, 128(8):2935-2946.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>uv_3d</strong> (3D vector <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; horizontal velocity</li>
<li><strong>output</strong> (3D scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Smagorinsky viscosity field</li>
<li><strong>c_s</strong> (float or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; Smagorinsky coefficient</li>
<li><strong>h_elem_size</strong> (3D scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code>) &#8211; field that defines the horizontal element size</li>
<li><strong>max_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Maximum allowed viscosity. Viscosity will be clipped at
this value.</li>
<li><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Minimum allowed viscosity. Viscosity will be clipped at
this value.</li>
<li><strong>weak_form</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Compute velocity shear by integrating by parts.
Necessary for some function spaces (e.g. P0).</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.SmagorinskyViscosity.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SmagorinskyViscosity.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SmagorinskyViscosity.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute viscosity</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SubFunctionExtractor">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SubFunctionExtractor</code><span class="sig-paren">(</span><em>input_3d</em>, <em>output_2d</em>, <em>boundary='top'</em>, <em>elem_facet=None</em>, <em>elem_height=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Extract a 2D sub-function from a 3D function in an extruded mesh</p>
<p>Given 2D and 3D functions,</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
<p>Get surface value:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get bottom value:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get value at the top of bottom element:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_3d</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; 3D source field</li>
<li><strong>output_2d</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; 2D target field</li>
<li><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; &#8216;top&#8217;|&#8217;bottom&#8217;
Defines whether to extract from the surface or bottom 3D elements</li>
<li><strong>elem_facet</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; &#8216;top&#8217;|&#8217;bottom&#8217;|&#8217;average&#8217;
Defines which facet of the 3D element is extracted. The &#8216;average&#8217;
computes mean of the top and bottom facets of the 3D element.</li>
<li><strong>elem_height</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> in 2D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.SubFunctionExtractor.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubFunctionExtractor.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SubFunctionExtractor.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.SumFunction">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">SumFunction</code><a class="reference internal" href="_modules/thetis/utility.html#SumFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Helper class to keep track of sum of Coefficients.</p>
<p>Initialize empty sum.</p>
<p>get operation returns Constant(0)</p>
<dl class="method">
<dt id="thetis.utility.SumFunction.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>coeff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a coefficient to self</p>
</dd></dl>

<dl class="method">
<dt id="thetis.utility.SumFunction.get_sum">
<code class="descname">get_sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.get_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.SumFunction.get_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sum of all added Coefficients</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VelocityMagnitudeSolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VelocityMagnitudeSolver</code><span class="sig-paren">(</span><em>solution</em>, <em>u=None</em>, <em>w=None</em>, <em>min_val=1e-06</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes magnitude of (u[0],u[1],w) and stores it in solution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; scalar field for velocity magnitude scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>u</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; horizontal velocity</li>
<li><strong>w</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; vertical velocity</li>
<li><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; minimum value of magnitude. Minimum value of solution
will be clipped to this value</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal"><span class="pre">u</span></code> is None computes magnitude of (0,0,w).</p>
<p>If <code class="docutils literal"><span class="pre">w</span></code> is None computes magnitude of (u[0],u[1],0).</p>
<dl class="method">
<dt id="thetis.utility.VelocityMagnitudeSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VelocityMagnitudeSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VelocityMagnitudeSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the magnitude</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VerticalIntegrator">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VerticalIntegrator</code><span class="sig-paren">(</span><em>input</em>, <em>output</em>, <em>bottom_to_top=True</em>, <em>bnd_value=Constant(FiniteElement('Real'</em>, <em>None</em>, <em>0)</em>, <em>5)</em>, <em>average=False</em>, <em>bathymetry=None</em>, <em>elevation=None</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical integral (or average) of a field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> &#8211; 3D field to integrate</li>
<li><strong>output</strong> &#8211; 3D field where the integral is stored</li>
<li><strong>bottom_to_top</strong> &#8211; Defines the integration direction: If True integration is performed along the z axis, from bottom surface to top surface.</li>
<li><strong>bnd_value</strong> &#8211; Value of the integral at the bottom (top) boundary if bottom_to_top is True (False)</li>
<li><strong>average</strong> &#8211; If True computes the vertical average instead. Requires bathymetry and elevation fields</li>
<li><strong>bathymetry</strong> &#8211; 3D field defining the bathymetry</li>
<li><strong>elevation</strong> &#8211; 3D field defining the free surface elevation</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.VerticalIntegrator.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalIntegrator.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalIntegrator.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the integral and stores it in the output field.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="thetis.utility.VerticalVelocitySolver">
<em class="property">class </em><code class="descclassname">thetis.utility.</code><code class="descname">VerticalVelocitySolver</code><span class="sig-paren">(</span><em>solution</em>, <em>uv</em>, <em>bathymetry</em>, <em>boundary_funcs={}</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Computes vertical velocity diagnostically from the continuity equation</p>
<p>Vertical velocity is obtained from the continuity equation</p>
<div class="math" id="equation-continuity_eq_3d">
<span class="eqno">(14)<a class="headerlink" href="#equation-continuity_eq_3d" title="Permalink to this equation">¶</a></span>\[\frac{\partial w}{\partial z} = -\nabla_h \cdot \textbf{u}\]</div>
<p>and the bottom impermeability condition (<span class="math">\(h\)</span> denotes the bathymetry)</p>
<div class="math">
\[\begin{split}\textbf{n}_h \cdot \textbf{u} + w n_z &amp;= 0 \quad \forall \mathbf{x} \in \Gamma_{b} \\
\Leftrightarrow w &amp;= -\nabla_h h \cdot \mathbf{u} \quad \forall \mathbf{x} \in \Gamma_{b}\end{split}\]</div>
<p><span class="math">\(w\)</span> can be solved with the weak form</p>
<div class="math">
\[\begin{split}\int_{\Gamma_s} w n_z \varphi dS
+ \int_{\mathcal{I}_h} \text{avg}(w) \text{jump}(\varphi n_z) dS
- \int_{\Omega} w \frac{\partial \varphi}{\partial z} dx
= \\
\int_{\Omega} \mathbf{u} \cdot \nabla_h \varphi dx
- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{avg}(\mathbf{u}) \cdot \text{jump}(\varphi \mathbf{n}_h) dS
- \int_{\Gamma_s} \mathbf{u} \cdot \varphi \mathbf{n}_h dS\end{split}\]</div>
<p>where the <span class="math">\(\Gamma_b\)</span> terms vanish due to the bottom impermeability
condition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solution</strong> &#8211; w <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>uv</strong> &#8211; horizontal velocity <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>bathymetry</strong> &#8211; bathymetry <code class="xref py py-class docutils literal"><span class="pre">Function</span></code></li>
<li><strong>boundary_funcs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; boundary conditions used in the 3D momentum
equation. Provides external values of uv (if any).</li>
<li><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; PETSc solver options</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thetis.utility.VerticalVelocitySolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#VerticalVelocitySolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.VerticalVelocitySolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute w</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thetis.utility.beta_plane_coriolis_function">
<code class="descclassname">thetis.utility.</code><code class="descname">beta_plane_coriolis_function</code><span class="sig-paren">(</span><em>latitude</em>, <em>out_function</em>, <em>y_offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates beta plane Coriolis function to a field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; latitude in degrees</li>
<li><strong>out_function</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where to interpolate</li>
<li><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; offset (y - y_0) used in Beta-plane approximation.
A constant in mesh coordinates.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.beta_plane_coriolis_params">
<code class="descclassname">thetis.utility.</code><code class="descname">beta_plane_coriolis_params</code><span class="sig-paren">(</span><em>latitude</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes beta plane parameters <span class="math">\(f_0,\beta\)</span> based on latitude</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; latitude in degrees</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">f_0, beta</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_tracer_mass_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_tracer_mass_3d</code><span class="sig-paren">(</span><em>scalar_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes total tracer mass in the 3D domain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scalar_func</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> to integrate</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_volume_2d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_volume_2d</code><span class="sig-paren">(</span><em>eta</em>, <em>bath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes volume of the 2D domain as an integral of the elevation field</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.comp_volume_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">comp_volume_3d</code><span class="sig-paren">(</span><em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.comp_volume_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes volume of the 3D domain as an integral</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_baroclinic_head">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_baroclinic_head</code><span class="sig-paren">(</span><em>solver</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_baroclinic_head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_baroclinic_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the baroclinic head <span class="math">\(r\)</span> from the density field</p>
<div class="math">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_bottom_drag">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_bottom_drag</code><span class="sig-paren">(</span><em>h_b</em>, <em>drag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_bottom_drag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_bottom_drag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bottom drag coefficient (Cd) from the law-of-the wall</p>
<div class="math">
\[C_D = \left( \frac{\kappa}{\ln (h_b + z_0)/z_0} \right)^2\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>h_b</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; the height above bed where the bottom velocity is evaluated in
the law-of-the-wall fit</li>
<li><strong>drag</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field where C_D is stored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_bottom_friction">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_bottom_friction</code><span class="sig-paren">(</span><em>solver</em>, <em>uv_3d</em>, <em>uv_bottom_2d</em>, <em>z_bottom_2d</em>, <em>bathymetry_2d</em>, <em>bottom_drag_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_bottom_friction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_bottom_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates bottom friction related fields for the 3D model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solver</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">FlowSolver</span></code> object</li>
<li><strong>uv_3d</strong> (3D vector <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; horizontal velocity</li>
<li><strong>uv_bottom_2d</strong> (2D vector <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; 2D bottom velocity field</li>
<li><strong>z_bottom_2d</strong> (2D scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Bottom element z coordinate</li>
<li><strong>bathymetry_2d</strong> (2D scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Bathymetry field</li>
<li><strong>bottom_drag_2d</strong> (2D scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; Bottom grad field</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_boundary_length">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_boundary_length</code><span class="sig-paren">(</span><em>mesh2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_boundary_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_boundary_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the length of the boundary segments in given 2d mesh</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.compute_elem_height">
<code class="descclassname">thetis.utility.</code><code class="descname">compute_elem_height</code><span class="sig-paren">(</span><em>zcoord</em>, <em>output</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_elem_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.compute_elem_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the element height on an extruded mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>zcoord</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field that contains the z coordinates of the mesh</li>
<li><strong>output</strong> (<code class="xref py py-class docutils literal"><span class="pre">Function</span></code>) &#8211; field where element height is stored</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.create_directory">
<code class="descclassname">thetis.utility.</code><code class="descname">create_directory</code><span class="sig-paren">(</span><em>path</em>, <em>comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#create_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.create_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory on disk</p>
<p>Raises IOError if a file with the same name already exists.</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.element_continuity">
<code class="descclassname">thetis.utility.</code><code class="descname">element_continuity</code><span class="sig-paren">(</span><em>fiat_element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#element_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.element_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal"><span class="pre">ElementContinuity</span></code></a> instance with the
continuity of a given element.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fiat_element</strong> &#8211; The fiat element to determine the continuity
of.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A new <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal"><span class="pre">ElementContinuity</span></code></a> instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.extrude_mesh_sigma">
<code class="descclassname">thetis.utility.</code><code class="descname">extrude_mesh_sigma</code><span class="sig-paren">(</span><em>mesh2d</em>, <em>n_layers</em>, <em>bathymetry_2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extrude_mesh_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.extrude_mesh_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrudes a 2d surface mesh with bathymetry data defined in a 2d field.</p>
<p>Generates a uniform terrain following mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh2d</strong> &#8211; 2D mesh</li>
<li><strong>n_layers</strong> &#8211; number of vertical layers</li>
<li><strong>bathymetry</strong> &#8211; 2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> of the bathymetry
(the depth of the domain; positive downwards)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_horizontal_elem_size_2d">
<code class="descclassname">thetis.utility.</code><code class="descname">get_horizontal_elem_size_2d</code><span class="sig-paren">(</span><em>sol2d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sol2d</strong> &#8211; 2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where result is stored</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_horizontal_elem_size_3d">
<code class="descclassname">thetis.utility.</code><code class="descname">get_horizontal_elem_size_3d</code><span class="sig-paren">(</span><em>sol2d</em>, <em>sol3d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh, then copies it on a 3D
field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sol2d</strong> &#8211; 2D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> for the element size field</li>
<li><strong>sol3d</strong> &#8211; 3D <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> for the element size field</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.get_zcoord_from_mesh">
<code class="descclassname">thetis.utility.</code><code class="descname">get_zcoord_from_mesh</code><span class="sig-paren">(</span><em>zcoord</em>, <em>solver_parameters={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_zcoord_from_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.get_zcoord_from_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates z coordinates from the 3D mesh</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>zcoord</strong> &#8211; scalar <code class="xref py py-class docutils literal"><span class="pre">Function</span></code> where coordinates will be stored</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.tensor_jump">
<code class="descclassname">thetis.utility.</code><code class="descname">tensor_jump</code><span class="sig-paren">(</span><em>v</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#tensor_jump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#thetis.utility.tensor_jump" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump term for vector functions based on the tensor product</p>
<div class="math">
\[\text{jump}(\mathbf{u}, \mathbf{n}) = (\mathbf{u}^+ \mathbf{n}^+) +
(\mathbf{u}^- \mathbf{n}^-)\]</div>
<p>This is the discrete equivalent of grad(u) as opposed to the
vectorial UFL jump operator <code class="xref py py-meth docutils literal"><span class="pre">ufl.jump()</span></code> which represents div(u).</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.timed_region">
<code class="descclassname">thetis.utility.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.utility.timed_stage">
<code class="descclassname">thetis.utility.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
<div class="section" id="module-thetis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-thetis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="thetis.timed_region">
<code class="descclassname">thetis.</code><code class="descname">timed_region</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="function">
<dt id="thetis.timed_stage">
<code class="descclassname">thetis.</code><code class="descname">timed_stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#thetis.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Tuomas Karna et al..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.
    </div>
  </body>
</html>